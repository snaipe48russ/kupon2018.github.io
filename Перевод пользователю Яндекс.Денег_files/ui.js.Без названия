window.YaMoney=window.YaMoney||{},window.YaMoney.block=window.YaMoney.block||{};var Carousel=YaMoney.Carousel=function(){this.mainContainer=null,this.itemsContanier=null,this.itemsContainerInner=null,this.leftButton=null,this.rightButton=null,this.resizeElement=null,this.pagerContainer=null,this.scrollBar={container:null,bar:null,enabled:!1,dimension:null,caused:!1,adjustDimensions:!0},this.items=[],this.itemsForResize=[],this.settings={itemElement:"li",speed:50,itemsToShow:1,scrollCount:1,activeButtonClassName:"",buttonPressedClassName:{right:"",left:""},endless:!1,vertical:!1,scrollSupport:!0,arrowsSupport:!1,dimensionAdjustOnResize:!0,usePager:!1,timer:null,onHorizontalResize:null,disableActivity:!1,isFullViewAllowed:!1,preserveItemDimensions:!1,discretScrollingByButtons:!1,clickToScroll:!1,fullView:{}},this.cssProperty="left",this.dimension={item:null,itemStart:null,items:[]},this.current={left:1,right:this.settings.itemsToShow},this.moveInc={left:0,right:0},this.maxAnimationTime=1500,this.oneStepAnimationTime=25,this.itemMargins=0,this.itemsAdd=0,this.moving=!1,this.movingDisabled=!1,this.movingFixed=!1,this.rotationTimerId=null,this.fullViewMode=!1};if(Carousel.prototype.init=function(e){var t=this,n=e.settings,i=e.elements,o=t.settings,a=t.scrollBar,s={initParam:function(e){"undefined"!=typeof n[e]&&(o[e]=n[e])},initParamBoolean:function(e){return"undefined"!=typeof n[e]&&n[e]?(o[e]=n[e],!0):!1},checkElement:function(e){return i[e]?(t[e]=$("#"+i[e]),!t[e]||0==t[e].length):!1}};if(!i||s.checkElement("mainContainer")||s.checkElement("itemsContainer")||s.checkElement("itemsContainerInner")||s.checkElement("leftButton")||s.checkElement("rightButton")||s.checkElement("pagerContainer")&&n.usePager||(s.checkElement("fullViewContainer")||s.checkElement("fullViewOpener"))&&n.isFullViewAllowed)return this.onError();if(this.rightButton.active=!1,this.leftButton.active=!1,i.scrollBarContainer&&i.scrollBarBar?(a.container=$("#"+e.elements.scrollBarContainer),a.bar=$("#"+e.elements.scrollBarBar),a.enabled=a.container&&a.container.length&&a.bar&&a.bar.length):a.enabled=!1,n&&(o.itemElement=n.itemElement||o.itemElement),t.itemsContainerInner.css(this.cssProperty,"0px"),this.items=t.itemsContainerInner.find(o.itemElement),1==this.items.length&&(o.disableActivity=!0),n.clickToScroll&&(o.clickToScroll=!0,this.items.each(function(e,n){var i=$(n);1===i.data("click-to-scroll")&&i.on("click",function(){t.movingDisabled=!1,t.movingFixed=!0,t.move(o.scrollCount,!0)})})),n&&(n.speed&&n.speed<=100&&n.speed>0&&(o.speed=n.speed),n.itemsToShow&&!isNaN(n.itemsToShow)&&n.itemsToShow>0&&this.items.length>=n.itemsToShow&&(o.itemsToShow=n.itemsToShow),n.scrollCount&&!isNaN(n.scrollCount)&&n.scrollCount<this.items.length&&(o.scrollCount=n.scrollCount),o.activeButtonClassName=n.activeButtonClassName||o.activeButtonClassName,n.buttonPressedClassName&&n.buttonPressedClassName.left&&n.buttonPressedClassName.right&&(o.buttonPressedClassName.left=n.buttonPressedClassName.left,o.buttonPressedClassName.right=n.buttonPressedClassName.right),n.endless&&(o.endless=n.endless,this.itemsAdd=o.itemsToShow),n.fullView&&(o.fullView=n.fullView),s.initParam("vertical"),o.vertical&&(this.cssProperty="top"),s.initParam("scrollSupport"),s.initParam("arrowsSupport"),s.initParam("dimensionAdjustOnResize"),s.initParam("onHorizontalResize"),o.dimensionAdjustOnResize||(o.endless=!1),s.initParamBoolean("usePager")&&this.setPager(),s.initParamBoolean("timer"),s.initParamBoolean("isFullViewAllowed"),s.initParamBoolean("preserveItemDimensions"),s.initParamBoolean("discretScrollingByButtons"),e.oneStepAnimationTime&&e.oneStepAnimationTime>0&&(this.oneStepAnimationTime=e.oneStepAnimationTime)),!this.items.length)return this.onError();if(this.current.right=o.itemsToShow,this.items.length&&this.items.length<o.itemsToShow&&(this.current.right=this.items.length),this.settings.endless){var r=t.itemsContainerInner.find(o.itemElement+":first"),l=t.itemsContainerInner.find(o.itemElement+":last");this.items.each(function(e,n){e<o.itemsToShow&&$(n).clone().insertAfter(l),e>t.items.length-o.itemsToShow-1&&$(n).clone().insertBefore(r)})}this.itemsForResize=t.itemsContainerInner.find(o.itemElement),this.resizeElement=this.itemsContainer.find(".resize"),this.resizeElement.length||(this.resizeElement=this.itemsContainer),o.vertical?(this.itemMargins=this.items.outerHeight(!0)-this.items.innerHeight(),this.dimension.itemStart=this.items.innerHeight(),this.dimensisonAdjustOnResize&&this.itemsContainer.css("min-height",o.itemsToShow*(this.dimension.itemStart+this.itemMargins))):(this.itemMargins=this.items.outerWidth(!0)-this.items.innerWidth(),this.dimension.itemStart=this.items.innerWidth(),this.dimensisonAdjustOnResize&&this.itemsContainer.css("min-width",o.itemsToShow*(this.dimension.itemStart+this.itemMargins))),this.itemsForResize.each(function(e){t.dimension.items[e]=t.settings.preserveItemDimensions?t.settings.vertical?$(this).outerHeight(!0):$(this).outerWidth(!0):t.settings.vertical?$(this).innerHeight():$(this).innerWidth()}),this.recalculateOnResize(),this.moveInc.left=Math.round(this.dimension.item/8*(o.speed/100)),this.moveInc.right=-this.moveInc.left,o.endless?(this.setButtonActive(this.rightButton),this.setButtonActive(this.leftButton)):this.items.length>o.itemsToShow&&this.setButtonActive(this.rightButton);var c={rightButtonMouseDown:function(){return o.buttonPressedClassName.right&&$(this).addClass(o.buttonPressedClassName.right),t.moving||(t.movingDisabled=!1,t.movingFixed=!0,a.caused=!1,t.move(o.scrollCount,!0),o.discretScrollingByButtons&&(t.movingDisabled=!0)),!1},leftButtonMouseDown:function(){return o.buttonPressedClassName.left&&$(this).addClass(o.buttonPressedClassName.left),t.moving||(t.movingDisabled=!1,a.caused=!1,t.movingFixed=!0,t.move(-o.scrollCount,!0),o.discretScrollingByButtons&&(t.movingDisabled=!0)),!1},mouseWheel:function(e,n){return t.moving||(t.movingDisabled=!1,a.caused=!1,n=-n/Math.abs(n),t.move(n)),!1},arrowKeys:function(e){if(27===e.keyCode&&t.hideFullView(),!t.moving&&!$(e.target).is("input")){var n=0;37==e.keyCode?n=-1:39==e.keyCode&&(n=1),t.movingDisabled=!1,a.caused=!1,t.move(n)}return!0},mouseUp:function(){t.movingDisabled||(o.buttonPressedClassName.left&&t.leftButton.removeClass(o.buttonPressedClassName.left),o.buttonPressedClassName.right&&t.rightButton.removeClass(o.buttonPressedClassName.right),t.movingDisabled=!0)},windowResize:function(){t.recalculateOnResize(),t.processFullView()},scrollBarContainerClick:function(e){if($(e.target).attr("class")==a.bar.attr("class"))return!1;var n=o.vertical?e.pageY-$(this).offset().top:e.pageX-$(this).offset().left,i=o.vertical?$(this).height()-a.bar.outerHeight(!0):$(this).width()-a.bar.outerWidth(!0);n>i&&(n=i);var s=Math.round(n/a.dimension);s=s>t.items.length-1?t.items.length-1:s,a.bar.css(t.cssProperty,n),t.current.left-1!=s&&(a.caused=!0),t.moveTo(s)},pagerClick:function(e){for(var n=$(e.target).closest("li"),i=n.siblings(".active"),o=-1,s=-1;n.length>0;)o++,n=n.prev();for(;i.length>0;)s++,i=i.prev();if(-1!=s){var r=o-s;t.movingDisabled=!1,a.caused=!1,t.move(r,!1)}},timedRotation:function(){t.moving||(t.movingDisabled=!1,a.caused=!1,t.move(o.scrollCount,!0)),t.movingDisabled||(t.movingDisabled=!0)},fullView:function(e){t.openFullView(),e.preventDefault()}};if(this.handlers=c,$(window).resize(c.windowResize),o.isFullViewAllowed){var d=this.itemsContainer.find(o.itemElement).find("a");this.fullViewOpener.click(c.fullView),d.click(c.fullView)}o.disableActivity?(this.rightButton.remove(),this.leftButton.remove()):(this.rightButton.mousedown(c.rightButtonMouseDown),this.leftButton.mousedown(c.leftButtonMouseDown),this.settings.scrollSupport&&this.mainContainer.mousewheel(c.mouseWheel),this.settings.arrowsSupport&&$(document).keydown(c.arrowKeys),this.settings.usePager&&this.pagerContainer.find("li").click(c.pagerClick),$(document).mouseup(c.mouseUp),a.enabled&&("undefined"!=typeof e.scrollBar.adjustDimensions&&(a.adjustDimensions=e.scrollBar.adjustDimensions),o.vertical?(a.adjustDimensions&&a.container.height(this.itemsContainer.height()),a.dimension=Math.round(a.container.innerHeight()/this.items.length),a.bar.height(parseInt(o.itemsToShow*a.container.innerHeight()/this.items.length))):(a.adjustDimensions&&a.container.width(this.itemsContainer.width()),a.dimension=Math.round(a.container.width()/this.items.length),a.bar.width(parseInt(o.itemsToShow*a.container.width()/this.items.length))),a.container.click(c.scrollBarContainerClick),a.bar.draggable({right:o.vertical?-1:0,bottom:o.vertical?0:-1,discreet:{dimension:{y:a.dimension,x:a.dimension},fire:function(e){if(!t.moving){t.movingDisabled=!1;var n=o.vertical?e.y:e.x;"undefined"!=typeof n&&null!=n&&(t.current.left<n+1&&(a.caused=!0,t.move(1)),t.current.right>o.itemsToShow+n&&(a.caused=!0,t.move(-1)))}}},end:function(e){t.moveTo(o.vertical?e.y:e.x)}})),o.timer&&(t.rotationTimerId=window.setInterval(function(e){"undefined"!=typeof e?e.timedRotation():c.timedRotation()},o.timer,c),t.mainContainer.hover(function(){clearInterval(t.rotationTimerId),t.rotationTimerId=null},function(){null!=t.rotationTimerId&&clearInterval(t.rotationTimerId),t.rotationTimerId=window.setInterval(function(e){"undefined"!=typeof e?e.timedRotation():c.timedRotation()},o.timer,c)}))),$(window).unload(function(){c&&(t.rightButton.unbind("click",c.rightButtonMouseDown),c.rightButtonMouseDown=null,t.leftButton.unbind("click",c.leftButtonMouseDown),c.leftButtonMouseDown=null,t.mainContainer.unbind("mousewheel",c.mouseWheel).unbind("mouseenter").unbind("mouseleave"),c.mouseWheel=null,a.container&&a.container.unbind("click",c.scrollBarContainerClick),$(document).unbind("mouseup",c.mouseUp),c.mouseUp=null,$(window).unbind("resize",c.windowResize),c.windowResize=null,rotationTimerId=null,t=null)}),t.reflowDOM()},Carousel.prototype.move=function(e,t){var n=this,i=n.current,o=n.settings;if(!isNaN(e)&&0!=e&&!n.movingDisabled&&!n.moving){if(o.endless)i.right==n.items.length+o.itemsToShow&&(n.itemsContainerInner.css(n.cssProperty,-n.getItemOffset(o.itemsToShow)),i.left=1,i.right=o.itemsToShow),i.left==1-o.itemsToShow&&(n.itemsContainerInner.css(n.cssProperty,-n.getItemOffset(n.items.length)),i.right=n.items.length,i.left=n.items.length-o.itemsToShow+1);else if(e>0&&i.right==n.items.length||0>e&&1==i.left)return!1;if(o.endless&&1==e&&i.left===n.items.length&&1==n.items.eq(i.left-1).next().data("is-video")&&(n.itemsContainerInner.css(n.cssProperty,0),i.left=0),n.moving=!0,o.endless||(e=e>0?i.right+e>n.items.length?n.items.length-i.right:e:i.left+e<1?-(i.left-1):e),t&&!this.fullViewMode)n.moveMargin=-n.getItemOffset(i.left+n.itemsAdd+e-1),self_currentIterations=0,n.moveIntervalId=setInterval(function(t){return function(){t.moveStep(e)}}(n),n.oneStepAnimationTime);else{var a=i.left+n.itemsAdd+e-1;a>n.items.length?(a-=n.items.length,e-=n.items.length):0>a&&(a+=n.items.length,e+=n.items.length),n.moveMargin=-n.getItemOffset(a),n.itemsContainerInner.css(n.cssProperty,n.moveMargin),n.moveFinishedHandler(e)}}},Carousel.prototype.moveStep=function(e){var t=this,n=t.itemsContainerInner;if(this.movingDisabled&&(e>0&&parseFloat(n.css(this.cssProperty))<=this.moveMargin||0>e&&parseFloat(n.css(this.cssProperty))>=this.moveMargin))return clearInterval(this.moveIntervalId),this.moveFinishedHandler(e/Math.abs(e)),!1;if(e>0){if(parseInt(n.css(this.cssProperty))<=-this.getItemOffset(this.current.left+this.itemsAdd)&&parseInt(n.css(this.cssProperty))>-this.getItemOffset(this.current.left+this.itemsAdd+1))if(this.current.left++,this.current.right++,this.currentIterations++,this.handleScrollBarPosition(),this.currentIterations!=Math.abs(e)||this.movingFixed||(this.moveMargin=-this.getItemOffset(this.current.left+this.itemsAdd+e-1),this.currentIterations=0),this.settings.endless)this.current.right==this.items.length+this.settings.itemsToShow&&(n.css(this.cssProperty,-this.getItemOffset(this.settings.itemsToShow)),this.current.left=1,this.current.right=this.itemsAdd,this.moveMargin=-this.getItemOffset(e-this.currentIterations+this.itemsAdd));else if(this.current.right==this.items.length)return clearInterval(this.moveIntervalId),this.moveFinishedHandler(0),!1;parseInt(n.css(this.cssProperty))+this.moveInc.right<=this.moveMargin?n.css(this.cssProperty,this.moveMargin):(n.css(this.cssProperty,parseInt(n.css(this.cssProperty))+this.moveInc.right),this.movingFixed&&(this.movingDisabled=!0))}else{if(parseInt(n.css(this.cssProperty))<-this.getItemOffset(this.current.left+this.itemsAdd-3)&&parseInt(n.css(this.cssProperty))>=-this.getItemOffset(this.current.left+this.itemsAdd-2))if(this.current.left--,this.current.right--,this.currentIterations++,this.handleScrollBarPosition(),this.currentIterations!=Math.abs(e)||this.movingFixed||(this.moveMargin=-this.getItemOffset(this.current.left+this.itemsAdd+e-1),this.currentIterations=0),this.settings.endless)this.current.left==1-this.settings.itemsToShow&&(n.css(this.cssProperty,-this.getItemOffset(this.items.length)),this.current.right=this.items.length,this.current.left=this.items.length-this.itemsAdd+1,this.moveMargin=-this.getItemOffset(this.current.right+this.currentIterations+e));else if(1==this.current.left)return clearInterval(this.moveIntervalId),this.moveFinishedHandler(0),!1;parseInt(n.css(this.cssProperty))+this.moveInc.left>=this.moveMargin?n.css(this.cssProperty,this.moveMargin):(n.css(this.cssProperty,parseInt(n.css(this.cssProperty))+this.moveInc.left),this.movingFixed&&(this.movingDisabled=!0))}},Carousel.prototype.moveFinishedHandler=function(e){return this.current.right+=e,this.current.left+=e,this.settings.endless||(1==this.current.left?this.setButtonInactive(this.leftButton):this.setButtonActive(this.leftButton),this.current.right==this.items.length?this.setButtonInactive(this.rightButton):this.setButtonActive(this.rightButton)),this.handleScrollBarPosition(),this.setPager(),this.fullViewMode&&this.processFullView(),this.scrollBar.caused=!1,this.movingFixed=!1,this.moving=!1,!1},Carousel.prototype.recalculateOnResize=function(){var e=this,t=e.settings;if("function"==typeof t.onHorizontalResize&&t.onHorizontalResize(),this.itemsContainer.is(":visible")){var n=Math.ceil((t.vertical?this.itemsContainer.innerHeight(!0):this.itemsContainer.innerWidth())/t.itemsToShow);this.dimension.item=n,t.dimensionAdjustOnResize&&(t.vertical?this.resizeElement.height(t.itemsToShow*this.dimension.item):n<this.dimension.itemStart?(this.dimension.item=this.dimension.itemStart+this.itemMargins,this.resizeElement.width(t.itemsToShow*this.dimension.item)):this.itemsContainer.css("width","auto"),this.itemsForResize.each(function(n){t.vertical?($(this).height(e.dimension.item-e.itemMargins),e.dimension.items[n]=$(this).outerHeight(!0)):e.settings.preserveItemDimensions||($(this).width(e.dimension.item-e.itemMargins),e.dimension.items[n]=$(this).outerWidth(!0))}),this.itemsContainerInner.css(this.cssProperty,-this.getItemOffset(this.current.left+this.itemsAdd-1)))}},Carousel.prototype.setButtonInactive=function(e){e.active&&this.settings.activeButtonClassName&&(e.removeClass(this.settings.activeButtonClassName),e.active=!1)},Carousel.prototype.setButtonActive=function(e){!e.active&&this.settings.activeButtonClassName&&(e.addClass(this.settings.activeButtonClassName),e.active=!0)},Carousel.prototype.handleScrollBarPosition=function(){if(this.scrollBar.enabled&&!this.scrollBar.caused&&this.scrollBar.dimension){var e=this.current.left;this.current.right>this.items.length?e=1:this.current.right<1&&(e=this.items.length),"left"==this.cssProperty?this.scrollBar.bar.css(this.cssProperty,this.current.right==this.items.length?parseInt(this.scrollBar.container.width()-this.scrollBar.bar.width()):(e-1)*this.scrollBar.dimension):this.scrollBar.bar.css(this.cssProperty,this.current.right==this.items.length?parseInt(this.scrollBar.container.innerHeight()-this.scrollBar.bar.outerHeight(!0)):(this.current.left-1)*this.scrollBar.dimension)}},Carousel.prototype.getItemOffset=function(e){var t=0;if(e>0)for(var n=0;e>n;n++)this.dimension.items[n]&&(t+=this.dimension.items[n]);else for(var n=this.dimension.items.length+e;n<this.dimension.items.length;n++)this.dimension.items[n]&&(t-=this.dimension.items[n]);return t},Carousel.prototype.moveTo=function(e,t){return isNaN(e)||!this.items[e]||this.moving||this.current.left-1==e?!1:(this.movingDisabled=!1,this.movingFixed=!0,this.move(e+1-this.current.left,t),!0)},Carousel.prototype.onError=function(){return this.mainContainer.hide(),!1},Carousel.prototype.setPager=function(){if(this.settings.usePager){var e=$(this.pagerContainer),t=this.current.left>this.items.length?0:this.current.left-1;e.find("li").removeClass("active"),e.find("li").eq(t).addClass("active")}},Carousel.prototype.reflowDOM=function(){"msie"==YaMoney.userAgent.browser&&(document.body.className=document.body.className)},Carousel.prototype.hideFullView=function(){var e=this,t=e.settings;e.fullViewMode&&e.settings.isFullViewAllowed&&e.fullViewContainer&&(e.fullViewContainer.removeClass(t.fullView.containerOpenClassName).empty(),e.fullViewMode=!1)},Carousel.prototype.openFullView=function(){var e=this,t=e.current,n=t.left-1;n>=this.items.length&&(n=0);var i=e.items.eq(n).find("a"),o=e.settings,a=i.parent("li").data("full-view-link"),s=e.fullViewContainer,r=i.closest(o.itemElement);e.fullViewMode=!0,s.empty();var l=setTimeout(function(){0===s.find("."+o.fullView.imageDivClassName).length&&$('<div class="'+o.fullView.spinnerClassName+'" />').appendTo(s)},50);r.addClass("active").siblings().removeClass("active");var c=$('<div class="'+o.fullView.imageDivClassName+'" />');$('<div class="'+o.fullView.nextButtonClassName+'"/>').appendTo(c).mousedown(e.handlers.rightButtonMouseDown),$('<div class="'+o.fullView.prevButtonClassName+'"/>').appendTo(c).mousedown(e.handlers.leftButtonMouseDown);var d=$('<div class="'+o.fullView.closerClassName+'">').appendTo(c);if(d.click(function(t){e.hideFullView(),t.preventDefault()}),1!==r.data("is-video")){var m=new Image;m.src=a,c.css("background-image","url("+a+")"),m.onload=function(){s.find("."+o.fullView.spinnerClassName).remove(),clearTimeout(l);var e=$(window).width()-40,t=$(window).height()-40,n=m.width,i=m.height,a={screen:e/t,img:m.width/m.height};i>t&&(i=t,n=i*a.img),n>e&&(n=e,i=n/a.img),c.height(i),c.width(n),c.css({"margin-left":"-"+Math.round(c.width()/2)+"px","margin-top":"-"+Math.round(c.height()/2)+"px"}),c.appendTo(s),s.appendTo("body").addClass(o.fullView.containerOpenClassName)},$("body.msie").length&&($("body.msie7").length||$("body.msie8").length)&&m.complete&&m.onload()}else{var u=r.find(".video-player-content embed"),h=r.find(".video-player-content").html();try{u.get(0).pauseVideo()}catch(p){r.find(".video-player-content").empty().html(h)}c.append(h),c.addClass(o.fullView.videoImageDivClassName),c.appendTo(s),s.appendTo("body").addClass(o.fullView.containerOpenClassName)}},Carousel.prototype.processFullView=function(){var e=this;e.fullViewMode&&e.openFullView()},function(e){function t(t){var n=[].slice.call(arguments,1),i=0;return t=e.event.fix(t||window.event),t.type="mousewheel",t.wheelDelta&&(i=t.wheelDelta/120),t.detail&&(i=-t.detail/3),n.unshift(t,i),e.event.handle.apply(this,n)}var n=["DOMMouseScroll","mousewheel"];e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=n.length;e;)this.addEventListener(n[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=n.length;e;)this.removeEventListener(n[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}(jQuery),jQuery(function(){jQuery.support.placeholder=!1;var e=document.createElement("input");"placeholder"in e&&(jQuery.support.placeholder=!0)}),function(e){e.fn.ym_placeholder=function(){return this.each(function(){var t=e(this),n=t.attr("placeholder"),i=e('<span class="b-input-text__placeholder">'+n+"</span>");t.before(i),i.click(function(){t.focus()}),t.focus(function(){i.hide()}).blur(function(){0==e.trim(t.val()).length&&i.show()})})}}(jQuery),function(e,t){t.ym_reachCounterGoal=function(n){"string"==typeof n&&(n={targetName:n}),n=t.extend({counter:"yaCounter152220",id:152220,targetName:""},n||{});try{e[n.counter].reachGoal(n.targetName)}catch(i){t("body").on("ya-counter-"+n.id+"-inited",function(){e[n.counter].reachGoal(n.targetName)})}},t.fn.ym_getInputData=function(e){var n=this.find(":input");e&&e.filter&&(n=n.filter(e.filter));var i={};return n.each(function(e,n){var o=t(n);i[o.attr("name")]=o.val()}),i},t.ymReachCounterGoal=t.ym_reachCounterGoal}(window,jQuery),function(e){e.fn.ymIndicate=function(t,n){var i={moveSpeed:250};return this.each(function(){n&&e.extend(i,n);var o=e(this),a=o.width()+"px",s=o.height()+"px",r=o.offset(),l=e(t).width()+"px",c=e(t).height()+"px",d=e(t).offset();e('<div id="moving">').css({top:r.top-4,left:r.left-4,width:a,height:s,opacity:0}).appendTo("body").animate({opacity:.7},80).animate({left:d.left-4,top:d.top-4,width:l,height:c},i.moveSpeed).animate({opacity:0},500,function(){e(this).remove()})})}}(jQuery),$("#a").click(function(){$(this).ymIndicate("#at")}),$("#b").click(function(){$(this).ymIndicate("#bt")}),$("#c").click(function(){$(this).ymIndicate("#ct")}),$("#d").click(function(){$(this).ymIndicate("#dt")}),YaMoney.favorite_FormComment=function(e){function t(e){$.url?n(e):(i(),$.getScript("/js/jquery.url.js",function(){$.url&&n(e)}))}function n(e){var t=$.url(e.old_url),n="",i=!1,o=!1;for(var a in t.param())"FormComment"==a?(n+=a+"="+encodeURIComponent(e.edit_name)+"&",i=!0):(n+=a+"="+t.param(a)+"&","favorite-id"==a&&(o=!0));o&&!i&&(n+="FormComment="+encodeURIComponent(e.edit_name)+"&"),e.fav_item_elem.attr("href",t.attr("path")+"?"+n)}function i(){jQuery.extend({getScript:function(e,t){var n=document.getElementsByTagName("head")[0],i=document.createElement("script");i.src=e;var o=!1;return i.onload=i.onreadystatechange=function(){o||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(o=!0,t&&t(),i.onload=i.onreadystatechange=null)},void n.appendChild(i)}})}var o=e&&e.data?e.data:!1;if("string"==typeof o&&(o=$.parseJSON(o)),o&&o.success){var a=$("ul.b-favorites__list").find("li[data-favorite-id = '"+e.params["favorite-id"]+"']").find("a").eq(0),s=a.attr("href");1==a.length&&s&&t({old_url:s,edit_name:e.params["edit-name"],fav_item_elem:a})}e.callback&&e.callback()},YaMoney.initBlocks=function(e){if("string"==typeof e){var t=e;e={$parent:$(t)}}if(e instanceof jQuery){var n=e;e={$parent:n}}var i=$.extend({$parent:$("body")},e),o=i.$parent.find("[data-block]");o.each(function(e){var t=$(this),n=[],i=t.data("block");"string"==typeof i&&(i=$.trim(i),0==i.indexOf("{")?i=$.parseJSON(i):(n=i.split(" "),i={},$.each(n,function(e,t){i[t]={}})));for(var o in i){var a=YaMoney.block[o],s=i[o];"function"==typeof a&&a.call(t,s,e)}})},YaMoney.userAgent=function(){var e,t=$.browser.version.split(".")[0],n=window.navigator.platform;switch(!0){case $.browser.msie||!!navigator.userAgent.match(/Trident\/7\./):e="msie";break;case $.browser.webkit:e="webkit";break;case $.browser.opera:e="opera";break;case $.browser.mozilla:e="mozilla";break;default:e="undefinedBrowser"}return{browser:e,version:t,platform:n}}(),$(document).ready(function(){$("body").addClass(YaMoney.userAgent.browser).addClass(YaMoney.userAgent.version).addClass(YaMoney.userAgent.browser+YaMoney.userAgent.version).addClass(YaMoney.userAgent.platform)}),function(e){e.fn.onAfterBemInit=function(e,t){return this.length&&(this.hasClass(e+"_js_inited")?t(this.bem(e)):BEM.blocks[e].on("init",function(e){t(e.target)})),this}}(jQuery),function(e){e.fn.ym_getCaretPosition=function(){var e=0,t=this[0];if(document.selection){this.focus();var n=document.selection.createRange();n.moveEnd("character",this.val().length),e=t.value.length-n.text.length}else(t.selectionStart||"0"==t.selectionStart)&&(e=t.selectionStart);return e},e.fn.ym_setCaretPosition=function(e){var t=this[0];if(t.setSelectionRange)this.focus(),t.setSelectionRange(e,e);else if(this[0].createTextRange){var n=t.createTextRange();n.collapse(!0),n.moveEnd("character",e),n.moveStart("character",e),n.select()}},e.fn.ym_getCaretEndPosition=function(){var e=0,t=this[0];if(document.selection){this.focus();var n=document.selection.createRange();n.moveStart("character",-this.val().length),e=n.text.length}else(t.selectionEnd||"0"==t.selectionEnd)&&(e=t.selectionEnd);return e}}(jQuery),function(e){var t=function(){};t.prototype={keysCode:{backspace:8,del:46,down:40,enter:13,esc:27,tab:9},safariKeys:{63276:33,63277:34,63275:35,63273:36,63234:37,63232:38,63235:39,63233:40,63272:46},getKeyByCode:function(t){return e.browser.safari?this.safariKeys[t]||t:t},getKeyCode:function(e){return this.getKeyByCode(e.keyCode||e.charCode)},getCharCode:function(e){return e.charCode||e.which||e.keyCode}},ym_keys=new t,isNavigationKeys=function(e){var t=ym_keys.getKeyByCode(e.keyCode),n=ym_keys.keysCode;return t>=33&&40>=t||t==n.enter||t==n.tab||t==n.esc},isSpecialKey=function(t){var n=t.keyCode,i=ym_keys.keysCode;return n==i.tab||n==i.enter||n==i.esc||n>=16&&20>=n||n==i.down&&(!(e.browser.opera||e.browser.webkit)||!t.shiftKey)||e.browser.opera&&t.shiftKey&&(37==n||39==n)||e.browser.opera&&!t.shiftKey&&(n==i.backspace||n==i.del||n>=33&&39>=n||n>=44&&45>=n)},createFilterEvent=function(t){return e(this).bind("keypress",function(n){var i=ym_keys.getKeyCode(n),o=ym_keys.keysCode,a=String.fromCharCode(ym_keys.getCharCode(n));if(!(n.ctrlKey||n.metaKey||n.altKey||e.browser.mozilla&&(isNavigationKeys(n)||i==o.backspace||i==o.del&&0==n.charCode)||!(e.browser.mozilla||!isSpecialKey(n)&&a))){var s=e.isFunction(t)?t.call(this,a,n):t.test(a);!s&&n.preventDefault()}})},e.fn.ym_keys=function(){var e=arguments;return this.each(function(){createFilterEvent.apply(this,e)})},e.fn.ymKeys=e.fn.ym_keys,e.ym_keys=ym_keys,e.ymKeys=ym_keys}(jQuery),function(e){var t=function(e){var n=arguments;return this.each(function(){if(t.commands[e])return t.commands[e].apply(this,Array.prototype.slice.call(n,1));if("object"!=typeof e&&e)throw"Method "+e+" does not exist on jQuery.linked_tip";return t.commands.show.apply(this,n)})};t.block=e('<span class="ym-linked-tip-block" />'),t.img_cache={},t.cache=function(e){if(!(e in this.img_cache)){var t=new Image;t.src=e,this.img_cache[e]=t}},t.cache("/i/errors/18x12/left.png"),t.cache("/i/notices/18x12/left.png");var n={get:function(e){return this.list()[this.indexOf(e)]},list:function(e){var t=e?e:[];return this._tips||(this._tips=t),this._tips},clear:function(){return delete this._tips,this},indexOf:function(e){for(var t=-1,n=this.list(),i=0,o=n.length;o>i;i++)if(n[i].target==e||n[i].tip==e){t=i;break}return t},push:function(e){var t=this.list();return t[t.length]=e,this},filter:function(){for(var t=e.extend({},n),i=arguments,o=i[0],a=this.list(),s=0,r=a.length;r>s;s++){var l=a[s];i[0]=l,o.apply(this,i)&&t.push(l)}return t},sort:function(e,t){var n=t?t:this.list(),i=e?e:function(e,t){return t>e};if(0==n.length)return[];for(var o=[],a=[],s=n[0],r=1;r<n.length;r++)i(n[r],s)?o.push(n[r]):a.push(n[r]);return this.sort(i,o).concat(s,this.sort(i,a))}};t.tips=e.extend({},n),t.dom_ready=!1,t.post_execute=e.extend({},n),css_property=function(){function e(e,t){var n=(document.body||document.documentElement).style;if("undefined"==typeof n)return!1;if("string"==typeof n[e])return t?e:!0;for(var i=["Moz","Webkit","Khtml","O","Ms"],e=e.charAt(0).toUpperCase()+e.substr(1),o=0;o<i.length;o++)if("string"==typeof n[i[o]+e])return t?i[o]+e:!0}return e}(),t.get_user_data=function(t){var n=e(this).data("linked-tip"),i=e(this).attr("data-linked-tip");if(i)try{i=e.parseJSON(i)}catch(o){throw i={},"get_user_data: ���������� JSON � @data-linked-tip"}else i={};return n||(n={}),e.extend({},i,n,t)},t.show_tip=function(e){e.css("visibility","visible").show()},t.hide_tip=function(e){e.hide().css("visibility","hidden")};var i=function(e,t){var n=t["offset-left"];return n.offset().left+n.outerWidth()},o=function(t){var n=e(t["offset-top"]);return Math.floor(n.offset().top+n.outerHeight()/2)},a=function(e,t){e.css("top",t)},s=function(n,i,s){for(var r,l=t.tips.filter(function(t){return e(t.tip).is(":visible")||t.tip==s[0]}).sort(function(t,n){return e(t.options["offset-top"]).offset().top<e(n.options["offset-top"]).offset().top}),c=-1,d=0,m=l.length;m>d;d++)if(l[d].tip==n[0]){c=d;break}if(-1!=c)for(var d=0,m=l.length;m>d;d++){var u=e(l[d].tip),h=o(l[d].options)-u.outerHeight()/2;if(0>h&&(h=0),0!=d){var p=e(l[d-1].tip),f=r+p.outerHeight();f>h&&(h=f+1)}(0==h||n.offset().top!=h)&&a(e(u),h),r=h}};t.commands={show:function(n){if(n.theme||(n.theme="error"),t.dom_ready){var o=t.tips.get(this);o&&(n=e.extend(o.options,n));var a=e.extend({html:e(".ym-linked-tip-hint",e(this).parent()).html(),wrap:e('<div class="ym-linked-tip-wrap"><div class="arrow"><img class="ipng" /></div><div class="ym-linked-tip-inner" /></div>'),"offset-left":this,"offset-top":this},t.get_user_data.call(this,n));a["offset-left"]=e.isFunction(a["offset-left"])?a["offset-left"](this):e(a["offset-left"]),a["offset-top"]=e.isFunction(a["offset-top"])?a["offset-top"](this):e(a["offset-top"]),"string"==typeof a.wrap&&(a.wrap=e(a.wrap));var r=a.wrap,l=e(".ym-linked-tip-inner",r);l||(l=e('<div class="ym-linked-tip-inner" />'),r.append(l)),l.html(a.html),css_property("BoxShadow")?r.addClass("with-native-shadow"):l.parent().is(".ym-tip__shadow")||(wrap=e('<div class="ym-linked-tip-wrap__inner"> 		                              <div class="ym-tip__shadow"/> 		                              <div class="ym-tip__shadow-bottom"> 		                                  <div class="ym-tip__shadow-bottom__l" /> 		                                  <div class="ym-tip__shadow-bottom__r" /> 		                              </div> 		                          </div>'),inner=l.clone(),e(".ym-tip__shadow",wrap).html(inner),l.replaceWith(wrap)),o||(o={target:this,tip:r[0]},t.tips.push(o),t.hide_tip(r),t.block.append(r)),o.options=a;var c=i(r,a);r.css("left",c),s(r,a,r);var d="ym-linked-tip_theme_"+n.theme;("notice"==n.theme||"newb-error"==n.theme||"error"==n.theme)&&(d="ym-linked-tip-wrap-"+n.theme),e(r.attr("class").split(" ")).each(function(e,t){("ym-linked-tip-wrap-error"==t||"ym-linked-tip-wrap-notice"==t||-1!=t.indexOf("ym-linked-tip_theme_"))&&r.removeClass(t)}),r.addClass(d),e(".arrow .ipng",r).attr("src","/i/"+n.theme+"s/18x12/left.png"),t.show_tip(r)}else{var m=t.post_execute.list(),u=m.length,h=t.post_execute.indexOf(this);-1!=h&&(u=h),m[u]={target:this,tip:null,options:n}}return r},hide:function(){var n=t.tips.get(this);n&&n.tip&&(t.hide_tip(e(n.tip)),e.linked_tip.update())},destroy:function(){var n=t.tips.indexOf(this);if(-1!=n){var i=t.tips.list();e(i[n].tip).remove(),i.splice(n,1)}}},e.fn.linked_tip=t,e.linked_tip=function(t){return t?e(t).linked_tip(Array.prototype.slice.call(arguments,1)):void 0},e.linked_tip.dom_ready=function(n){if(t.dom_ready=n?n:!0,t.dom_ready){e(document.body).append(t.block);for(var i=t.post_execute.list(),o=0,a=i.length;a>o;o++){var s=i[o];e(s.target).linked_tip(s.options)}t.post_execute.clear()}},e.linked_tip.update=function(n){var i=n;if(n){if(!e.isArray(n))throw"$.linked_tip.update: ��������� ������ ������.";n[0]&&!n[0].tip&&(i=[],e(n).each(function(e,n){var o=t.tips.get(n);o&&(i[i.length]=o)}))}else i=t.tips.filter(function(t){return e(t.tip).is(":visible")}).list();e(i).each(function(t,n){e(n.target).linked_tip("show",n.options)})};var r=null,l=[];e(window).bind("resize",function(){var n=0;clearTimeout(r),e(t.tips.filter(function(t){return e(t.tip).is(":visible")}).list()).each(function(n,i){l[l.length]=i,t.hide_tip(e(i.tip))}),r=setTimeout(function(){if(25>n)try{e.linked_tip.update(l),l=[]}catch(t){return r=setTimeout(arguments.callee,100),n++,!1}},100)})}(jQuery),$(document).ready(function(){$.linked_tip.dom_ready(),$(".ym-linked-tip").linked_tip()}),Array.prototype.filter||(Array.prototype.filter=function(e){"use strict";
if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var i=[],o=arguments[1],a=0;n>a;a++)if(a in t){var s=t[a];e.call(o,s,a,t)&&i.push(s)}return i}),"undefined"==typeof jQuery.contains){var contains=document.compareDocumentPosition?function(e,t){return!!(16&e.compareDocumentPosition(t))}:function(e,t){return e!==t&&(e.contains?e.contains(t):!0)};jQuery.contains=contains}!function(e){var t=function(e,t,n){this.owner=e,this.options=t,this.elem=n};t.prototype={isVisible:function(){return"none"!==this.elem.css("display")},show:function(t){return e.extend(this.options,t),a.show_tip(this.elem,this.options),this},hide:function(){return a.hide_tip(this.elem,this.options),this},toggle:function(e){return"none"===this.elem.css("display")?this.show(e):this.hide(),this},setHtml:function(e){this.options.html="<div>"+e+"</div>"},moveOnTop:function(){var e=this.elem,t=parseInt(e.css("z-index"),10),n=this.options;if(this.isVisible()){for(var o=i.getVisible(),s=20001,r=0,l=o.length;l>r;r++){var c=parseInt(o[r].elem.css("z-index"),10);c>s&&(s=c)}(!t||s>t)&&(n["z-index"]=s+10,a.show_tip(e,n))}return this},_bindEvents:function(){var t,n=this.options,i=this.elem,o=this.owner,s=null,r=function(e){a.hide_tip(i,n),o.trigger("close-tip-icon-clicked"),e.stopPropagation()};e(n.hide).each(function(o,r){var l=r.target,c=r.event,d=function(){clearTimeout(t);var e=r.delay||0;t=setTimeout(function(e,t){return function(){a.hide_tip(e,t)}}(i,n),e)},m=d;if("unfocus"===c){c="click",l=e(document.body);var u=n.arrow;m=function(t){t.target===i[0]||e.contains(i[0],t.target)||u&&(u[0]===t.target||e.contains(u[0],t.target))||("click"===t.type&&i.is(":visible")?d(t):null===s||s.target!==t.target||s.type!==t.type?d(t):s=null)}}e(l).bind(c,m)}),e(n.show).each(function(o,r){e(r.target).bind(r.event,function(o,l){e.extend(n,l),clearTimeout(t),s=o;var c=r.delay||0;t=setTimeout(function(e,t){return function(){a.show_tip(e,t)}}(i,n),c)})}),n["top-by-click"]&&i.bind("click",function(){e(this).simple_tip("get").moveOnTop()}),i.on("click",n.close,r)}};var n=function(t){var n=this;e.each(t,function(e){n[e]=t[e]}),this.length=t.length};n.prototype={show:function(t){return e.each(this,function(e,n){n.show(t)}),this},hide:function(){return e.each(this,function(e,t){t.hide()}),this},toggle:function(t){return e.each(this,function(e,n){n.toggle(t)}),this},moveOnTop:function(){return e.each(this,function(e,t){t.moveOnTop()}),this}};var i=[];i.get=function(t){return t=e(t)[0],this.filter(function(e){return e.elem[0]===t||e.owner[0]===t})},i.getVisible=function(t){var n=t?i.get(t):this;return n.filter(function(t){return e(t.elem).is(":visible")})};var o=[],a={container:e('<span class="ym-simple-tip-block"/>'),dom_ready:!1,cached_images:[],image_cache:function(t,n){var i="";if(".ym-simple-tip-close"===n.close&&t.find(n.close)[0]&&e.isFunction(window.getComputedStyle)){var o=window.getComputedStyle(t.find(n.close)[0],!1);o&&(i=o.backgroundImage.slice(4,-1).replace(/"/g,""))}i&&-1===e.inArray(i,this.cached_images)&&((new Image).src=i,this.cached_images.push(i))},show_tip:function(e,t){var n=t.arrow,i=t.show.fade,o=function(e,t){t?e.fadeIn(t):e.css("visibility","visible").show()};t.onshowbefore&&t.onshowbefore.call(e),this.render_tip(e,t),o(e,i),n&&o(n,i),t.onshow&&t.onshow.call(e)},hide_tip:function(e,t){var n=t.arrow,i=t.show.fade,o=function(e,t){t?e.fadeOut(t):e.css("visibility","hidden").hide()};t.onhidebefore&&t.onhidebefore.call(e),o(e,i),n&&o(n,i),t.onhide&&t.onhide.call(e)},reverse_position:function(t){var n=["top","bottom","left","right"],i=e.inArray(t,n)+1;return-1!=i&&(t=n[i+(i%2*2-1)-1]),t},remove_class:function(e,t){var n=new RegExp("\\b"+t+".*?\\b","g");e.className=e.className.replace(n,"")},calculate_prim:function(t,n,i){var o=-8;n.arrow?("left"==i.css_name||"top"==i.css_name)&&(o=-1*o):o=0;var a=n.indent,s=i.target_offset[i.css_name];if(i.arrow){var r=1===i.mod?i.body_size:o;e.each(i.arrow.attr("class").split(/\s+/),function(e,t){-1!=t.indexOf("ym-simple-tip-arrow-")&&i.arrow.removeClass(t)}),i.arrow.addClass("ym-simple-tip-arrow-"+this.reverse_position(i.user_position)),i.arrow.css(i.css_name,s.offset+i.mod*(r+a))}t.addClass("ym-simple-tip-type-"+this.reverse_position(i.user_position)),t.css(i.css_name,s.offset+i.mod*(i.body_size+o+a))},calculate_slave:function(e,t,n){var i=0,o=t.focus,a=n.target_offset[n.css_name];if(a.node&&("center"==t.align?i=a.node[n.method]()/2:"right"==t.align&&(i=a.node[n.method]())),n.arrow){var s=a.offset+i+o;t["center-arrow"]&&(s=a.offset-2*i),n.arrow.css(n.css_name,s)}e.css(n.css_name,a.offset+i+o)},update_width:function(t,n){t.width("auto");var i=n["box-width"],o=!1;if(i){var a=i.min;if(a&&a>t.outerWidth())t.width(a),o=!0;else{var s=i.max;if(s&&s<t.outerWidth())t.width(s),o=!0;else{var r=i.val;r&&(t.width(r),o=!0)}}}o?e(".ym-tip-content",t).addClass("ie-zoom"):e(".ym-tip-content",t).removeClass("ie-zoom")},render_tip:function(t,n){var i={arrow:n.arrow,css_name:"left",method:"outerWidth",mod:1,target_offset:{},user_position:n.position},o="top",a="outerHeight";i.arrow&&e(i.arrow).css("z-index",n["z-index"]),t.css("z-index",n["z-index"]);for(var s=0,r=["top","left"];s<r.length;s++){var l=r[s],c=n["offset-"+l];i.target_offset[l]={};var d=e(c);i.target_offset[l].node=d,i.target_offset[l].offset=d.offset()[l]}if("top"==i.user_position||"bottom"==i.user_position){var m=i.css_name;i.css_name=o,o=m,m=i.method,i.method=a,a=m}n["update-content"]&&n.html!=e(".ym-tip-content",t).html()&&e(".ym-tip-content",t).html(n.html),n.theme&&!e(t).hasClass("ym-simple-tip_theme_"+n.theme)&&(this.remove_class(t[0],"ym-simple-tip_theme_"),"none"!==n.theme&&e(t).addClass("ym-simple-tip_theme_"+n.theme),n.arrow&&(this.remove_class(i.arrow[0],"ym-simple-tip-arrow_theme_"),"none"!==n.theme&&e(i.arrow).addClass("ym-simple-tip-arrow_theme_"+n.theme))),this.update_width(t,n);var u=i.arrow?8:0,h=i.target_offset.top.offset+i.target_offset.top.node.outerHeight()+u+t.outerHeight(),p=e(window).height()+e(window).scrollTop();if("bottom"==i.user_position&&h>p&&(i.user_position="top"),"top"==i.user_position||"left"==i.user_position)i.mod=-1,i.body_size=t[i.method]();else{var f=i.target_offset[i.css_name];i.body_size=f.node?f.node[i.method]():0}if(this.calculate_prim(t,n,i),i.css_name=o,i.method=a,this.calculate_slave(t,n,i),e.browser.msie){var g=document.createTextNode(" "),b=e(".ym-simple-tip-block div");e(b).each(function(e,t){t.appendChild(g),t.removeChild(g)})}},normalizeOptions:function(t){var n=t["box-width"];("string"==typeof n||"number"==typeof n)&&(t["box-width"]={val:n});for(var i,o=this,a=0,s=["show","hide"];a<s.length;a++)i=t[s[a]],e.isArray(i)||(i=[i]),e.each(i,function(e,t){t.target||(t.target=o)});var r=t.html?e(t.html):e(this).next(".ym-simple-tip-hint");if(t.html=r.html(),t["del-hint-elem"]&&r.remove(),t.arrow){var l=e('<div class="ym-simple-tip-arrow"/>');t.theme&&l.addClass("ym-simple-tip-arrow_theme_"+t.theme),t.arrow=l.html('<i class="ym-simple-tip-arrow-i-border"><i class="ym-simple-tip-arrow-i"></i></i>')}if(t.arrow&&t["arrow-focus"]){var c=t.position,d="left"===c||"right"===c?-16:-18;t.focus=t.focus+d}return"right"===t.position&&(t.indent=t.indent+4),t},commands:{init:function(n){if(a.dom_ready){var s=e(this).data("simple-tip")||{},r={align:"center",focus:0,"arrow-focus":!0,indent:0,"update-content":!0,"del-hint-elem":!1,"show-on-ready":!1,"top-by-click":!1,"z-index":2e4,position:"top","offset-left":e(this),"offset-top":e(this),arrow:!0,close:".ym-simple-tip-close",show:{target:this,event:"mouseover",delay:300},hide:{target:this,event:"mouseout",delay:0},"center-arrow":!1},l=e.extend({},r,s,n);l=a.normalizeOptions.call(this,l);var c=e('<div class="ym-simple-tip-wrap"/>');a.hide_tip(c,l),l.theme&&c.addClass("ym-simple-tip_theme_"+l.theme);var d=e('<div class="ym-tip-content"/>');d.append(l.html),c.html(d),a.image_cache(c,l),l.arrow&&e(a.container).prepend(l.arrow),e(a.container).prepend(c);var m=new t(e(this),l,c);i.push(m),m._bindEvents(),l["show-on-ready"]&&a.show_tip(c,l),l.oninit&&l.oninit.call(c)}else o.push({owner:this,options:n})},get:function(e){var e=e||"all";switch(e){case"all":result=i.get(this);break;case"visible":result=i.getVisible(this)}return result}}};e.fn.simple_tip=function(t){var i=Array.prototype.slice.call(arguments),o=a.commands,s=[],r=!1;return this.each(function(){var n,a=e.extend(!0,[],i);if(o[t])n=o[t].apply(this,Array.prototype.slice.call(a,1));else{if("object"!=typeof t&&t)throw"Method "+t+" does not exist on jQuery.simple_tip";n=o.init.apply(this,Array.prototype.slice.call(a,0))}if("undefined"!=typeof n)if(r||(r=!0),e.isArray(n))for(var l=0,c=n.length;c>l;l++)s.push(n[l]);else s.push(n)}),"get"===t&&(s=new n(s)),r?s:this},e.simple_tip=function(t){return t?e(t).simple_tip(Array.prototype.slice.call(arguments,1)):void 0},e.simple_tip.update=function(){var t=i.getVisible();e.each(t,function(e,t){a.show_tip(t.elem,t.options)})},e.simple_tip.get=function(e){var t,e=e||"all";switch(e){case"all":t=i;break;case"visible":t=i.getVisible()}return new n(t)},e(window).bind("resize",e.throttle(function(){e.simple_tip.update()},100)),e.fn.simpleTip=e.fn.simple_tip,e.simpleTip=e.simple_tip,e(document).ready(function(){a.dom_ready=!0,e(document.body).append(a.container),e.each(o,function(t,n){e(n.owner).simple_tip(n.options)}),e(".ym-simple-tip").simple_tip()})}(jQuery),YaMoney.block["b-allowed-cps-payment-types_theme_popup"]=function(){var e=this,t=e.closest(".b-popupa"),n=t.getBlockByElem("b-popupa"),i=e.data("close-click-counter"),o=e.data("stay-here-payment-types");this.find(".b-allowed-cps-payment-type__link").on("click",function(t){var i=$(this),a=i.data("payment-type");o.indexOf(a)>-1&&(t.preventDefault(),e.trigger("cps:payment-type-chosen",[{switchToCpsUrl:$(this).attr("href"),paymentType:a,cpsSource:i.data("cps-source"),cpsProvider:i.data("cps-provider"),requestid:i.data("requestid"),title:i.find(".b-allowed-cps-payment-type__title").text()}]),n.hide())}),i&&n.elem("close").on("click",function(){r(this,i)}),n.on("show",function(){e.find(".b-allowed-cps-payment-type").each(function(e,t){t=$(t);var n=t.data("popup-show-counter");n&&r(this,"stred/"+n)})})},$(function(){function e(t,n,i,o){i=i||"default",o=o||"default";var a=t.find('.b-allowed-cps-payment-type[data-payment-type="'+n+'"][data-cps-source="'+i+'"][data-cps-provider="'+o+'"]');a.size()||"default"==i?a.show():e(t,n,"default",o)}function t(t,n){var i=t.find(".b-allowed-cps-payment-type");i.hide(),n.each(function(n,i){i=$(i);var o=i.find("cps_provider");o.size()?o.each(function(n,o){e(t,i.attr("id"),i.find("cps-source").text(),$(o).text())}):e(t,i.attr("id"),i.find("cps-source").text(),"default")}),e(t,"PC"),t.show()}function n(t){t.find(".b-allowed-cps-payment-type").hide(),e(t,"PC"),e(t,"AC"),t.show()}$(".b-allowed-cps-payment-types").on("update-payment-types",function(e,i){var o=$(this),a=o.data("allowed-types-short");if(i.size()&&a)switch(a){case"all":t(o,i);break;case"card":n(o)}else o.hide()})}),YaMoney.block["b-allowed-cps-payment-types__popup-toggler"]=function(){var e=this.data("popup-selector"),t=$(e),n=t.getBlockByElem("b-popupa"),i=this.data("click-counter");this.on("click",function(e){i&&r(this,i),n.toggle($(this)),e.preventDefault()}),n.on("outside-click",function(e){e.preventDefault()})},$(function(){if($(".b-anchor-select").length){var e=function(){var e=encodeURIComponent(location.hash.substr(1)),t=$("a[name='"+e+"']"),n="b-anchor-select",i="b-anchor-select_active";$("."+i).removeClass(i),t.length&&t.parent().hasClass(n)&&t.parent().addClass(i)};e(),$(".msie8").length||$(".msie9").length||$(".msie10").length||!("onhashchange"in window)?$("body").on("click","a",function(){setTimeout(e,1)}):$(window).on("hashchange",e)}}),YaMoney.block["b-autopayments"]=function(){var e,t=$(this),n=$("form[name=checkpay]"),i=$(".b-autopayments__datepicker-link"),o=$("input[name=autopayment-sum]"),a=$("input[name=autopayment-date]"),s=$("#b-autopayments__terms-icon"),r=$("#autopayment-on"),l=ym.i18n.key("js_portal_js_ui__ui.js","day_names_min__4406c99c8f").split(","),c=ym.i18n.key("js_portal_js_ui__ui.js","day_names_full__b6103cf522").split(","),d=ym.i18n.key("js_portal_js_ui__ui.js","month_names_full__7467c2c563").split(","),m=!1,u=function(t){if(m)i.datepicker("hide"),m=!1;else{var n=$(t),o=n.offset();o.top+=24,o.left-=85,e=a.val(),i.datepicker("dialog",a.val(),h,{onClose:function(e,t,n){if(n){var o=n.target||n.srcElement;m=$.contains(i.get(0),$(o).get(0))}},beforeShow:function(e,t){$.simpleTip.get("visible").hide(),$(e).zIndex(100),$.datepicker._updateDatepicker(t);var n=$.datepicker._checkOffset(t,o,!1);t.dpDiv.toggleClass("ui-datepicker-position-top",n.top<i.offset().top),t.input.addClass("g-hide")},dayNamesMin:l,dayNames:c,monthNames:d,firstDay:1,minDate:"+2w",dateFormat:"dd.mm.yy",hideIfNoPrevNext:!0},[o.left,o.top]),m=!0}};i.on("click",function(){var e=this;u(e)});var h=function(e){if(!e){var t=new Date,n=t.getDate(),o=new Date(t.getFullYear(),t.getMonth()+1,0).getDate();n===o&&(n=new Date(t.getFullYear(),t.getMonth()+2,0).getDate());var s=t.getMonth()+2;e=n+"."+(10>s?"0":"")+s+"."+t.getFullYear()}a.val(e);var r=ym.toNum(e.substring(0,2));i.find(".b-autopayments__date").text(r)};s.on("click",function(){$(".b-autopayments__terms-text .sum").text(o.val());var e=ym.toNum(a.val().substring(0,2));$(".b-autopayments__terms-text .date").text(e),$(this).simpleTip("get")[0].show({html:$(".b-autopayments__terms-text").html()})}),s.simpleTip({arrow:!0,position:"right","box-width":"340",show:{event:"showTerms"},hide:{event:"mouseout",delay:300}}),r.one("click",function(){r.prop("checked")&&t.trigger("show-autopayment")});var p=function(){var e=ym.toNum(o.val()),n=t.data("sum-current"),i="";return e?e<t.data("sum-min")?i="min":e>t.data("sum-max")?i="max":e>n?(i="current",$.ymReachCounterGoal("AUTOPAY_SUM_UP_ERROR")):n>e&&$.ymReachCounterGoal("AUTOPAY_SUM_LOWER"):i="empty",i&&o.elementModifier({blockName:"b-form-input",mode:"set",modName:"error",modValue:"yes",className:"error",callback:function(){f(i)}}),!i};n.on("submit",function(){n.find(".b-form-input_error_yes").length&&t.trigger("hide-autopayment");var e=t.data("prechecked");if($('input[name="autopayment-through-popup"]').val(e&&r.prop("checked")),!e&&r.prop("checked")&&$.ymReachCounterGoal("AUTOPAY_SWITCH"),e&&!r.prop("checked")){var i=$("input[name=regular-service-type][value=reminder]").length;$.ymReachCounterGoal(i?"AUTOPAY_REMINDER_ON":"AUTOPAY_NOTHING_ON")}return r.prop("checked")?p()?($("input[name=regular-service-type]:hidden").remove(),!0):!1:void 0});var f=function(e){t.trigger("hide-autopayment"),o.simpleTip("get")[0].show({html:"<span>"+t.data("error-"+e)+"</span>"})};o.on("keyup",function(){o.elementModifier({blockName:"b-form-input",mode:"delete",modName:"error",className:"error"}).trigger("hideError")}).on("change",function(){var e=$(this).val();$(this).val(e.replace(",",".")),p()}).simpleTip({"offset-left":"#b-descr-and-confirm, .b-payment-success",theme:"red",arrow:!0,position:"right",show:{event:"showError"},hide:{event:"hideError"}}),$(document).ready(function(){h(a.val());var e=n.find(".b-form-input_error_yes").length;if($("#b-autopayments__already-has-text").length&&!e&&t.simpleTip({html:"#b-autopayments__already-has-text",arrow:!0,position:"right","offset-left":"#b-descr-and-confirm, .b-payment-success","offset-top":"#autopayment-on","box-width":"340",theme:"payment-reminder",hide:[{target:"#b-payment-reminder__reminders-close",event:"click"},{target:t,event:"hide-autopayment"}],show:{event:"show-autopayment"}}),$("#b-autopayments__popup-info").length&&!e&&t.simpleTip({html:"#b-autopayments__popup-info",arrow:!0,position:"right","box-width":492,"offset-left":"#b-descr-and-confirm, .b-payment-success","offset-top":"#autopayment-on","show-on-ready":!0,show:{event:"show-autopayment-popup"},hide:[{target:"#b-autopayments__popup-close",event:"click"},{target:t,event:"hide-autopayment"}]}),$("#totp-response").length){var i=$(".challenge-totp-wrapper");i.data("check-failed")&&$.ymReachCounterGoal("AUTOPAY_TOTP2")}var o=t.data("pagereloaded");if(!o){var s=t.data("prechecked");$.ymReachCounterGoal(s?"AUTOPAY_IS":"AUTOPAY_OFF")}var r=$(".challenge-switch-to-cps").find("a");r.click(function(){$.ymReachCounterGoal("AUTOPAY_OTHER_METHOD")})})},YaMoney.block["b-autopayments-popup"]=function(){function e(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}YaMoney.bAutopaymentsPopup=YaMoney.block["b-island-modal"]({data:$(".b-autopayments-popup__templates").html()});var t,n,i,o,a,s,r=$(this),l=r.data("reminder-disabled"),c=ym.i18n.key("js_portal_js_ui__ui.js","day_names_min__4406c99c8f").split(","),d=ym.i18n.key("js_portal_js_ui__ui.js","day_names_full__b6103cf522").split(","),m=ym.i18n.key("js_portal_js_ui__ui.js","month_names_full__7467c2c563").split(","),u={hasError:!1,isDatepickerVisible:!1},h=function(){$.simpleTip.get("visible").hide()},p=function(){var e=$(this);if(!u.isDatepickerVisible){e.addClass("b-island-modal__pseudolink_border_none");var i=e.offset();i.top+=24,i.left-=85,t=n.val(),e.datepicker("dialog",n.val(),T,{onClose:function(i,o,a){if(a){var s=a.target||a.srcElement;u.isDatepickerVisible=e.is($(s)),e.removeClass("b-island-modal__pseudolink_border_none")}t!==n.val()&&$.ymReachCounterGoal("AUTOPAY_POPUP_CHANGES")},beforeShow:function(t,n){h(),$(t).zIndex(999),$.datepicker._updateDatepicker(n);var o=$.datepicker._checkOffset(n,i,!1);n.dpDiv.toggleClass("ui-datepicker-position-top",o.top<e.offset().top),n.input.addClass("g-hide")},dayNamesMin:c,dayNames:d,monthNames:m,firstDay:1,minDate:"+2w",dateFormat:"dd.mm.yy",hideIfNoPrevNext:!0},[i.left,i.top])}u.isDatepickerVisible=!u.isDatepickerVisible},f=function(e){var t,n=$(e.target);n.hasClass("b-island-modal__pseudolink_inputplace")?(t=n,n=n.parent()):t=n.find(".b-island-modal__pseudolink_inputplace"),n.addClass("b-island-modal__pseudolink_border_none");var i=$("<input>",{val:t.text(),type:"text",size:t.data("size")});t.replaceWith(i),i.addClass("b-island-modal__pseudolink_input"),i.on("blur",g),i.select()},g=function(){$(this).trigger("hideError");var e=$(this).val();$(this).val(e.replace(",","."));var t=$(this).val(),n=b(t);if(n)return Y(n,$(this)),!1;var o=$("<span>",{text:$(this).val()});i.val($(this).val()),o.addClass("b-island-modal__pseudolink_inputplace").data("size",$(this).attr("size")),$(this).parent().removeClass("b-island-modal__pseudolink_border_none"),$(this).replaceWith(o)},b=function(e){e=ym.toNum(e);var t=r.data("sum-current"),n="";return e?e<r.data("sum-min")?n="min":e>r.data("sum-max")?n="max":e>t?(n="current",$.ymReachCounterGoal("AUTOPAY_POPUP_CHANGES")):t>e&&$.ymReachCounterGoal("AUTOPAY_POPUP_CHANGES"):n="empty",u.hasError=!!n,n},y=function(){r=$("#b-autopayments-popup"),s=r.data("editable"),window.location.replace("#autopayments-popup-is-opened");var e=$(".b-autopayments-popup__form"),t=$(".b-autopayments-popup__done");s?(n=e.find("input[name=autopayment-date]"),i=e.find("input[name=autopayment-sum]"),o=e.find(".b-autopayments-popup__datepicker-link"),o.on("click",p),a=r.find(".b-autopayments-popup__sum-link"),a.on("click",f)):B(M),$(".b-island-modal__close-link").click(_),$(".b-autopayments-popup__close").click(_),t.on("submit",v),e.on("submit",C),setTimeout(_,3e5)},_=function(){!l&&s&&E(),YaMoney.bAutopaymentsPopup.close()},v=function(){YaMoney.bAutopaymentsPopup.close()},w=function(){r.find(".b-island-modal-dialog__controls").hide()},k=function(){r.find(".b-island-modal-dialog__controls").show()},C=function(e){if(e.stopPropagation(),e.preventDefault(),u.hasError)return!1;var t=S();$.getJSON("/internal/autopayments-ajax.xml",t).done(function(e){e.success||v(),x(),e["strong-auth"]?B(M):$.getJSON("/internal/autopayments-ajax.xml",{action:"add-sign","autopayment-save-request-id":e["request-id"]}).done(function(e){e.success||v(),l=!0,M(),$.ymReachCounterGoal("AUTOPAY_POPUP_ON")})})},M=function(){k(),r.find(".b-autopayments-popup__form").hide(),r.find(".b-autopayments-popup__done").show()},x=function(){r.find(".b-island-modal__pseudolink").unbind("click").removeClass("b-island-modal__pseudolink")},S=function(){var e=r.find('input[name="autopayment-date"]').val(),t=r.find('input[name="autopayment-sum"]').val(),n=r.find('input[name="autopayment-name"]').val(),i=r.find('input[name="request-id"]').val();return{action:"add-check","autopayment-date":e,"autopayment-sum":t,"autopayment-name":n,"source-request-id":i}},B=function(t){w(),r.find(".b-autopayments-popup__close").show();var n=S();n["source-payment-id"]=r.find('input[name="source-payment-id"]').val();var i=r.find(".b-autopayments-popup__sauth");i.show();var o=i.data("url")+"?"+e(n);r.find(".b-autopayments-popup__sauth_iframe iframe").attr("src",o);var a=function(e){var n="success"===e.data.status;n&&t()};window.addEventListener?window.addEventListener("message",a,!1):window.attachEvent("message",a)},Y=function(e,t){0===t.simpleTip("get").length&&t.simpleTip({theme:"red",arrow:!0,position:"right",show:{event:"showError"},hide:{event:"hideError"}}),t.simpleTip("get")[0].show({html:"<span>"+r.data("error-"+e)+"</span>"}),t.trigger("showError")},T=function(e){if(!e){var t=new Date,i=t.getDate(),a=new Date(t.getFullYear(),t.getMonth()+1,0).getDate();i===a&&(i=new Date(t.getFullYear(),t.getMonth()+2,0).getDate());var s=t.getMonth()+2;e=i+"."+(10>s?"0":"")+s+"."+t.getFullYear()}n.val(e);var r=ym.toNum(e.substring(0,2));o.find(".b-autopayments-popup__date").text(r)},E=function(){if(r.data("reminder-has-current"))return $.ymReachCounterGoal("AUTOPAY_POPUP_NOTHING_ON"),!1;$.ymReachCounterGoal("AUTOPAY_POPUP_REMINDER_ON");var e="month",t=r.data("reminder-date"),n=r.data("scid"),i=r.attr("data-payment-id"),o="create",a={"reminder-period":e,"reminder-date":t,"reminder-scid":n,action:o,"payment-id":i};$.post("/internal/reminder-ajax.xml",a,function(){})},I=window.location.hash.substring(1);"autopayments-popup-is-opened"!==I&&($(".b-autopayments-popup__templates").detach().appendTo(".b-island-modal__data"),YaMoney.bAutopaymentsPopup.show({openFinish:y,closeStart:h,closeOnOuterClick:!1}))},YaMoney.block["b-autopayments-reserved"]=function(){var e=$(this);$.post("/ajax/efos/reserve-autopayment",{requestId:e.data("request-id"),contragentCode:e.data("contragent-code"),autopaymentType:e.data("autopayment-type"),paymentId:e.data("payment-id"),autopaymentSum:e.data("autopayment-sum"),thresholdSum:e.data("recharge-threshold"),phoneNumber:e.data("phone-number"),"autopayment-by-card-enabled":!0})},YaMoney.block["b-autorecharge"]=function(){var e=$(this),t=e.find(".b-autorecharge__title"),n=e.closest(".b-payment-success__auto-settings").find(".b-payment-success__auto-settings-controls-recharge"),i=n.find("input[name=sum]"),o=i.getBlockByElem("b-form-input"),a=n.find("*[name=rechargeThreshold]"),s=a.getBlockByElem("b-form-input, b-form-select"),r=n.find("*[name=typeOfPayment]"),l=r.getBlockByElem("b-form-select"),c=n.find('form[name="autorecharge-form"]'),d=n.find(".b-autorecharge__controls"),m={min:d.data("min-sum"),max:d.data("max-sum")},u={min:d.data("min-sum-invoice"),max:d.data("max-sum")},h={min:d.data("min-balance"),max:d.data("max-balance")},p=e.find(".b-autorecharge__errors"),f=e.data("is-expanded"),g=e.closest(".b-payment-success__auto-settings").data("cpath"),b=($("input[name=contragentCode]",n).val(),function(){this.delMod("error"),this.elem("input").simple_tip("get").length&&this.elem("input").simple_tip("get")[0].hide()}),y=function(t,n){var i="."+n,o=e.find(i).add(e.closest(i)).data("handlers");return o&&ym.isFunction(o[t])?o[t]:!1},_=function(e,t,n){var i={success:!0};return isNaN(e)||0===e?i={error:v(n+"-empty")}:e<t.min?i={error:v(n+"-out-of-limits-min")}:e>t.max&&(i={error:v(n+"-out-of-limits-max")}),i},v=function(e){return p.find("."+e).text()};c.on("submit",function(e){var t="sum",n={},r=ym.toNum(o.val());return"INVOICE"===l.val()?(t="sum-invoice",n=_(r,u,t)):n=_(r,m,t),n.error&&(o.setMod("error","yes"),i.simple_tip("get")[0].show({html:n.error,theme:"red"})),a.length&&a.is(":visible")&&n.success&&(n=_(ym.toNum(s.val()),h,"threshold"),n.error&&(b.call(o),s.setMod("error","yes"),a.simple_tip("get")[0].show({html:n.error,theme:"red"}))),Lego.cp("41","72363",g),n.error?(e.preventDefault(),!1):!0});var w=function(){var e=this,t=e.val().toLowerCase();$(".b-autorecharge__switchable",n).addClass("g-hide"),$(".b-autorecharge__"+t,n).removeClass("g-hide"),"invoice"===t?(i.on("focus.showHint",function(){return $(this).trigger("showSumHint"),!0}).on("blur.showHint",function(){return $(this).trigger("hideSumHint"),!0}),s.elem("button").trigger("hideThresholdHint")):i.off(".showHint")},k=function(t){Lego.cp("41","72361",g);var i=y("showControls","b-payment-success__auto-settings"),a=n.is(":visible");a||Lego.cp("41","72362",g),i(a?"":"recharge"),a=!a,l.length&&w.call(l),a?$(document).on("click.hideSettings",function(t){n.has(t.target).length||e.has(t.target).length||s.length&&s.domElem.has(t.target).length||$(t.target).parent().find(".b-form-select__text").length||(b.call(o),b.call(s),i(""))}):(b.call(o),b.call(s),$(document).off("click.hideSettings")),t&&t.stopPropagation()};if(t.on("click",k),l.on("change",w),i.add(a).simple_tip({"offset-left":n,theme:"red",arrow:!0,position:"right",show:{event:"showError"},hide:{event:"hideError"}}),i.simple_tip({"offset-left":n,arrow:!0,position:"right",show:{event:"showSumHint"},hide:{event:"hideSumHint"},html:$(".b-autorecharge__errors .sum-hint")}),s.elem("input").length){var C=s.elem("input");C.simple_tip({"offset-left":n,arrow:!0,position:"right",show:{event:"showThresholdHint"},hide:{event:"hideThresholdHint"},html:$(".b-autorecharge__errors .threshold-hint-input")}),C.on("focus.showHint",function(){return $(this).trigger("showThresholdHint"),!0}).on("blur.showHint",function(){return $(this).trigger("hideThresholdHint"),!0})}else if(s.elem("button").length){var M=s.elem("button");M.simple_tip({"offset-left":n,arrow:!0,position:"right",show:{event:"showThresholdHint"},hide:{event:"hideThresholdHint"},html:$(".b-autorecharge__errors .threshold-hint")}),M.on("mousedown",function(){M.trigger("showThresholdHint")}),s.on("change",function(){M.trigger("hideThresholdHint")})}o.on("focus",b),s.on("focus",b),$(document).ready(function(){f&&k(),b.call(o),Lego.cp("41","72360",g)})},YaMoney.block["b-button"]=function(){$(".b-button__input").focus(function(){$(this).closest(".b-button").addClass("b-button_focused_yes")}),$(".b-button__input").blur(function(){$(this).closest(".b-button").removeClass("b-button_focused_yes")})},YaMoney.block["b-carousel"]=function(e){var t=this;YaMoney.carousel=YaMoney.carousel||new YaMoney.Carousel;var n=$.extend({elements:{mainContainer:t.attr("id"),leftButton:"carousel-left",rightButton:"carousel-right",itemsContainer:"items-container",itemsContainerInner:"items-container-inner",scrollBarContainer:"scroll-container",scrollBarBar:"scroll-bar"},settings:{speed:0,itemsToShow:3,scrollCount:3,activeButtonClassName:"b-carousel__button_enable",buttonPressedClassName:{right:"b-carousel__button_pressed",left:"b-carousel__button_pressed"},endless:!1,scrollSupport:!0,arrowsSupport:!0},scrollBar:{container:"scroll-container",bar:"scroll-bar",enabled:!0}},e);YaMoney.carousel.init(n)},YaMoney.block["b-shops-carousel"]=function(e){var t=this;YaMoney.carousel=YaMoney.carousel||new YaMoney.Carousel;var n=$.extend({elements:{mainContainer:t.attr("id"),leftButton:"carousel-left",rightButton:"carousel-right",itemsContainer:"items-container",itemsContainerInner:"items-container-inner",pagerContainer:"carousel-pager"},settings:{speed:0,itemsToShow:1,scrollCount:1,activeButtonClassName:"b-carousel__button_enable",endless:!0,usePager:!0,timer:8e3,arrowsSupport:!0,onHorizontalResize:function(){var e=$(window).width()-476;542>e?e=542:e>750&&(e=750),t.add(".b-shops-carousel .b-carousel__item").width(e),$(".b-carousel__items-border-wrapper").width(e-2),YaMoney.carousel.reflowDOM()},scrollSupport:!1,discretScrollingByButtons:!0},oneStepAnimationTime:5},e);YaMoney.carousel.init(n)},YaMoney.block["b-showcase-carousel"]=function(e){var t=this;YaMoney.carousel=YaMoney.carousel||new YaMoney.Carousel;var n=$("#item-full-view").length>0,i=$.extend({elements:{mainContainer:t.attr("id"),leftButton:"carousel-left",rightButton:"carousel-right",itemsContainer:"items-container",itemsContainerInner:"items-container-inner",fullViewContainer:"item-full-view",fullViewOpener:"b-carousel__full-view-opener"},settings:{speed:0,itemsToShow:1,scrollCount:1,activeButtonClassName:"b-carousel__button_enable",endless:!0,arrowsSupport:!0,scrollSupport:!1,discretScrollingByButtons:!0,isFullViewAllowed:n,fullView:{nextButtonClassName:"b-carousel__full-view-button b-carousel__full-view-button-next",prevButtonClassName:"b-carousel__full-view-button b-carousel__full-view-button-prev",imageDivClassName:"b-carousel__full-view-image",containerOpenClassName:"b-carousel__full-view-opened",closerClassName:"b-carousel__full-view-button b-carousel__full-view-button-close",videoImageDivClassName:"b-carousel__full-view-video",spinnerClassName:"b-carousel__full-view-spinner"}},oneStepAnimationTime:5},e);YaMoney.carousel.init(i)},YaMoney.block["b-carousel-780"]=function(e){var t=this;YaMoney.carousel=YaMoney.carousel||new YaMoney.Carousel;var n=$.extend({elements:{mainContainer:t.attr("id"),leftButton:"carousel-left",rightButton:"carousel-right",itemsContainer:"items-container",itemsContainerInner:"items-container-inner"},settings:{speed:0,itemsToShow:1,scrollCount:1,activeButtonClassName:"b-carousel__button_enable",endless:!0,arrowsSupport:!0,scrollSupport:!1,discretScrollingByButtons:!0,clickToScroll:!0},oneStepAnimationTime:5},e);YaMoney.carousel.init(n)},YaMoney.block["b-carousel-tiles"]=function(e){var t=this;YaMoney.carousel=YaMoney.carousel||new YaMoney.Carousel;var n=$("#items-container-inner",t).find("li").length,i=$.extend({elements:{mainContainer:t.attr("id"),leftButton:"carousel-left",rightButton:"carousel-right",itemsContainer:"items-container",itemsContainerInner:"items-container-inner",scrollBarContainer:"scroll-container",scrollBarBar:"scroll-bar"},settings:{speed:0,itemsToShow:Math.min(7,n),scrollCount:1,activeButtonClassName:"b-carousel__button_enable",buttonPressedClassName:{right:"b-carousel__button_pressed",left:"b-carousel__button_pressed"},endless:!1,scrollSupport:!1,arrowsSupport:!0}},e);YaMoney.carousel.init(i)},YaMoney.block["b-count"]=function(e){var t=this,n=$.extend({direction:"down",start_from:1e3*$.trim(t.text())||1e4,finish_on:0,step:1e3,redirect_url:null,callback:null},e),i=n.start_from;n.redirect_url&&(n.callback=function(){console.log("redirect to "+n.redirect_url),window.location.href=n.redirect_url});var o=function(e){var t=e%10,i=e%100,o=n.nd_many;return 1==t&&11!=i?o=n.nd_one:t>1&&5>t&&(10>i||i>20)&&(o=n.nd_some),e+" "+o},a=setInterval(function(){if(i==n.finish_on)return clearInterval(a),"function"==typeof n.callback&&n.callback(),!1;switch(n.direction){case"down":i-=n.step;break;case"up":i+=n.step}t.text(o(i/1e3))},n.step)},YaMoney.block["b-debts-reminder"]=function(){var e,t=this,n=$(".b-debts-reminder__link .b-link"),i=$(".b-debts-reminder__settings-controls"),o=$(".b-debts-reminder__form-subscribe"),a=$(".b-debts-reminder__form-confirm"),s=$(".b-debts-reminder__subscribe-ok-email"),r=$(".b-debts-reminder__subscribe-ok-all"),l=$(".b-debts-reminder__limit-exceeded"),c=o.find("input[name=driverLicense]"),d=c.getBlockByElem("b-form-input"),m=o.find("input[name=registrationCertificate]"),u=m.getBlockByElem("b-form-input"),h=o.find("input[name=subscribeType]:radio"),p=i.find("input[name=email]"),f=p.getBlockByElem("b-form-input"),g=i.find("input[name=phone]"),b=g.getBlockByElem("b-form-input"),y=g.closest("tr"),v=a.find("input[name=sms_code]"),w=v.getBlockByElem("b-form-input"),k=a.find(".b-debts-reminder__resend-SMS"),C=t.data("haswallet"),M=o.attr("action"),x=t.data("scid");if(n.on("click",function(){i.toggle()}),C){var S=function(e){var t=new Formatter(e.get(0),{pattern:"{{99}} {{ZZ}} {{999999}}",persistent:!1});
return t.resetPattern(),e.on("change",function(){t.resetPattern()}),t};Formatter.addInptType("Z",/[0-9АВСЕНКМОРТХУавсенкмортхуABCEHKMOPTXYabcehkmoptxy]/),Formatter.isBrowserCompatible()&&o.hasClass("has-mask")&&(Formatter.addInptType("Z",/[0-9АВСЕНКМОРТХУавсенкмортхуABCEHKMOPTXYabcehkmoptxy]/),S(c),S(m))}var B=function(e){return e=e||"",!!e.match(/^(\+7|8)(\(\d{3}\)|\d{3})\d{7}$/)},Y=function(e){var t=/^\d{2}\s?([А-Яа-я]{2}|\d{2})\s?\d{6}$/,n="ETYOPAHKXCBM",i="ЕТУОРАНКХСВМ",o=e.val().replace(/^\s+|\s+$/g,"").toUpperCase();return $.each(o.split(""),function(){var e=n.indexOf(this);e>-1&&(o=o.replace(this,i[e]))}),e.val(o),t.test(o)},T=function(e,n){return $.bFormError("show-by-html",{useSimpleTip:!0,bemTarget:e,html:t.data("error-"+n),position:"right",offsetLeftElement:i}),!1},E=function(){var e=h.filter(":checked");return e.length?e.val():"all"},I=function(){y.toggle("all"===E())};h.on("change",I);var A=function(){return g.length?b.val().trim():""},N=function(){var e=!0,t=d.val().replace(/\s/g,""),n=u.val().replace(/\s/g,""),i=f.val().trim(),o=A();return t||n?t&&10!==t.length?e=T(d,"driver-license-short"):t&&!Y(d)?e=T(d,"driver-license-error"):n&&10!==n.length?e=T(u,"registration-certificate-short"):n&&!Y(u)?e=T(u,"registration-certificate-error"):i?i&&!ym.textUtils.checkEmail(i)?e=T(f,"error-email"):C||!o||B(o)||(e=T(b,"error-phone")):e=T(f,"empty-email"):e=T(d,"driver-license-error"),e},F=function(){var e=f.val().trim(),t=A(),n="SP_";switch(x){case 23215:n+="EPSH_";break;case 5925:n+="GIBDDRU_";break;default:n+="MONEY_"}n+=C?"INFORM_USER_":"INFORM_LIGHT_",t&&"all"===E()?($(".b-debts-reminder__text-email",r).text(e),$(".b-debts-reminder__text-phone",r).text(t),r.show(),n+="ALL"):($(".b-debts-reminder__text-email",s).text(e),$(".b-debts-reminder__text-phone",s).text(t),s.show(),n+="EMAIL"),$.ymReachCounterGoal(n)};o.on("submit",function(){var t=d.val().replace(/\s/g,""),n=u.val().replace(/\s/g,""),i=f.val().trim(),s=A();return N()&&$.post(M,{action:"doSubscribe",userEmail:i,userPhone:s,driverLicense:t,registrationCertificate:n,subscribeType:E()},function(t){"OK"===t.status&&(o.hide(),"number_of_subscribed_documents_exceeded"===t.substatus?l.show():t.contextId?(e=t.contextId,$(".b-debts-reminder__text-email",a).text(i),$(".b-debts-reminder__text-phone",a).text(s),a.show()):F())}),!1}),a.on("submit",function(){var t=w.val().replace(/\s/g,"");return t?$.post(M,{action:"checkSMS",contextId:e,code:t,userEmail:f.val().replace(/\s/g,""),userPhone:b.val().replace(/\s/g,"")},function(e){"OK"===e.status?(a.hide(),F()):T(w,"error-code")}):T(w,"empty-code"),!1}),k.on("click",function(){return $.simpleTip.get("visible").hide(),w.delMod("error").val(""),$.post(M,{action:"resendSMS",userEmail:f.val().replace(/\s/g,""),userPhone:b.val().replace(/\s/g,"")},function(t){_.isUndefined(t.errors)?(e=t.contextId,k.trigger("showSMSisSendedText"),setTimeout(function(){k.trigger("hideSMSisSendedText")},3e3)):_.isUndefined(t.errors.sendConfirmationCodeLimitExceed)||T(w,"phone-limit-exceed")}),!1}).simpleTip({position:"right",html:"<span>"+k.data("success")+"</span>",theme:"green",show:{event:"showSMSisSendedText",fade:200},hide:{event:"hideSMSisSendedText",fade:200}}),$(document).ready(function(){C&&I()})},$(document).ready(function(){var e=$('td[data-block-js="b-descr-and-confirm"]');e.length&&YaMoney.block["b-descr-and-confirm"].call(e)}),YaMoney.block["b-descr-and-confirm"]=function(){var e=$('form[name="checkpay"]');$("#hint-pin-block").simple_tip({position:"bottom",arrow:!1,align:"left",focus:0,indent:5,html:"#hint-pin-descr","box-width":"340",show:{target:$("#hint-pin"),event:"click"},hide:{event:"unfocus"}}),$("a.contract-details-link").click(function(){n()}),$("#hint-sms").simple_tip({position:"bottom",arrow:!1,align:"left",focus:0,indent:5,html:"#hint-sms-descr",show:{event:"click"},hide:{event:"unfocus"}}),$("#hint-token").simple_tip({position:"bottom",arrow:!1,align:"left",focus:0,indent:5,html:"#hint-newtoken-descr",show:{event:"click"},hide:{event:"unfocus"}}),$("#hint-totp").simple_tip({position:"bottom",arrow:!1,align:"left",focus:0,indent:5,html:"#hint-newtotp-descr",show:{event:"click"},hide:{event:"unfocus"}}),$("#hint-grid").simple_tip({position:"bottom",arrow:!1,align:"left",focus:0,indent:5,html:"#hint-grid-descr",show:{event:"click"},hide:{event:"unfocus"}});var t=function(){$(document.forms.checkpay.elements).filter(function(){var e=$(this);return(e.is(":text")||e.is(":password"))&&e.is(":visible:enabled")}).eq(0).focus()},n=function(){var e=document.getElementById("contract"),n=$(e),i=n.data("counter-clicked");"none"==e.style.display?(i||(Lego.cp(41,72539),n.data("counter-clicked","1")),e.style.display="block"):e.style.display="none",$.simple_tip.update(),t()},i=function(){var e=!1,t=!1,n=$(this);YaMoney.paymentChallenge=YaMoney.paymentChallenge||YaMoney.paymentCaptcha||{check:function(){return!0}},$("input[type=text]:visible , input[type=password]:visible, select:visible",n).each(function(){var t=$(this);""==t.val()&&(t.elementModifier({blockName:"b-form-input",mode:"set",modName:"error",modValue:"yes",className:"error",callback:function(){t.data("hasError",!0)}}),e=!0)}),$("input:visible",n).filter(function(){return $(this).data("hasError")}).eq(0).focus(),t=YaMoney.paymentChallenge.check.call()&&!e;var i=$(":submit",n);return t&&i&&(i.parents(".b-form-button").bem("b-form-button").setMod("disabled","yes"),$(".challenge-submit-loader").show(),setTimeout(function(){$(":submit",n).parents(".b-form-button").bem("b-form-button").setMod("disabled","no")},1e3)),t};e.bind("submit",i),$(".b-descr-and-confirm__personification-hint-trigger-icon").simple_tip({html:".b-descr-and-confirm__personification-hint-text",align:"center",arrow:!0,position:"bottom","box-width":300,show:{event:"click"},hide:{event:"unfocus"},onshowbefore:function(){$.simple_tip.get("visible").hide()}})},YaMoney.block["b-favorites-editor-controls"]=function(){var e=$("div.b-favorites-editor-controls"),t=e.find("div.b-favorites-editor-controls__btns");$(window).scroll(function(){var n=$(window).scrollTop()-Math.floor(e.offset().top);n=n>0?n:0,t.stop().animate({top:n+"px"},"fast")})},YaMoney.block["b-favourites-instruction"]=function(){var e=$(this),t=e.find(".b-favourites-instruction__indicate");t.click(function(){var e=$($(this).attr("href"));return $(this).ymIndicate(e),!1})},YaMoney.block["b-flash-message"]=function(){function e(e){"undefined"==typeof c?c="1":"1"==c&&(c="2"),t(l,c,365),$(e).parents(".b-flash-message").hide()}function t(e,t,n){var i=new Date;i.setDate(i.getDate()+n);var o=escape(t)+(null==n?"":"; expires="+i.toUTCString());document.cookie=e+"="+o}function n(e){var t,n,i,o=document.cookie.split(";");for(t=0;t<o.length;t++)if(n=o[t].substr(0,o[t].indexOf("=")),i=o[t].substr(o[t].indexOf("=")+1),n=n.replace(/^\s+|\s+$/g,""),n==e)return unescape(i)}var i=$(this),o=i.data("message-id"),a=i.find("a"),s=i.find(".b-flash-message__close-again"),r=i.find(".b-flash-message__close"),l="yamoney_fmc_"+o,c=n(l),d=i.data("no-close")||!1;"undefined"==typeof c?i.removeClass("JSnoB"):"1"!=c||i.hasClass("lure-block")&&!i.hasClass("b-flash-message_credit")&&!i.hasClass("b-flash-message_newb")||(i.removeClass("JSnoB"),s.show(),r.hide());var m=$(".b-favorites__lanterns").height(),u=$(".b-favorites__controls-wrapper").height(),h=-24>u-3-m?-24:u-3-m;"1"==$(".b-favorites__lanterns").data("apply-top-margin")&&0>h&&i.css("margin-top",h+"px"),d||a.on("click",function(){return e(this),!0})},$(function(){$(".b-form-button_need-auth_yes").click(function(e){function t(){r.val(l),a.__self._getRetpath=s,o._popup.un("hide",t)}e.preventDefault();var n=$(this),i=n.attr("href"),o=$(".b-page").bem("b-page").findBlockInside("user")._domik;o.open();var a=o.getFormBlock(),s=a.__self._getRetpath,r=a.elem("retpath"),l=r.val();r.val(i),a.__self._getRetpath=function(){return i},o._popup.on("hide",t)})}),function(){function e(e){var t=e.domElem;t.nextAll("."+a.dummyErrorClass).first().hide(),t.simple_tip("get").hide(),e.delMod("error")}function t(e,t,n){e.simple_tip("get").length||e.simple_tip({"offset-left":n.offsetLeftElement,position:n.position||"right",html:t,theme:"red","update-content":!0,show:{event:a.simpleTipShowEvent},hide:{event:n.hideErrorEvent}}),e.simple_tip("get")[0].setHtml(t),e.simple_tip("get").show()}function n(e,t,n){var i=e.nextAll("."+a.dummyErrorClass).first();i.size()||(i=$("<div/>").addClass(a.dummyErrorClass).addClass(a.dummyErrorClass+"_code_"+n.code).append($("<span/>").addClass(a.dummyErrorTextClass)),e.after(i)),i.find("."+a.dummyErrorTextClass).html(t),i.show()}function i(i,o){var s=i.find(".b-form-error__text").html(),r=o.bemTarget.domElem;o=o||{},o=jQuery.extend(o,{useSimpleTip:i.data("use-simple-tip"),hideErrorEvent:o.hideErrorEvent||a.hideErrorEvent}),"blur"===o.hideErrorEvent&&o.bemTarget.on("blur",function(){e(o.bemTarget)}),o.tmplParams&&(s=ym.i18n.applyTmpl(s,o.tmplParams)),o.useSimpleTip?t(r,s,o):n(r,s,o),o.bemTarget.setMod("error","yes")}function o(e,t){return"function"==typeof s[e]&&s[e].call(this,t),this}var a={dummyErrorClass:"b-form-error__dummy",dummyErrorTextClass:"b-form-error__dummy-text",hideErrorEvent:"blur",simpleTipShowEvent:"bFormErrorShow"},s={"toggle-by-code":function(e){var t=e.code?"show-by-code":"hide";s[t].call(this,e)},"show-by-code":function(e){var t=$(".b-form-error_code_"+e.code).not(".b-form-error_non-js-only");t.size()&&i(t,e)},"show-by-html":function(e){var t;e.html&&(t=$("<div/>").append($("<span/>").addClass("b-form-error__text").html(e.html)),i(t,e))},hide:function(t){e(t.bemTarget)}};$.fn.bFormError=o,$.bFormError=o}(),YaMoney.block["b-gibdd-reminder"]=function(){var e=$(this),t=e.find(".b-gibdd-reminder_tunes__delete"),n=$(".b-gibdd-reminder_tunes_fio"),i=$(".b-gibdd-reminder_tunes_non_fio");t.on("click",function(e){e.stopPropagation(),e.preventDefault(),o(this)});var o=function(e){var t=$(e);$.post("/ajax/unsubscribe-auth-debts",{subscriptionId:t.data("subscriptionid"),synonyms:t.data("synonym"),action:"doRegisteredUnsubscribe"},function(e){if("unsubscribed"===e.subscriptionStatus){a("DEBTS_INFORM_USER_DEL");var n=$('tr[data-synonym="'+t.data("synonym")+'"]');n.remove(),0===$('#gibdd-reminder tr[data-type="subscribedDocuments"]').length&&$("#gibdd-reminder").hide()}})},a=function(e){$.ym_reachCounterGoal({counter:"yaCounter152220",id:152220,targetName:e})};e.data("handlers",{deleteReminder:o});var s=function(e,t){var n=e.data("doc-type"),i=e.data("doc-value"),o={action:"doSubscribe",payerName:t,subscribeType:"all"};o[n]=i,$.post("/ajax/subscribe-debts",o)},r=function(e){var t=$(this),n=t.data("original-name"),i=t.siblings(".b-form-input").getBlockByElem("b-form-input"),o=t.siblings(".b-form-button").getBlockByElem("b-form-button"),a=t.closest(".b-settings-widget__serviceName"),l=t.closest(".b-settings-widget__serviceName").find(".b-gibdd-reminder_tunes_edit_fio_holder");if(e&&e.preventDefault(),e&&e.data.show){$(".b-gibdd-reminder_tunes_fio_edit").each(function(){r.call(this)}),$(document).on("click.cancelEditSubscriptionFio",function(e){0===i.domElem.has(e.target).length&&r.call(t)});var c=BEM.HTML.build({block:"b-form-input",name:"reminder-fio",mods:{size:"m",theme:"grey",autocomplete:"no"},value:t.text()});t.hide(),i=BEM.DOM.init(l.append(c)).find("input").focus().getBlockByElem("b-form-input");var d=BEM.HTML.build({block:"b-form-button",name:"save-fio",mods:{theme:"grey-m",size:"m"},content:"Сохранить"});o=BEM.DOM.init(l.append(d)).getBlockByElem("b-form-button"),i.elem("input").prop("maxlength","200"),t.addClass("b-gibdd-reminder_tunes_fio_edit");var m=function(e){var i=$.trim(e.val());i.length?(t.find(".b-link__text").text(i),t.data("original-name",i),s(t,i)):n?t.find(".b-link__text").text(n):(a.find(".b-gibdd-reminder_tunes_edit_fio").hide(),a.find(".b-gibdd-reminder_tunes_non_fio").show()),a.find(".b-form-input").remove(),a.find(".b-form-button").remove(),t.show(),t.removeClass("b-gibdd-reminder_tunes_fio_edit"),$(document).off(".cancelEditSubscriptionFio")};a.find(".b-form-button__click").on("click",function(){return m(i),!1}),i.bindTo("keydown",function(e){13===e.keyCode&&(e.preventDefault(),m(this))}).bindTo("keypress",function(e){var t=/[А-яЁё \-]/,n=/[^А-яЁё \-]/g,i=e.key||String.fromCharCode(e.keyCode)||"";return i&&1===i.length&&!t.test(i)?(this.val(this.val().replace(n,"")),!1):void 0})}else l.html(""),n||(a.find(".b-gibdd-reminder_tunes_edit_fio").hide(),a.find(".b-gibdd-reminder_tunes_non_fio").show()),t.find(".b-link__text").text(n),t.show().removeClass("b-gibdd-reminder_tunes_fio_edit"),$(document).off(".cancelEditSubscriptionFio");return!1};n.hover(function(){var e=$(this);e.addClass("b-gibdd-reminder_tunes_fio__hover").on("click.editName",{show:!0},r)},function(){var e=$(this);e.removeClass("b-gibdd-reminder_tunes_fio__hover").off(".editName")}),i.on("click",function(){var e=$(this),t=e.closest(".b-settings-widget__serviceName");return t.find(".b-gibdd-reminder_tunes_edit_fio").show(),e.hide(),t.find(".b-gibdd-reminder_tunes_fio").addClass("b-gibdd-reminder_tunes_fio__hover").on("click.editName",{show:!0},r).click(),!1})},YaMoney.block["b-help-icon"]=function(){var e=this,t=e.find(".b-help-icon__text");e.simple_tip({position:"bottom",align:"left",html:t,indent:0,focus:6,"box-width":{max:300},show:{event:"click"},hide:{event:"unfocus"}})},YaMoney.block["b-hint"]=function(){var e=$(this),t=e.find(".b-hint__link"),n=e.find(".b-popupa").getBlockByElem("b-popupa");t.on("click",function(){n.show(t)})},FieldIndicator=function(e,t){return function(n,i){var o=e.extend({bindDefaultEvent:!0,blockPrefix:"b-indicator-progress"},i);this.blockPrefix=o.blockPrefix,this.element=n,this.elStatus=n.find("."+this.getBlockName("__status__inner")),this.elHint=n.find("."+this.getBlockName("__message")),o.bindDefaultEvent&&(this.on("init",this.init),this.on("change",this.change),this.on("status",this.status)),this.on("init",function(){this.removeMod("nojs")}),this.emit("init"),o.progress!==t&&this.emit("change",o.progress),o.status!==t&&this.emit("status",o.status)}}(jQuery),FieldIndicator.prototype.getEventName=function(e){return"event.fieldIndicator."+e},FieldIndicator.prototype.getBlockName=function(e){return this.blockPrefix+e},FieldIndicator.prototype.setMod=function(e){return this.element.addClass(this.getBlockName("_mod_"+e)),this},FieldIndicator.prototype.removeMod=function(e){return this.element.removeClass(this.getBlockName("_mod_"+e)),this},FieldIndicator.prototype.getTextHint=function(){return this.elHint.html()},FieldIndicator.prototype.setTextHint=function(e){return this.elHint.html(e),this},FieldIndicator.prototype.emit=function(e){return e=this.getEventName(e),$(this).trigger(e,$(arguments).toArray().slice(1)),this},FieldIndicator.prototype.on=function(e,t){return $(this).on(this.getEventName(e),function(){t.apply(this,$(arguments).toArray().slice(1))}),this},FieldIndicator.prototype.status=function(e){var t=this.getBlockName("_status_"),n=this.getBlockName("_animate-status_"),i=this.element.prop("class").split(/\s+/),o=t+e,a=[],s=null;if(!this.element.hasClass(o)){for(var r=0,l=i.length;l>r;r++){var c=i[r];c!==o&&0===c.indexOf(t)?(a[a.length]=c,s=c):0===c.indexOf(n)&&(a[a.length]=c)}this.element.removeClass(a.join(" ")),"string"==typeof s&&(o=n+s.substring(t.length)+" "+o),this.element.addClass(o)}return this},FieldIndicator.prototype.change=function(e){return this.elStatus.css("width",e+"%"),this},FieldIndicator.prototype.init=function(){var e=this.elStatus.data("preload-status-list");if("undefined"!=typeof e){"string"==typeof e&&(e=e.split(","));for(var t=0,n=e.length;n>t;t++)(new Image).src="/i/findicator_"+e[t]+"_bg.gif"}},function(e,t){e.fn.fieldIndicator=function(e){for(var n=0,i=this.length;i>n;n++){var o="b-indicator-progress-ref",a=this.data(o);a===t&&(a=new FieldIndicator(this.eq(n),e),this.data(o,a))}return a}}(jQuery),YaMoney.block["b-island-modal"]=function(e){function t(){function e(){$("body").addClass(r),i.data&&s.html(i.data),ym.isFunction(i.openStart)&&i.openStart(),i.title&&a.prependTo(s).html(i.title)}function t(){ym.isFunction(i.openFinish)&&i.openFinish()}$.each(arguments,function(e,t){switch(t.constructor){case Object:i=$.extend(i,t);break;case Function:i.openFinish=t;break;default:i.data=t}}),o.is(":visible")?s.fadeOut(e).fadeIn(t):(e(),o.fadeIn(t)),$(document).trigger("modalOpen")}function n(e){i=$.extend(i,e),ym.isFunction(i.closeStart)&&i.closeStart(),o.fadeOut(function(){$("body").removeClass(r),ym.isFunction(i.closeFinish)&&i.closeFinish()})}var i=$.extend({openStart:null,openFinish:null,title:null,closeLink:!1,closeOnOuterClick:!0,data:null},e),o=$($(".b-island-modal-tmpl").first().html()),a=$('<div class="b-island-modal__title"></div>'),s=o.find(".b-island-modal__data"),r="b-island-modal__page";return $("body").append(o),i.data&&s.html(i.data),o.on("click",function(e){var t=$(e.target);i.closeOnOuterClick&&(t.hasClass("b-island-modal__outer")||t.hasClass("b-island-modal__inner"))&&n()}),o.on("click",".b-island-modal__close-link",function(){return n(),!1}),$(".b-island-modal").bind("close",n),{show:t,close:n}},YaMoney.block["b-modal"]=function(e){function t(){function e(){$("body").addClass(l),n.data&&s.html(n.data),"function"==typeof n.openStart&&n.openStart(),n.title&&a.prependTo(s).html(n.title),n.closeLink&&$modal_close.appendTo(s)}function t(){"function"==typeof n.openFinish&&n.openFinish()}var n={openStart:null,openFinish:null,title:null,closeLink:!1,data:null};$.each(arguments,function(e,t){switch(t.constructor){case Object:n=$.extend(n,t);break;case Function:n.openFinish=t;break;default:n.data=t}}),o.is(":visible")?s.fadeOut(e).fadeIn(t):(e(),o.fadeIn(t)),$(document).trigger("modalOpen")}function n(e){var t=$.extend({closeStart:null,closeFinish:null},e);"function"==typeof t.closeStart&&t.closeStart(),o.fadeOut(function(){$("body").removeClass(l),"function"==typeof t.closeFinish&&t.closeFinish()})}var i=$.extend({data:null},e),o=$('<div class="b-modal"><div class="b-modal__outer"><div class="b-modal__inner"><div class="b-modal__data"></div></div></div></div>'),a=$('<div class="b-modal__title"></div>'),s=o.find(".b-modal__data"),r={},l="b-modal__page";return $("body").append(o),i.data&&s.html(i.data),o.on("click",function(e){("b-modal__outer"==$(e.target).attr("class")||"b-modal__inner"==$(e.target).attr("class"))&&n()}),o.on("click",".b-modal__close-link",function(){return n(),!1}),{show:t,close:n,cache:r}},YaMoney.block["b-page-cps"]=function(){var e=$(this).find(".b-page-cps__title-alt-methods-link"),t=$(this).find(".b-page-cps__content"),n=t.find(".b-page-cps__form"),i=n.find(".b-page-cps__simple-tip"),o=n.find(".b-page-cps__validate-control-row"),a=n.find(".b-page-cps__card-controls.b-page-cps__card-controls-required"),s=n.find(".b-page-cps__skr_sum-control-row, .b-page-cps__sum-control-row").filter(":first"),r=n.find(".b-page-cps__receiver-control-row"),l=$("#senderAccount");$receiverBFormInput=r.find(".b-form-input"),receiverBemInput=$receiverBFormInput.getBlockByElem("b-form-input"),$receiverWrap=r.find(".b-page-cps__input-control"),$avatar=r.find(".b-page-cps__receiverAvatar"),$bigAvatar=r.find(".b-page-cps__receiverBigAvatar"),$receiverTypeRadio=n.find(".b-page-cps__radio-receiver-type"),receiverTypeBemRadio=$receiverTypeRadio.getBlockByElem("b-form-radio"),$toggleFields=n.find(".b-page-cps__input-receiver, .b-page-cps__input-userComment"),$toggleRows=n.find(".b-page-cps__receiver-control-row, .b-page-cps__userComment-control-row"),$sbPayMethodSwitcher=$(".b-page-cps__radio-payMethod"),$sbPayMethodBemSwitcher=$sbPayMethodSwitcher.getBlockByElem("b-form-radio"),personalizeSecondDocRadio=n.find(".b-page-cps__radio-second-document-type"),personalizeSecondDocBemRadio=personalizeSecondDocRadio.getBlockByElem("b-form-radio"),personalizeToggleFields=n.find(".b-page-cps__input-pdr_inn, .b-page-cps__input-pdr_snils, .b-page-cps__input-pdr_oms"),personalizeToggleRows=n.find(".b-page-cps__pdr_inn-control-row, .b-page-cps__pdr_snils-control-row, .b-page-cps__pdr_oms-control-row"),emailRow=n.find(".b-page-cps__email-control-row"),noemailRow=n.find(".b-page-cps__noemail-control-row"),emailBFormInput=emailRow.find(".b-form-input"),submitBFormButton=n.find(".b-page-cps__submit-control-row").find(".b-form-button"),submitBemButton=submitBFormButton.getBlockByElem("b-form-button"),offerShowLink=n.find(".b-page-cps__offer-hint a:not([target])"),offerTextBlock=n.find(".b-page-cps__offer-checkbox__label"),offerBCheckbox=n.find(".b-page-cps__offer-checkbox").find(".b-form-checkbox").getBlockByElem("b-form-checkbox"),disableEmailLink=n.find(".b-page-cps__disable-email"),enableEmailLink=n.find(".b-page-cps__enable-email"),validatorUrl="/ajax/validate",fieldsValid={card:!0,skr_sum:!0,sum:!0,receiver:!0,pdr_lastName:!0,pdr_firstName:!0,pdr_middleName:!0,pdr_docNumber:!0,pdr_docIssueDay:!0,pdr_docIssueYear:!0,pdr_inn:!0,pdr_snils:!0,pdr_oms:!0},curDate=new Date,maskedCardNumberRow=$(".b-page-cps__masked-cardnumber-control-row");var c=$("#cardNumber"),d=$("#month"),m=$("#year"),u=$("#fio"),h=$("#cardCvc"),p=$("#sms"),f=c.closest(".b-form-input"),g=d.closest(".b-page-cps__carddate-control"),b=(u.closest(".b-form-input"),h.closest(".b-form-input"));smsBFormInput=p.closest(".b-form-input");var y=($(".b-page-cps__field__pdr_no_second_document a"),$(".b-page-cps__reg-block")),_=y.find(".reg-after-epr"),v=function(){var e=n.find("#rebillingOn");e.length&&(e.attr("checked")?e.val("true"):e.removeAttr("name"))},w=function(){var e=$(this).closest(".b-form-input");e.length&&e.trigger("cpsAlertHide")},k=function(e,t){t=t||!1;var n=$(this).closest(".b-form-input");if(n.length){n.trigger("cpsAlertHide");var i=n.hasClass("b-page-cps__validate-allow-empty"),o=$(this).val(),a=$(this).attr("id"),s=n.getBlockByElem("b-form-input").getMod("disabled"),r="submit"==e.type?"cpsAlertShow":"cpsAlertHide",l=$("#"+a+"-invalid-text").html(),c="";if(s)return fieldsValid[a]=!0,void M(n,!0,"cpsAlertHide",l);if(!$.trim(o))return c=$("#"+a+"-empty-text").html()||l,fieldsValid[a]=i,r=i?"cpsAlertHide":r,void M(n,i,r,c);fieldsValid[a]=!1,M(n,!1,"cpsAlertHide",l);var d="validateCpsField_"+a;if("function"==typeof window[d]){{window[d](o)}fieldsValid[a]=window[d](o),r=fieldsValid[a]?"cpsAlertHide":r,M(n,fieldsValid[a],r,l)}else{$.ajax({async:!1,dataType:"json",url:validatorUrl,data:{objType:a,value:o},success:function(e){fieldsValid[a]=e.hasOwnProperty("is-valid")&&"true"==e["is-valid"],r=fieldsValid[a]?"cpsAlertHide":r,M(n,fieldsValid[a],r,l)}})}}},C=function(e,t){if(c.length){t="undefined"==typeof t?!0:t;var n,i,o,a=!0,s=$(this).attr("id"),r=$("#cps-default").html(),l="submit"==e.type?"cpsAlertShow":"cpsAlertHide",u=$.trim(c.val().replace(/\s/g,""));n=!1,i=l,o=$("#cps-cardnumber-empty").html()||r,u?u.length<12?o=$("#cps-cardnumber-too-short").html():ym.textUtils.checkCardNumber(u)?n=!0:o=$("#cps-cardnumber-invalid").html():i=!t&&l,a=a&&n,"cardNumber"==s&&(i=n?"cpsAlertHide":i,M(f,n,i,o)),n=!1,i=l,o=$("#cps-date-empty").html()||r;var p=d.val(),y=m.val();2===y.length&&(y=curDate.getFullYear().toString().substring(0,2)+y),1===p.length&&(p="0"+p),p||y?!p&&y?o=$("#cps-month-empty").html():p&&!y?o=$("#cps-year-empty").html():ym.toNum(p,0)>12||ym.toNum(p,0)<1?o=$("#cps-date-invalid").html():ym.toNum(y,0)<curDate.getFullYear()?o=$("#cps-date-invalid").html():ym.toNum(y,0)===curDate.getFullYear()&&ym.toNum(p,0)<curDate.getMonth()+1?o=$("#cps-date-invalid").html():n=!0:i=!t&&l,a=a&&n,("month"==s||"year"==s)&&(i=n?"cpsAlertHide":i,M(g,n,i,o),"submit"===e.type&&(d.val(p),m.val(y))),n=!1,i=l,o=$("#cps-cvv-empty").html()||r,0===h.val().length&&c.val().replace(/\s/g,"").length<18?n=!1:h.val().length>0&&h.val().length<3?(o=$("#cps-cvv-invalid").html(),n=!1):n=!0,a=a&&n,"cardCvc"==s&&(i=n?"cpsAlertHide":i,M(b,n,i,o)),fieldsValid.card=a}},M=function(e,t,n,i,o){e=e||null,t="undefined"==typeof t?!0:t,n=n||"cpsAlertHide",i=i||"";var a={html:i};o&&(a.theme=o),e&&e.data("valid",t).data("message",i).trigger(n,a)},x=function(e){var t=ym.toNum(s.data("minval"),0),n=ym.toNum(s.data("maxval"),0),i=s.attr("data-minval").indexOf(".")>=0||s.attr("data-maxval").indexOf(".")>=0,o=s.find(".b-form-input"),a=o.find("input"),r=ym.normalizeSumInput(a.val(),i);"."===r&&i||!isNaN(1*r)||(r=""),"blur"===e.type&&(r=ym.toNum(r,0));var l="submit"===e.type?"cpsAlertShow":"cpsAlertHide",c=!1,d=l,m=$("#skr_sum-default").html(),u=a.attr("id");o.trigger("cpsAlertHide");var h=ym.toNum(r,0);h&&(h>=t&&n>=h?c=!0:h>n?m=$("#skr_sum-too-much").html():t>h&&(m=$("#skr_sum-too-small").html())),r+""!==a.val()&&a.val(r),fieldsValid[u]=c,d=c?"cpsAlertHide":d,M(o,c,d,m)},S=function(){$bigAvatar.css("margin-left",27-$bigAvatar.width()).css("margin-top",13-$bigAvatar.height()/2).fadeIn("slow")},B=function(e){var t=e.relatedTarget.className;"b-page-cps__receiverBigAvatar"!=t&&"b-page-cps__receiverAvatar"!=t&&$bigAvatar.fadeOut("fast")},Y=function(){$avatar.hide(),$receiverWrap.removeClass("found avatar")},T=function(){M($receiverBFormInput,!0,"cpsAlertHide"),Y()},E=function(e){e=e||{},$.extend({async:!0},e);var t=receiverBemInput.val(),n=$("#cps-default").html();t?$.ajax({url:"/internal/validate-receiver.xml",dataType:"json",async:e.async,data:{receiver:t},success:function(e){var t,n=e.status||"",i=e.message||"",o=e.messageType||"",a=e.accountInfo||{},s=(a.accountType||"",a.avatar||""),r=a.bigAvatar||"",l=(a.isYandexLogin||!1,"negative"!==o);fieldsValid.receiver=l;var c=i&&"neutral"!==o?"cpsAlertShow":"cpsAlertHide";switch(o){case"negative":t="red",M($receiverBFormInput,l,c,i,t);break;case"positive":t="green",M($receiverBFormInput,l,c,i,t);break;default:t="gray",M($receiverBFormInput,l,c,i,t)}"found"===n&&$receiverWrap.addClass("found"),s&&($receiverWrap.addClass("avatar"),$avatar.css("background","url("+s+") center no-repeat").show(),$bigAvatar.attr("src",r))}}):(fieldsValid.receiver=!1,M($receiverBFormInput,!1,"cpsAlertShow",n,"red"))},I=function(){var e=receiverTypeBemRadio.val(),t=$("#cps-default").html();"my"===e?(fieldsValid.receiver=!0,$receiverBFormInput.data("valid",!0),$toggleFields.each(function(){$(this).getBlockByElem("b-form-input").val("")}),Y()):(fieldsValid.receiver=!1,$receiverBFormInput.data("valid",!1).data("message",t)),A()},A=function(){$toggleFields.each(function(){$(this).simple_tip("get").hide(),$(this).getBlockByElem("b-form-input").toggleMod("disabled","yes")}),$toggleRows.toggle(),$.simple_tip.update()},N=function(){var e=!0;receiverTypeBemRadio.val()&&(fieldsValid.receiver="my"===receiverTypeBemRadio.val(),fieldsValid.receiver||E({async:!1})),o.find(".b-form-input").each(function(){$(this).find("input").trigger("validateImmediately",[!0])});for(var t in fieldsValid)if(fieldsValid.hasOwnProperty(t)&&fieldsValid[t]===!1){e=!1;break}return offerBCheckbox.domElem&&offerBCheckbox.domElem.length&&(""==offerBCheckbox.getMod("checked")?($(".b-page-cps__offer-checkbox").trigger("cpsAlertShow"),e=!1):$(".b-page-cps__offer-checkbox").trigger("cpsAlertHide")),e=P()&&e},F=function(){personalizeToggleFields.each(function(){$(this).simple_tip("get").hide(),$(this).getBlockByElem("b-form-input").setMod("disabled","yes")});var e=personalizeSecondDocBemRadio.val();switch(e){case"inn":fieldsValid.pdr_snils=!0,fieldsValid.pdr_inn=!1,fieldsValid.pdr_oms=!0;break;case"snils":fieldsValid.pdr_snils=!1,fieldsValid.pdr_inn=!0,fieldsValid.pdr_oms=!0;break;case"oms":fieldsValid.pdr_snils=!0,fieldsValid.pdr_inn=!0,fieldsValid.pdr_oms=!1}personalizeToggleFields.filter(".b-page-cps__input-pdr_"+e).getBlockByElem("b-form-input").delMod("disabled"),personalizeToggleRows.hide().filter(".b-page-cps__pdr_"+e+"-control-row").show(),$.simple_tip.update()},P=function(){var e=70,t=!0,i=new Date,o=fieldsValid.pdr_docIssueDay&&fieldsValid.pdr_docIssueYear,a=n.find(".b-page-cps__input-pdr_docIssueDay"),s=n.find(".b-page-cps__field__pdr_docIssueMonth"),r=n.find(".b-page-cps__input-pdr_docIssueYear");if(o&&a.length&&s.length&&r.length){var l=ym.toNum(r.find("input").val(),0),c=r.find("input").attr("id"),d=ym.toNum(a.find("input").val(),0),m=ym.toNum(s.find("select").val(),0),u="";if(l>i.getFullYear()||l<i.getFullYear()-e)t=!1,u=$("#"+c+"-invalid-text").html(),fieldsValid[c]=t,M(r,t,"cpsAlertHide",u);else{c=a.find("input").attr("id");var h=new Date(l,m,1,-1).getDate();(1>d||d>h)&&(t=!1,u=$("#"+c+"-invalid-text").html(),fieldsValid[c]=t,M(a,t,"cpsAlertHide",u))}if(t){var p=function(e){e=e||0;var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[e]},f=p(m-1)+" "+d+", "+l+" 23:59:59",g=Date.parse(f);g>i&&(t=!1,c=a.find("input").attr("id"),u=$("#"+c+"-invalid-text").html(),fieldsValid[c]=t,M(a,t,"cpsAlertHide",u))}}return t};$(document).ready(function(){if(y.length){var r=y.data("reachGoalClick");y.on("click",_,function(){$.ym_reachCounterGoal({targetName:r})})}c.length?(fieldsValid.card=!1,c.ym_cardNumberInput(),u.ym_keys(/[a-zA-Z.'\-\s]/i),h.ym_keys(/\d/),d.attr("type")&&d.ym_keys(/\d/),m.attr("type")&&m.ym_keys(/\d/),c.removeAttr("maxlength")):maskedCardNumberRow.length&&(p.ymKeys(/\d/),h.ymKeys(/\d/)),$sbPayMethodSwitcher.length&&($sbPayMethodBemSwitcher.on("change",function(){var e=$sbPayMethodBemSwitcher.val(),t=".b-page-cps__desc-provider-text div",n=t+"."+e;$(t).hide(),$(n).show()}),$sbPayMethodBemSwitcher.trigger("change")),$(".hint-cps-switcher").each(function(e,t){var n=$(t).data("switcher-value");$(".cps-field-tab-"+n).data("simple-tip",{"offset-left":$(".b-form-pane__content"),position:"right",html:"#hint-cps-switcher-"+n,show:{event:"mouseover",target:$(".cps-field-tab-"+n)},hide:{event:"mouseout",target:$(".cps-field-tab-"+n)}}).simple_tip()});var f=$("#bPage3dsecform");f.length&&(f.submit(function(){"undefined"!=typeof YaMetrikaUserEventGoal_submit&&$.isFunction(YaMetrikaUserEventGoal_submit)&&YaMetrikaUserEventGoal_submit()}),setTimeout(function(){"undefined"!=typeof YaMetrikaUserEventGoal_submit&&$.isFunction(YaMetrikaUserEventGoal_submit)&&YaMetrikaUserEventGoal_submit(),document.getElementById("bPage3dsecform").submit()},5e3));var g=$(".b-page-cps__invoicepay-form");if(g.length){g.submit(function(){"undefined"!=typeof YaMetrikaUserEventGoal_submit&&$.isFunction(YaMetrikaUserEventGoal_submit)&&YaMetrikaUserEventGoal_submit()});var b=1e3*ym.toNum(g.attr("data-submit-timeout"),0);b>0&&setTimeout(function(){g.submit()},b)}n.submit(function(e){if("undefined"!=typeof YaMetrikaUserEventGoal_presubmit&&$.isFunction(YaMetrikaUserEventGoal_presubmit)&&YaMetrikaUserEventGoal_presubmit(),submitBemButton.setMod("disabled","yes"),!N())return submitBemButton.delMod("disabled"),i.find(".b-form-input, .b-page-cps__carddate-control").not($(".b-page-cps__carddate-control").find(".b-form-input")).each(function(){if($(this).data("valid")===!1){var e=$(this).data("message");e?$(this).trigger("cpsAlertShow",{html:e}):$(this).trigger("cpsAlertShow")}else $(this).trigger("cpsAlertHide")}),e.preventDefault(),!1;if(submitBFormButton.trigger("cpsAlertHide"),c.length){var t=c.attr("name");c.removeAttr("name"),n.append('<input type="hidden" name="'+t+'" value="'+c.val().replace(/\s/g,"")+'">')}if(s.length){var o=1*s.data("comission"),a=s.find(".b-form-input").find("input"),r=a.attr("name"),d=1*a.val();o>0&&(d+=o,a.removeAttr("name"),n.append('<input type="hidden" name="'+r+'" value="'+d+'">'))}if($receiverTypeRadio.length){var m="any"===receiverTypeBemRadio.val()?receiverBemInput.val():l.val();return $.getJSON("/internal/deposit-from-card.xml",{receiver:m},function(e){var t=e.status||"",i=e.operationXml||"",o=e.signature||"";return"success"!==t?(submitBFormButton.trigger("cpsAlertShow",{html:$("#cps-submit-error").html()}),submitBemButton.delMod("disabled"),!1):($("#operationXml").val(i),$("#signature").val(o),v(),"undefined"!=typeof YaMetrikaUserEventGoal_submit&&$.isFunction(YaMetrikaUserEventGoal_submit)&&YaMetrikaUserEventGoal_submit(),void n.off("submit").submit())}),e.preventDefault(),!1}v(),"undefined"!=typeof YaMetrikaUserEventGoal_submit&&$.isFunction(YaMetrikaUserEventGoal_submit)&&YaMetrikaUserEventGoal_submit(),$(this).trigger("cps-ready-for-submit")
}),s.length&&(fieldsValid.skr_sum=!1,s.find(".b-form-input").find("input").on("validateImmediately",x).on("keyup blur click paste input propertychange",x).trigger("validateImmediately",[!0])),$receiverTypeRadio.length&&(fieldsValid.receiver="my"===receiverTypeBemRadio.val(),receiverBemInput.on("focus",T).on("blur",E),receiverBemInput.val()&&E(),$avatar.hover(S,B),$bigAvatar.mouseleave(B),receiverTypeBemRadio.on("change",I),"any"!==receiverTypeBemRadio.val()||$toggleRows.is(":visible")||A()),personalizeSecondDocRadio.length&&personalizeSecondDocBemRadio.on("change",F),"true"!==n.attr("data-disable-autofocus")&&n.find('input[type != "hidden"]:first').trigger("focus");var Y=i.find(".b-form-input, .b-page-cps__carddate-control, .b-page-cps__offer-checkbox").add(submitBFormButton).not($(".b-page-cps__carddate-control").find(".b-form-input"));if(Y.each(function(){var e="right",n=t,i=320,o="red",a=$(this).closest(".b-page-cps__simple-tip");if(a.length){var s=a.data();switch(e=s.simpleTipPosition?s.simpleTipPosition.toLowerCase():e,i=s.simpleTipMaxWidth?ym.toNum(s.simpleTipMaxWidth):i,o=s.simpleTipTheme?s.simpleTipTheme:o,s.simpleTipOffset.toLowerCase()){case"currentrow":n=a;break;case"currenttitlebox":n=a.find(".b-page-cps__input-title");break;case"currentcontrolbox":n=a.find(".b-page-cps__input-control");break;case"default":n=t;break;default:n=t}}$(this).data("simple-tip",{position:e,theme:o,align:"left","arrow-focus":!1,"box-width":{max:i},show:{event:"cpsAlertShow"},hide:{event:"cpsAlertHide"},"offset-left":n}).simple_tip()}),o.find(".b-form-input").each(function(){$(this).find("input").on("validateImmediately",k).on("keyup blur click paste input propertychange focus",w).trigger("validateImmediately",[!0])}),maskedCardNumberRow.length&&$(".epl-sms-wrapper").data("error")){var P="sms_code_expired"===$(".epl-sms-wrapper").data("error")?$("#new-sms-sended-text").html():$("#sms-invalid-text").html();M(smsBFormInput,!1,"cpsAlertShow",P)}a.find(".b-form-input, .b-page-cps__carddate-control").each(function(){$(this).find("input").on("keyup blur click paste input propertychange focus validateImmediately",C).trigger("validateImmediately"),$(this).find("select").on("change blur click focus keyup validateImmediately",C).trigger("validateImmediately")}),$(".b-page-cps__offer-checkbox").find("input:checkbox").bind("change click",function(){$(".b-page-cps__offer-checkbox").trigger("cpsAlertHide")}),disableEmailLink.click(function(){emailRow.addClass("b-page-cps__control-hidden"),noemailRow.removeClass("b-page-cps__control-hidden").find("input").removeAttr("disabled"),emailBFormInput.getBlockByElem("b-form-input").setMod("disabled","yes"),emailBFormInput.find("input").trigger("validateImmediately")}),enableEmailLink.click(function(){emailRow.removeClass("b-page-cps__control-hidden"),noemailRow.addClass("b-page-cps__control-hidden").find("input").attr("disabled","disabled"),emailBFormInput.getBlockByElem("b-form-input").delMod("disabled"),emailBFormInput.find("input").trigger("validateImmediately",[!0])}),e.click(function(){}),offerShowLink.click(function(){return offerTextBlock.toggle(),!1});var D=$(".b-page-cps__field__pdr_no_second_document a");D.length&&$(".b-page-cps__field__pdr_no_second_document a").click(function(e){e.preventDefault()}).simple_tip({position:"bottom",arrow:!0,align:"left",focus:0,indent:5,show:{event:"click"},hide:{event:"unfocus"}}).simple_tip("get")[0].setHtml($("#pdr_no_second_document-default").html()+' <span class="ym-simple-tip-close"/>');var O=$(".b-page-cps__default-payment");if(O.length){var R=O.find(".b-form-select"),U=R.getBlockByElem("b-form-select"),H=O.attr("data-portal-frame-base-url"),j=O.find(".b-page-cps__payment_iframe_container"),z=j.find(".b-page-cps__payment_iframe"),V=O.find(".b-page-cps__desc-row-portalSum"),G=O.find(".b-page-cps__payment_fields"),L=O.find(".b-page-cps__desc-row-sum, .b-page-cps__desc-row-comission, .b-page-cps__desc-row-contract-sum");z.load(function(){j.removeClass("b-page-cps__payment_iframe_container__wait"),z.show()}),U.on("change",function(){z.hide(),j.addClass("b-page-cps__payment_iframe_container__wait");var e=U.val();if("cps"===e)j.hide(),V.hide(),G.show(),L.show();else{G.hide(),L.hide(),Y.simple_tip("get").hide(),j.show(),V.show();var t=z.attr("data-current-method");if(t!==e){var n=H;"account"!==e&&(n+="&pay-source="+e),z.attr("src",n)}else j.removeClass("b-page-cps__payment_iframe_container__wait"),z.show();z.attr("data-current-method",e)}})}$("body").addClass("cps-page-inited").trigger("cps-page-inited")});var D=$(".b-page-cps__hint-by-icon");D.click(function(e){e.stopPropagation(),e.preventDefault()}),D.each(function(){var e=$(this),t=e.data("content-id"),n=e.data("max-width"),i={html:$("#"+t),position:e.data("position")||"right",align:e.data("align")||"left","box-width":{},"show-on-ready":e.data("show-on-ready")&&e.is(":visible"),focus:8,show:{event:e.data("show-event")||"click"},hide:{event:e.data("hide-event")||"unfocus"}};n&&(i["box-width"].max=n),e.simple_tip(i)}),n.on("change",".b-form-checkbox:visible",function(){var e=$(this),t=e.closest(".b-page-cps__input-control");t.find(".b-page-cps__checkbox-oncheck-wrap").slideToggle()})},YaMoney.block["b-payment-bonus"]=function(e){function t(e,t){$.getJSON(e,t,function(e){n(e.status&&"error"===e.status?"state_fail":"state_success")})}function n(e){a.trigger("delError");var t=["state_default","state_success","state_fail","state_letter"],n=_.without(t,e),i=n.join(", .");$("."+e).show(),$("."+i).hide()}var i=$(".b-payment-bonus__content"),o=$(".b-payment-bonus__email-field"),a=i.find('input[name="email-to"]'),s=$(".b-payment-bonus__user-data-form");i.on("click",".b-payment-bonus__default-email",function(){i.find(".b-form-input").bem("b-form-input").val($(this).text())}),i.on("click",".send-email",function(e){e.preventDefault(),e.stopPropagation(),i.find("form").trigger("submit")}),i.on("submit","form",function(n){n.preventDefault(),n.stopPropagation();var r=a.val(),l=ym.textUtils.checkEmail(r);l?(i.find("input").each(function(t,n){var i=$(n);e[i.attr("name")]=i.val()}),t(s.attr("action"),e)):(a.trigger("sendEmail"),o.addClass("b-form-input_error_yes"))}),i.on("click",".b-payment-bonus__back-link",function(){n("state_default")}),i.on("click","#b-payment-bonus__btn-to-me",function(){n("state_letter")}),i.on("focus blur",".b-payment-bonus__email-field",function(){a.trigger("delError")}),i.bind("delError",function(){o.removeClass("b-form-input_error_yes")}),a.simple_tip({position:"right",html:".errorTip",theme:"red",show:{event:"sendEmail"},hide:{event:"delError"}})},function(){function e(e,t,n){var i={};n.find("input").each(function(e,t){var n=$(t);i[n.attr("name")]=n.val()}),$.getJSON(e,i,function(e){var t=n.simple_tip("get")[0];t.owner.data("error-message",e&&e.error&&e.error.text?e.error.text:""),t.owner.trigger("popup-box-result-show"),t.hide()})}function t(t){t.on("click",".b-payment-bonus__default-email",function(){t.find(".b-form-input").bem("b-form-input").val($(this).text())}),t.on("click",".b-button",function(e){e.preventDefault(),e.stopPropagation(),t.find("form").trigger("submit")}),t.on("submit","form",function(n){var i=$(this),o=i.find('input[name="email-to"]').val(),a=ym.textUtils.checkEmail(o);n.preventDefault(),n.stopPropagation(),r({href:i.attr("action")},i.data("submit-counter")),t.find(".b-payment-bonus__incorrect-email").toggle(!a),a&&e(i.attr("action"),o,t)})}var n={arrow:!1,"update-content":!1,"box-width":400,position:"top",theme:"white",show:{event:"click"},hide:{event:""},"del-hint-elem":!0,oninit:function(){t(this)}};YaMoney.block["b-payment-bonus__popup-box"]=function(){var e=$("#"+this.data("target-id"));e.size()&&e.simple_tip($.extend({},n,{html:this.closest(".ym-simple-tip-hint")})),this.data("success-id")&&e.simple_tip($.extend({},n,{html:$("#"+this.data("success-id")),"del-hint-elem":!1,show:{event:"popup-box-result-show"},hide:{event:"popup-box-result-hide"},onshowbefore:function(){var e=this.simple_tip("get")[0],t=e.owner.data("error-message");t&&this.find(".b-payment-bonus__message-error").html(t).toggle(!!t),this.find(".b-payment-bonus__message-success").toggle(!t)}}))}}(),$(function(){var e=$('tr[data-block-js="b-payment-captcha"]');0!=e.length&&YaMoney.block["b-payment-captcha"].call(e)}),YaMoney.block["b-payment-captcha"]=function(){var e=$("#challenge-control");e.data("is-tip-payment-challenge-inited")||e.simple_tip({show:{event:"tip-payment-challenge-show"},hide:{event:"tip-payment-challenge-hide"},theme:"red","top-by-click":!0,position:"right","offset-left":"#b-descr-and-confirm","offset-top":$(".b-form-input, .b-form-button",e)[0]}).data("is-tip-payment-challenge-inited",!0),"true"==e.attr("data-error")&&e.trigger("tip-payment-challenge-show",{html:$("span#captcha-failed-hint").html()});var t=function(){if(""==$("#captcha-response").val()){e.trigger("tip-payment-challenge-show",{html:$("span#captcha-empty-hint").html()});var t=function(){YaMoney.challenge.checkField({container_id:"#challenge-control",field_id:this,hint_id:"span#captcha-empty-hint",is_need_nonempty:!0})};return $("#captcha-response").each(function(){$(this).bind("blur",t).bind("keypress",t).bind("keyup",t)}),!1}return!0};YaMoney.paymentCaptcha={check:t}};var ChallengeUtils=function(e){this.errorHintType=e||"simpleTip"};ChallengeUtils.prototype={getEvent:function(e){try{var t=e||window.event,n=t.which?t.which:t.keyCode}catch(i){}finally{return{event:t,code:n,target:t.target||t.srcElement}}},savePosition:function(e,t){var n=$(e).ym_getCaretPosition();t(e),$(e).ym_getCaretPosition()!=n&&$(e).ym_setCaretPosition(n)},isNumber:function(e){return e>47&&58>e||e>95&&106>e},isHexChar:function(e){return e>64&&79>=e||e>=80&&90>=e},isCtrlKey:function(e){return-1!="8 9 13 16 17 18 20 37 38 39 40 46 ".indexOf(String(e)+" ")},isEditKey:function(e){return e>32&&47>e},filterInputGroupKeyUp:function(e){var t=e.target,n=$(t),i=e.data.prvValue,o=e.data.correctValue,a=e.data.code;if("undefined"!=typeof o&&o.call(t,a,e),t.value!=i){var s=n.attr("maxlength");if(s&&t.value.length>=s){var r=$("#"+t.id.substring(0,t.id.length-1)+(parseInt(t.id.substring(t.id.length-1))+1));r.length&&(n.trigger("blur"),r.trigger("focus"))}}n.unbind("keyup",arguments.callee)},filterInputGroup:function(e,t,n){if($(e.target).ym_getCaretPosition()<1&&8==e.code){var i=$("#"+e.target.id.substring(0,e.target.id.length-1)+(parseInt(e.target.id.substring(e.target.id.length-1))-1));i.length&&($(e.target).trigger("blur"),i.ym_setCaretPosition(i[0].value.length),i.trigger("focus"),i.one("keyup",{code:e.code,prvValue:i.value,correctValue:t},n))}else{var o=e.target,a=$(o);a.one("keyup",{code:e.code,prvValue:o.value,correctValue:t},n)}},setFirstElFocus:function(e){var t=!1,n=$(e).filter(function(){if(!t){var e=$(this),n=e.parents(".b-form-input").eq(0);return n.length&&n.bem("b-form-input").hasMod("error")?void(t=!0):(e.is(":text")||e.is(":password"))&&e.is(":visible:enabled")}}).eq(0);!t&&n&&n.focus()},addErrorStyle:function(e){e=$(e),e.elementModifier({blockName:"b-form-input",mode:"set",modName:"error",modValue:"yes",className:"error",callback:function(){e.data("hasError",!0),e.trigger("errorStyleAssigned")}})},removeErrorStyle:function(e,t){e=$(e),e.elementModifier({blockName:"b-form-input",mode:"del",modName:"error",className:"error",callback:t})},getTipAndShow:function(e,t,n){if(!e.data("is-tip-payment-challenge-inited")){if("simpleTip"===this.errorHintType){var i=e.data("simple-tip")||{};e.simple_tip(ym.mergeFlatObjects({show:{event:"tip-payment-challenge-show"},hide:{event:"tip-payment-challenge-hide"},position:"right",theme:"red"},i))}else{var o=$('div[class$="wrapper"]',e);o.append('<div class="payment-challenge-html-error-hint"></div>'),e.bind("tip-payment-challenge-show",function(e,t){$("div.payment-challenge-html-error-hint",o).html(t.html),$("div.payment-challenge-html-error-hint",o).show()}).bind("tip-payment-challenge-hide",function(){$("div.payment-challenge-html-error-hint",o).hide()})}e.data("is-tip-payment-challenge-inited",!0)}return!n&&e.is("input")&&(n=e),this.addErrorStyle(n),e.trigger("tip-payment-challenge-show",t),this},hideTip:function(e,t){this.removeErrorStyle(e,function(){if($field=$(e),$field.data("hasError",!1),"object"==typeof t){var n=$("input",t).filter(function(){return $(this).data("hasError")});n.length||t.trigger("tip-payment-challenge-hide")}else $field.trigger("tip-payment-challenge-hide")})}},$(function(){if($('tr[data-block-js="b-payment-challenge"]').length){var e=$('tr[data-block-js="b-payment-challenge"]'),t=e.attr("data-page-style");YaMoney.challengeUtils=YaMoney.challengeUtils||new ChallengeUtils("embedded"==t?"innerHtmlHint":null);var n=$("#challenge-submit"),i=n.find(".b-form-button"),o=i.size()?i.getBlockByElem("b-form-button"):null,a=$("#challenge-control"),s=$("#challenge-emergency-control"),r=$(".through-card-info__card-number"),l=r.find("[name=throughcard-selected]"),c=$(".help-renew-link"),d=$("#paytype-control"),m=d.data("wo-auth-allowed");YaMoney.challenge={isEmergencyMode:!1,pageStyle:t,setElFocus:function(e){"embedded"!==this.pageStyle&&YaMoney.challengeUtils.setFirstElFocus(e)},setFirstElFocus:function(){"embedded"!==this.pageStyle&&YaMoney.challengeUtils.setFirstElFocus($(".challenge input"))},updateControl:function(e){e=e||"show","hide"==e?(a.hide(),a.find("input:enabled").val(""),YaMoney.challengeUtils.hideTip("#challenge-control input:enabled",a)):a.show(),$.simple_tip.update()},updateEmControl:function(e){e=e||"show","hide"==e?(s.hide(),s.find("input:enabled").val(""),YaMoney.challengeUtils.hideTip("#challenge-emergency-control input:enabled",s)):(s.show(),this.showSubmitButton()),$.simple_tip.update()},isHideSubmitButtonState:!1,toggleSubmitButton:function(e){e?this.showSubmitButton():this.hideSubmitButton()},hideSubmitButton:function(){n.hide(),$("tr.challenge-offer").hide()},showSubmitButton:function(){n.show(),$("tr.challenge-offer").show(),this.isHideSubmitButtonState=!1},setSubmitButtonText:function(e){var t=n.find(".b-form-button__text");t.data("text-backup")||t.data("text-backup",t.html()),t.html(e||t.data("text-backup"))},lockSubmitButton:function(){o&&(o.setMod("disabled","yes"),$("tr.challenge-offer").hide())},unlockSubmitButton:function(){o&&(o.delMod("disabled"),$("tr.challenge-offer").show())},toggleLockOfSubmitButton:function(e){e?this.unlockSubmitButton():this.lockSubmitButton()},setEmergencyMode:function(e){var e=e||{},t=e.needLockSubmitButton||!1,n=e.needHideSubmitButton||!1;this.updateControl("hide"),this.updateEmControl(),this.isEmergencyMode=!0,$.simple_tip.update(),t&&this.lockSubmitButton(),n&&this.hideSubmitButton()},resetEmergencyMode:function(e){var e=e||{},t=e.needUnLockSubmitButton||!1,n=e.needShowSubmitButton||!1;this.updateEmControl("hide"),this.isEmergencyMode=!1,this.updateControl(),this.isHideSubmitButtonState?this.hideSubmitButton():n&&this.showSubmitButton(),$.simple_tip.update(),t&&this.unlockSubmitButton()},updateChallenge:function(e){if(c.show(),this.setSubmitButtonText(),e&&"hide"==e)this.updateEmControl("hide"),this.updateControl("hide"),c.hide();else{if(this.isEmergencyMode){var t=$("a.emergency-code-proposition");this.setEmergencyMode({needLockSubmitButton:t.data("lock-button"),needHideSubmitButton:t.data("hide-button")})}else{var t=$("a#emergency-code-proposition-reset");this.resetEmergencyMode({needUnLockSubmitButton:t.data("unlock-button"),needShowSubmitButton:t.data("show-button")})}this.getCardChallengeDisabledState()&&(this.updateEmControl("hide"),this.updateControl("hide"),c.hide(),this.toggleSubmitButton(!0),this.unlockSubmitButton())}this.updateReminder(e),YaMoney.challenge.setFirstElFocus(),$.simple_tip.update()},getCardChallengeDisabledState:function(){return m},filterInputEm:function(e,t){e=YaMoney.challengeUtils.getEvent(e);{var n=YaMoney.challengeUtils.isNumber(e.code)||YaMoney.challengeUtils.isCtrlKey(e.code)||YaMoney.challengeUtils.isHexChar(e.code),i=function(e){return function(t){var n=t.value.toUpperCase(),i=$(t);null!=n.match(/[^A-Z0-9]/)?YaMoney.challenge.getTipAndShow(e,{html:$("#emergency-illegal-hint").html()},t):YaMoney.challengeUtils.hideTip(i),t.value=n}}($(t));e.target}return YaMoney.challengeUtils.filterInputGroup(e,function(){YaMoney.challengeUtils.savePosition(this,i)},YaMoney.challengeUtils.filterInputGroupKeyUp),n},checkField:function(e){e=e||{};var t=$(e.container_id),n=$(e.field_id),i={pass:/[^(\040a-zA-Z0-9_\-\!\?\@\#\$\%\^\&amp;\*\(\)\+\=\{\}\[\]\;\:\.\>\<\,\\\/\`\~\|)]/,numLet:/[^A-Z0-9]/,num:/[^0-9]/};e.is_need_nonempty&&""==n.val()?YaMoney.challenge.getTipAndShow(t,{html:$(e.hint_id).html()},n):e.is_need_nonempty&&e.is_need_nonempty>0&&"number"==typeof e.is_need_nonempty&&n.val()&&e.is_need_nonempty!=n.val().length?(YaMoney.challenge.getTipAndShow(t,{html:$(e.formatHint_id).html()},n),n.trigger("cvvBlur")):e.checkRegex&&i[e.checkRegex.type]&&n.val()&&i[e.checkRegex.type].test(n.val())?YaMoney.challenge.getTipAndShow(t,{html:e.checkRegex.message},n):YaMoney.challengeUtils.hideTip(n,t)},filterGrid:function(e,t){e=YaMoney.challengeUtils.getEvent(e);{var n=YaMoney.challengeUtils.isNumber(e.code)||YaMoney.challengeUtils.isCtrlKey(e.code)||YaMoney.challengeUtils.isHexChar(e.code),i=function(e){return function(t){{var n=t.value.toUpperCase();$(t)}null!=n.match(/[^A-Z0-9]/)?YaMoney.challenge.getTipAndShow(e,{html:$("#grid-symbols-failed-hint").html()},t):YaMoney.challengeUtils.hideTip(t,e),t.value=n}}($(t));e.target}return YaMoney.challengeUtils.filterInputGroup(e,function(){YaMoney.challengeUtils.savePosition(this,i)},YaMoney.challengeUtils.filterInputGroupKeyUp),n},filterNum:function(e){e=YaMoney.challengeUtils.getEvent(e);var t=e.target,n=function(){var e=t.value.replace(/[^0-9]/g,"");t.value=e};YaMoney.challengeUtils.filterInputGroup(e,function(){YaMoney.challengeUtils.savePosition(this,n)},YaMoney.challengeUtils.filterInputGroupKeyUp);var i=$(e.target);i.data("set_ym_num_filter")||(i.ym_keys(/\d/),i.data("set_ym_num_filter",!0))},cardNumGroup:function(e){if(e=YaMoney.challengeUtils.getEvent(e),YaMoney.challengeUtils.isNumber(e.code)&&4==e.target.value.length){var t=$("#card-number2")[0];t.focus()}return!0},getTipAndShow:function(e,t,n){YaMoney.challengeUtils.getTipAndShow(e,t,n)},hideTip:function(e,t){YaMoney.challengeUtils.hideTip(e,t)},updateReminder:function(e){var t="hide"===e,n=$("#b-additional-services");if(n.length){var i=n.data("handlers"),o=i?i.disableAdditionalServices:null;ym.isFunction(o)&&o(t)}else{var a=$("#b-payment-reminder"),s=a.closest("tr"),r=a.data("handlers"),l=r?r.disableReminder:null;ym.isFunction(l)?(s.show(),l(t)):s.toggle(!t)}}},l.parents(".b-form-select").eq(0).getBlockByElem("b-form-select").on("change",function(){YaMoney.challenge.updateChallenge()}),$("div[data-block-js]").each(function(){YaMoney.block[this.attributes["data-block-js"].value].call($(this),this.attributes["data-control-around"].value)}),e.length&&YaMoney.block["b-payment-challenge"].call(e)}}),YaMoney.block["b-payment-challenge"]=function(){function e(e){e.trigger("change",{current:e.elem("button","checked","yes")})}YaMoney.paymentChallenge={callengeType:this.attr("data-challenge-type"),needCounter:"true"==this.attr("data-process-type")};var t;if(YaMoney.paymentChallenge.needCounter){try{switch(YaMoney.paymentChallenge.callengeType){case"secure-password":$.ym_reachCounterGoal({targetName:"Check_PP"}),r(this,"stred/pid=41/cid=72025/path=pp"),t="stred/pid=41/cid=72028/path=pp";break;case"token":$.ym_reachCounterGoal({targetName:"Check_Token"}),r(this,"stred/pid=41/cid=72025/path=token"),t="stred/pid=41/cid=72028/path=token";break;case"totp":$.ym_reachCounterGoal({targetName:"Check_Totp"}),r(this,"stred/pid=41/cid=72025/path=totp"),t="stred/pid=41/cid=72028/path=totp";break;case"sms":$.ym_reachCounterGoal({targetName:"Check_SMS"}),r(this,"stred/pid=41/cid=72025/path=sms"),t="stred/pid=41/cid=72028/path=sms";break;default:$.ym_reachCounterGoal({targetName:"Check_Grid"}),r(this,"stred/pid=41/cid=72025/path=grid"),t="stred/pid=41/cid=72028/path=grid"}}catch(n){}$("#challenge-submit .b-form-button").bem("b-form-button").on("click",function(){r(this,t)})}YaMoney.challenge.isHideSubmitButtonState=Boolean("true"==this.attr("data-hide-submit-button")),YaMoney.challenge.isEmergencyMode=Boolean("true"==this.attr("data-is-emergency-mode-started")),"sms"===YaMoney.paymentChallenge.callengeType&&(YaMoney.challenge.updateControl=function(e){"hide"==e||YaMoney.challenge.isEmergencyMode?(YaMoney.smsChallenge.inputChallenge.updateInputControl(!1),YaMoney.smsChallenge.buttonChallenge.updateButtonControl(!1)):YaMoney.smsChallenge.isSmsSended?(this.showSubmitButton(),YaMoney.smsChallenge.buttonChallenge.updateButtonControl(!1),YaMoney.smsChallenge.inputChallenge.updateInputControl(!0),YaMoney.challenge.setElFocus(YaMoney.smsChallenge.inputChallenge.control)):(this.hideSubmitButton(),this.isHideSubmitButtonState=!0,YaMoney.smsChallenge.inputChallenge.updateInputControl(!1),YaMoney.smsChallenge.buttonChallenge.updateButtonControl(!0),YaMoney.challenge.setFirstElFocus())},!$("#challenge-control").hasClass("adaptive-sauth")||$(".challenge-sms-input-wrapper").attr("data-check-failed")||$(".challenge-sms-input-wrapper").data("dont-send-sms")||($(".send-code").getBlockByElem("b-form-button").trigger("click"),setTimeout(function(){YaMoney.smsChallenge.inputChallenge.control.trigger("smsIsSentHint"),$(document).click(function(){YaMoney.smsChallenge.inputChallenge.control.trigger("hideSmsIsSentHint")})},500)));var i=this.attr("data-offset-left-elem");YaMoney.challenge.isHideSubmitButtonState&&YaMoney.challenge.hideSubmitButton();var o=function(){var e,t=!0,n=function(e){var t=$(e);return t.is(":visible")&&""==t.val()};if(n("#passwd")){YaMoney.challenge.getTipAndShow($("#challenge-control"),{html:$("span#passwd-empty-hint").html()},$("#passwd"));var i=function(){YaMoney.challenge.checkField({container_id:"#challenge-control",field_id:this,hint_id:"span#passwd-empty-hint",is_need_nonempty:!0,checkRegex:{type:"pass",message:$("span#checkPassSymbols-hint").html()}})};$("#passwd").bind("blur keypress keyup",i),t=!1}if(n("#grid-cell0")||n("#grid-cell1")||n("#grid-cell2")){var o=$("#grid-cell0, #grid-cell1, #grid-cell2");YaMoney.challenge.getTipAndShow($("#challenge-control"),{html:$("span#grid-empty-hint").html()},o.filter(function(){return n($(this))}));var i=function(){YaMoney.challenge.checkField({container_id:"#challenge-control",field_id:this,hint_id:"span#grid-empty-hint",is_need_nonempty:!0,checkRegex:{type:"numLet",message:$("span#grid-symbols-failed-hint").html()}})};o.bind("blur",i),t=!1}if(n("#token-response")){var a=$("#token-response");YaMoney.challenge.getTipAndShow($("#challenge-control"),{html:$("span#token-empty-hint").html()},a);var i=function(){YaMoney.challenge.checkField({container_id:"#challenge-control",field_id:this,hint_id:"span#token-empty-hint",is_need_nonempty:!0})};a.bind("blur",i),t=!1}if(n("#totp-response")){var s=$("#totp-response");YaMoney.challenge.getTipAndShow($("#challenge-control"),{html:$("span#totp-empty-hint").html()},s);var i=function(){YaMoney.challenge.checkField({container_id:"#challenge-control",field_id:this,hint_id:"span#totp-empty-hint",is_need_nonempty:!0})};s.bind("blur",i),t=!1}if(n("#sms-response")){var r=$("#sms-response");YaMoney.challenge.getTipAndShow($("#challenge-control"),{html:$("span#sms-empty-hint").html()},r);var i=function(){YaMoney.challenge.checkField({container_id:"#challenge-control",field_id:this,hint_id:"span#sms-empty-hint",is_need_nonempty:!0})};r.bind("blur",i),t=!1}if(n("#emergency-code")){var l=$("#emergency-code");YaMoney.challenge.getTipAndShow($("#challenge-emergency-control"),{html:$("span#emergency-empty-hint").html()},l);var i=function(){YaMoney.challenge.checkField({container_id:"#challenge-emergency-control",field_id:this,hint_id:"span#emergency-empty-hint",is_need_nonempty:!0,checkRegex:{type:"numLet",message:$("span#emergency-illegal-hint").html()}})};l.bind("blur",i),t=!1}if(""==$("#captcha-response").val()){var c=$("#captcha-response");YaMoney.challenge.getTipAndShow($("#challenge-control"),{html:$("span#captcha-empty-hint").html()},c);var i=function(){YaMoney.challenge.checkField({container_id:"#challenge-control",field_id:this,hint_id:"span#captcha-empty-hint",is_need_nonempty:!0})};c.bind("blur keypress keyup",i),t=!1}if($("#through-card-number-content").is(":visible")){var i=function(){YaMoney.challenge.checkField({container_id:"#through-card-number-content",field_id:this,hint_id:"span#card-number-empty-hint",is_need_nonempty:4,formatHint_id:"span#card-number-format-hint"})},d=$("#through-card-number-content input:enabled");d.each(function(){i.apply(this)}),d.filter(function(){return $field.data("hasError")}).length&&(d.bind("blur keypress keyup",i),t=!1)}if(n("#card-expiration-month")||n("#card-expiration-year")){var m=$("#through-card-expiration-date-content select");YaMoney.challenge.getTipAndShow($("#through-card-expiration-date-content"),{html:$("span#card-expiration-empty-hint").html()},m);var i=function(){YaMoney.challenge.checkField({container_id:"#through-card-expiration-date-content",field_id:this,hint_id:"span#card-expiration-empty-hint",is_need_nonempty:!0})};m.bind("change",i),$("#card-expiration-month").bind("change",i),t=!1}if($("#is-new-offer-signed").get(0)&&!$("#is-new-offer-signed").is(":checked")&&(YaMoney.challenge.getTipAndShow($("#is-new-offer-signed"),{html:$("#new-offer-is-not-signed").html()}),t=!1),$("#cvv-block").is(":visible")){var i=function(){YaMoney.challenge.checkField({container_id:"#cvv-block",field_id:this,hint_id:"span#cvv-empty-hint",is_need_nonempty:3,formatHint_id:"span#cvv-format-hint"})};e=$("#cvv"),i.apply(e),e.data("hasError")&&(t=!1,e.bind("blur keypress keyup",i))}return t};$("#cvv-block .b-form-input input").keypress(YaMoney.challenge.filterNum),$("#hint-nomoney").simple_tip({position:"bottom",html:"#hint-nomoney-descr",show:{event:"click"},hide:{event:"unfocus"}}),$("#paytype-control").data("is_no_need_password_auth",{hidebtn:$("#yamoney-account"),password:$("#challenge-control")});var a=$(".challenge-offer-text").outerWidth(!0)-$(".challenge-offer-text").width();$(".b-offer-checkbox-row__acceptLink").addClass("b-offer-checkbox-row__acceptLink_pseudo_true").click(function(){if($(this).closest(".challenge-offer-inner").parent().toggleClass("selected"),$("body").hasClass("msie")){var e=$(".challenge-offer-inner").width();$(".challenge-offer-text").width(e-a),$(".b-offer-checkbox-row").width(e)}return $(".challenge-offer-text").slideToggle(),!1}),$(".b-form-checkbox").click(function(){$(".i-ua_css_quirks .msie").get(0)&&$(this).toggleClass("b-form-checkbox_checked_yes")}),$("#is-new-offer-signed").data("simple-tip",{"offset-left":i,"offset-top":$("#is-new-offer-signed")}).change(function(){YaMoney.challengeUtils.hideTip($(this))}),$("a.emergency-code-proposition").bind("click",function(){YaMoney.challengeUtils.hideTip("#challenge-control"),YaMoney.challenge.setEmergencyMode({needLockSubmitButton:$(this).data("lock-button"),needHideSubmitButton:$(this).data("hide-button")})}),$("a#emergency-code-proposition-reset").click(function(){YaMoney.challenge.resetEmergencyMode({needUnLockSubmitButton:$(this).data("unlock-button"),needShowSubmitButton:$(this).data("show-button")})});var s=$("#paytype-control"),l=s.find(".b-form-radio"),c=$(".through-card-info"),d=$(".challenge-switch-to-cps"),m=$("#cvv-control"),u=$(".p-payment-challenge__money-source-control-static"),h=$("#nomoney-control"),p=$(".b-allowed-cps-payment-types__popup-toggler"),f=$(".help-renew-link"),g={toggleStandartControls:function(e){e=e||!1,YaMoney.challenge.toggleSubmitButton(e),l.toggle(e),p.toggleClass("b-allowed-cps-payment-types__popup-toggler_check_single",!e),u.toggle(!e||!l.size()),m.hide(),c.hide(),d.hide(),h.hide(),$("#cvv").trigger("cvvBlur"),f.toggle(e)},PC:function(){var e=h.length;u.html(u.data("text-yamoney")),this.toggleStandartControls(!0),YaMoney.challengeUtils.hideTip($("#through-card-expiration-date-content")),YaMoney.challengeUtils.hideTip($("#through-card-number-content")),$("div#throughcard-check-hint").hide(),$("input:enabled, select:enabled ",m).each(function(){$(this).val(""),YaMoney.challengeUtils.hideTip($(this))}),r(this,"stred/pid=41/cid=72026/path=acc"),h.show(),YaMoney.challenge.toggleLockOfSubmitButton(!e),YaMoney.challenge.updateChallenge(e?"hide":"")},AC:function(){var e=m.data("do-have-card"),t=m.data("cps-card-allowed"),n=d.find(".b-form-button").getBlockByElem("b-form-button");this.toggleStandartControls(!0),$("div#throughcard-check-hint").show();var i=e||!t;c.toggle(i),m.show(),r(this,"stred/pid=41/cid=72026/path=card"),!e&&t?(YaMoney.challenge.hideSubmitButton(),f.hide(),n.url(n.domElem.closest("td").data("to-card-payment-url")),d.show()):YaMoney.challenge.toggleLockOfSubmitButton(e),YaMoney.challenge.updateChallenge(e?"":"hide")},cps:function(e){u.html(e.title),g.toggleStandartControls(),d.show(),YaMoney.challenge.updateChallenge("hide")}};if(l.length){var b=l.getBlockByElem("b-form-radio");b.on("change",function(e,t){var n=t.current.is(".yamoney-account")?"PC":"AC";g[n]()}),b.on("after-change",function(){YaMoney.challenge.setFirstElFocus()}),e(b)}else g.PC();$(".b-allowed-cps-payment-types_theme_popup").on("cps:payment-type-chosen",function(t,n){var i,o="PC"===n.paymentType,a="AC"===n.paymentType;d.find(".b-form-button").attr("href",n.switchToCpsUrl),a||o?l.size()?(i=o?l.find(".yamoney-account input").val():l.find(".gateline-throughcard input").val(),i===b.val()?e(b):b.val(i)):g.PC():g.cps(n)}),$(".is-disabled-card-payment").simple_tip({"offset-left":i,position:"right",html:"#hint-nocard-payment",show:{event:"mouseover",target:$(".is-disabled-card-payment")},hide:{event:"mouseout",target:$(".is-disabled-card-payment")}}),YaMoney.paymentChallenge.check=o},$(function(){if($("#email-challenge-offer").length){var e=$("#email-challenge-offer");e.data("simple-tip",{"offset-left":"#b-descr-and-confirm","offset-top":e}),"invalid-informing-address"==e.attr("data-error")&&YaMoney.challenge.getTipAndShow(e,{html:$("span#invalid-informing-address").html()}),e.change(function(){YaMoney.challengeUtils.hideTip($(this))})}if($("#through-card-controll").length){var e=$("#cvv-control"),t=$("#cvv-block"),n=$("#cvv",t);t.data("simple-tip",{"offset-left":"#b-descr-and-confirm","offset-top":$("#cvv-block")}),t.simple_tip({position:"right",html:"#cvv-format-help-hint",show:{event:"cvvFocus",target:n},hide:{event:"cvvBlur",target:n}}),n.bind("focus",function(){var e=$(this);e.data("hasError")||e.trigger("cvvFocus")}).bind("blur",function(){var e=$(this);e.trigger("cvvBlur")}),"failed"==t.attr("data-error")&&YaMoney.challenge.getTipAndShow(t,{html:$("span#cvv-empty-hint").html()},n);var i=$("#through-card-number-content");if(i.data("simple-tip",{"offset-left":"#b-descr-and-confirm"}),"card-number-illegal"==i.attr("data-error")){var o=$("input:enabled",i);YaMoney.challenge.getTipAndShow(i,{html:$("span#card-number-failed-hint").html()},o);var a=function(){YaMoney.challenge.checkField({container_id:"#through-card-number-content",field_id:this,hint_id:"span#card-number-empty-hint",is_need_nonempty:4,formatHint_id:"span#card-number-format-hint"})};o.bind("blur keypress keyup",a)}var s=$("#through-card-expiration-date-content");if(s.data("simple-tip",{"offset-left":"#b-descr-and-confirm"}),"expiration-date-illegal"==s.attr("data-error")){var r=$("select",s);YaMoney.challenge.getTipAndShow(s,{html:$("span#card-expiration-failed-hint").html()},r);var a=function(){YaMoney.challenge.checkField({container_id:"#through-card-expiration-date-content",field_id:this,hint_id:"span#card-expiration-empty-hint",is_need_nonempty:!0})};r.bind("change",a)}$("input",i).keyup(function(e){YaMoney.challenge.cardNumGroup(e)}).keyup(function(e){YaMoney.challenge.filterNum(e)});var l="yandex-promo-cps";$("#"+l).length&&!YaMoney.Utils.getCookie(l)&&$("#paytype-control label.b-form-radio__button_side_right").simple_tip({html:"#"+l,theme:"orange",position:"top","show-on-ready":!0,"box-width":340,show:{event:"show-promo-block-cps"},hide:{event:"hide-promo-block-cps"}}).bind("close-tip-icon-clicked",function(){YaMoney.Utils.setCookie(l,1)
})}}),YaMoney.block["b-payment-challenge-emergency"]=function(e){e="#"+e;var t=$(e),n=$(".challenge-emergency-code-wrapper",t),i=$(".b-form-input input",n),o=n.data("offset-left-elem"),a=(YaMoney.challenge.checkField,YaMoney.challenge.filterInputEm);t.data("simple-tip",{"offset-left":o,"offset-top":i});if(i.keydown(function(t){return a(t,e)}),""!=n.data("error")){var s="failed"===n.data("error")?"#emergency-failed-hint":"#emergency-empty-hint";YaMoney.challenge.getTipAndShow(t,{html:$(s).html()+$("span#add-sauth-error-help-hint").html()},i)}},YaMoney.block["b-payment-challenge-grid"]=function(e){e="#"+e;var t=$(e),n=$(".challenge-grid-wrapper",t),i=$(".b-form-input input",n),o=n.data("offset-left-elem"),a=(YaMoney.challenge.checkField,YaMoney.challenge.filterGrid);t.data("simple-tip",{"offset-left":o,"offset-top":i[0]}),i.keydown(function(t){return a(t,e)}),1==n.data("check-failed")&&YaMoney.challenge.getTipAndShow(t,{html:$("span"+e+"__grid-failed-hint").html()+$("span#add-sauth-error-help-hint").html()},i)},YaMoney.block["b-payment-challenge-passwd"]=function(e){e="#"+e;var t=$(e),n=$(".challenge-passwd-wrapper",t),i=$(".b-form-input input",n),o=n.data("offset-left-elem"),a=YaMoney.challenge.checkField,s=(YaMoney.challenge.filterNum,function(){a({container_id:e,field_id:"#"+i.attr("id"),hint_id:"span#passwd-empty-hint",is_need_nonempty:"password-empty"==n.data("error")||"secret-empty"==n.data("error"),checkRegex:{type:"pass",message:$("span#checkPassSymbols-hint").html()}})});if(t.data("simple-tip",{"offset-left":o,"offset-top":i}),i.keyup(s).keypress(s).blur(s),""!=n.data("error")){var r="failed"===n.data("error")?"#passwd-failed-hint":"#passwd-empty-hint";YaMoney.challenge.getTipAndShow(t,{html:$(r).html()+$("span#add-sauth-error-help-hint").html()},i)}},YaMoney.block["b-payment-challenge-sms"]=function(e){var t=YaMoney.challenge.checkField,n=YaMoney.challenge.filterNum;YaMoney.smsChallenge={inputChallenge:{controlAroundId:e}},YaMoney.smsChallenge.inputChallenge.controlAround=$("#"+YaMoney.smsChallenge.inputChallenge.controlAroundId),YaMoney.smsChallenge.inputChallenge.smsWrapper=$("div.challenge-sms-input-wrapper",YaMoney.smsChallenge.inputChallenge.controlAround),YaMoney.smsChallenge.inputChallenge.control=$(".b-form-input input",YaMoney.smsChallenge.inputChallenge.smsWrapper),YaMoney.smsChallenge.timeLeft={hours:ym.toNum(YaMoney.smsChallenge.inputChallenge.smsWrapper.data("time-hours")),minutes:ym.toNum(YaMoney.smsChallenge.inputChallenge.smsWrapper.data("time-minutes")),seconds:ym.toNum(YaMoney.smsChallenge.inputChallenge.smsWrapper.data("time-seconds"))},YaMoney.smsChallenge.timer=null,YaMoney.smsChallenge.inputChallenge.control.keydown(n),YaMoney.smsChallenge.inputChallenge.control.simple_tip({align:"left","show-on-ready":!1,theme:"green",position:"bottom","arrow-focus":!1,html:$("#new-code-hint").html(),show:{event:"showCodeHint"},hide:[{event:"focus keyup click keypress",target:YaMoney.smsChallenge.inputChallenge.control},{target:YaMoney.smsChallenge.inputChallenge.control,event:"hideCodeHint"}]}),YaMoney.smsChallenge.inputChallenge.mainWrapper=YaMoney.smsChallenge.inputChallenge.smsWrapper.data("offset-left-elem"),YaMoney.smsChallenge.inputChallenge.controlAround.data("simple-tip",{"offset-left":YaMoney.smsChallenge.inputChallenge.mainWrapper,"offset-top":$(".b-form-input, .b-form-button",YaMoney.smsChallenge.inputChallenge.smsWrapper)[0]}),YaMoney.smsChallenge.inputChallenge.updateInputControl=function(e){if(e){var n=function(){t({container_id:"#"+YaMoney.smsChallenge.inputChallenge.controlAroundId,field_id:"#"+this.id,hint_id:"span#sms-empty-hint",is_need_nonempty:"secret-empty"==YaMoney.smsChallenge.inputChallenge.smsWrapper.attr("data-error")})};if(this.controlAround.show(),"true"==this.smsWrapper.attr("data-check-failed")){this.control.blur(n);var i="secret-empty"===this.smsWrapper.attr("data-error")?"#sms-empty-hint":"#sms-failed-hint";YaMoney.challenge.getTipAndShow(this.controlAround,{html:$(i).html()+$("span#add-sauth-error-help-hint").html()},this.control)}}else this.control.trigger("hideCodeHint"),this.controlAround.hide(),this.control.val(""),YaMoney.challenge.hideTip(this.control,this.controlAround);"true"===this.smsWrapper.attr("data-check-failed")&&$(".challenge-sms-input-wrapper").data("dont-send-sms","true"),this.smsWrapper.attr("data-error",""),this.smsWrapper.attr("data-check-failed","")},YaMoney.smsChallenge.isSmsSended="true"==YaMoney.smsChallenge.inputChallenge.smsWrapper.attr("data-code-sended")&&"sms-code-expired"!=YaMoney.smsChallenge.inputChallenge.smsWrapper.attr("data-error"),YaMoney.smsChallenge.buttonChallenge=YaMoney.block["b-payment-challenge-sms-button"].call($("div.challenge-sms-button-wrapper"),$("div.challenge-sms-button-wrapper").attr("data-control-around")),YaMoney.smsChallenge.updateControl=function(e){YaMoney.paymentChallenge&&"sms"===YaMoney.paymentChallenge.callengeType?YaMoney.challenge.updateControl(e):("hide"!=e?this.isSmsSended?(this.buttonChallenge.updateButtonControl(!1),this.inputChallenge.updateInputControl(!0)):(this.inputChallenge.updateInputControl(!1),this.buttonChallenge.updateButtonControl(!0)):(this.inputChallenge.updateInputControl(!1),this.buttonChallenge.updateButtonControl(!1)),$.simple_tip.update())},YaMoney.smsChallenge.showTime=function(){var e="",t=ym.toNum(YaMoney.smsChallenge.timeLeft.minutes),n=ym.toNum(YaMoney.smsChallenge.timeLeft.seconds);t>=1?(t=n?t+1:t,e=ym.i18n.applyTmpl(ym.i18n.key("js_portal_js_ui__ui.js","minutes_short"),{number:t})):e=ym.i18n.applyTmpl(ym.i18n.key("js_portal_js_ui__ui.js","seconds_short"),{number:n}),(0!==t||n%10===0)&&$("span#sms-live-time").html(e)},YaMoney.smsChallenge.updateTime=function(){YaMoney.smsChallenge.timer&&clearTimeout(YaMoney.smsChallenge.timer),YaMoney.smsChallenge.showTime(),YaMoney.smsChallenge.isSmsSended&&(YaMoney.smsChallenge.timer=setInterval(function(){if(YaMoney.smsChallenge.timeLeft.seconds-=1,YaMoney.smsChallenge.timeLeft.seconds<="0"){if("0"==YaMoney.smsChallenge.timeLeft.minutes)return YaMoney.smsChallenge.isSmsSended=!1,YaMoney.smsChallenge.buttonChallenge.smsWrapper.attr("data-error","sms-code-expired"),clearTimeout(YaMoney.smsChallenge.timer),YaMoney.smsChallenge.updateControl(),void YaMoney.smsChallenge.inputChallenge.control.trigger("hideSmsIsSentHint");YaMoney.smsChallenge.timeLeft.seconds+=60,YaMoney.smsChallenge.timeLeft.minutes-=1}YaMoney.smsChallenge.showTime()},1e3))},YaMoney.smsChallenge.updateTime(),$(".send-code").getBlockByElem("b-form-button").on("click",function(e){YaMoney.paymentChallenge&&YaMoney.paymentChallenge.needCounter&&r(this,"stred/pid=41/cid=72027/"),this.setMod("disabled","yes"),YaMoney.smsChallenge.buttonChallenge.sendCode(this.domElem,function(){YaMoney.smsChallenge.isSmsSended=!0,YaMoney.smsChallenge.updateTime(),YaMoney.smsChallenge.updateControl()},function(){YaMoney.smsChallenge.isSmsSended=!1,YaMoney.smsChallenge.updateControl()}),e.preventDefault()}),$("#sms-send-repeat").click(function(){YaMoney.smsChallenge.buttonChallenge.sendCode($(this),function(){YaMoney.smsChallenge.isSmsSended=!0,YaMoney.smsChallenge.updateTime(),YaMoney.smsChallenge.updateControl(),YaMoney.smsChallenge.inputChallenge.control.trigger("showCodeHint")},function(){YaMoney.smsChallenge.isSmsSended=!1,YaMoney.smsChallenge.updateControl()})}),YaMoney.smsChallenge.updateControl(),YaMoney.smsChallenge.inputChallenge.control.simple_tip({"show-on-ready":!1,theme:"white",position:"right",html:$("#code-is-sent-hint").html(),show:{event:"smsIsSentHint"},hide:[{event:"keyup click keypress",target:YaMoney.smsChallenge.inputChallenge.control},{target:YaMoney.smsChallenge.inputChallenge.control,event:"hideSmsIsSentHint"}]})},YaMoney.block["b-payment-challenge-sms-button"]=function(e){var t={controlAroundId:e,isSmsSendFailed:!1};return t.controlAround=$("#"+t.controlAroundId),t.smsWrapper=$("div.challenge-sms-button-wrapper",t.controlAround),t.control=$(".b-form-button",t.smsWrapper),t.mainWrapper=t.smsWrapper.attr("data-offset-left-elem"),t.controlAround.data("simple-tip",{"offset-left":t.mainWrapper,"offset-top":$(".b-form-input, .b-form-button",t.smsWrapper)[0]}),t.updateButtonControl=function(e){e?(this.control.getBlockByElem("b-form-button").delMod("disabled"),this.controlAround.show(),"sms-code-expired"==this.smsWrapper.attr("data-error")?YaMoney.challenge.getTipAndShow(this.controlAround,{html:$("span#sms-expire-hint").html()}):"failed"==this.smsWrapper.attr("data-error")&&YaMoney.challenge.getTipAndShow(this.controlAround,{html:$("span#sms-failed-hint").html()}),this.isSmsSendFailed&&("tech"==this.isSmsSendFailed?YaMoney.challenge.getTipAndShow(this.controlAround,{html:$("span#sms-tech-hint").html()}):YaMoney.challenge.getTipAndShow(this.controlAround,{html:$("span#sms-limit-exceeded-hint").html()}),this.isSmsSendFailed=!1)):(this.controlAround.hide(),YaMoney.challenge.hideTip(this.controlAround)),this.smsWrapper.attr("data-error",""),this.smsWrapper.attr("data-check-failed","")},t.sendCode=function(e,n,i){var o=(e.parents("form"),{});o[t.smsWrapper.attr("data-challenge-id")]=t.smsWrapper.attr("data-challenge-id-value"),$.post("/ajax/send-sms",o,function(e){var o=e.success||!1;"true"==o?(YaMoney.smsChallenge.timeLeft.hours=ym.toNum(e.hours),YaMoney.smsChallenge.timeLeft.minutes=ym.toNum(e.minutes),YaMoney.smsChallenge.timeLeft.seconds=ym.toNum(e.seconds),n()):(t.isSmsSendFailed=e.description||!0,clearInterval(YaMoney.smsChallenge.timer),i())},"json")},t},YaMoney.block["b-payment-challenge-token"]=function(e){e="#"+e;var t=$(e),n=$(".challenge-token-wrapper",t),i=$(".b-form-input input",n),o=n.attr("data-offset-left-elem"),a=YaMoney.challenge.checkField,s=YaMoney.challenge.filterNum,r=function(){a({container_id:e,field_id:"#"+i.attr("id"),hint_id:"span#"+n.attr("data-empty-token-id"),is_need_nonempty:"secret-empty"==n.attr("data-error")})};if(t.data("simple-tip",{"offset-left":o,"offset-top":i}),1==n.data("check-failed")){var l="secret-empty"===n.data("error")?"#"+n.data("empty-token-id"):e+"__token-failed-hint";i.keyup(r).blur(r),YaMoney.challenge.getTipAndShow(t,{html:$(l).html()+$("span#add-sauth-error-help-hint").html()},i)}$('[id ^= "hint-token-about-"]').simple_tip({position:"bottom",html:"#hint-token-descr","box-width":"340",show:{event:"click"},hide:{event:"unfocus"}}),i.keydown(s)},YaMoney.block["b-payment-challenge-totp"]=function(e){e="#"+e;var t=$(e),n=$(".challenge-totp-wrapper",t),i=$(".b-form-input input",n),o=n.attr("data-offset-left-elem"),a=YaMoney.challenge.checkField,s=YaMoney.challenge.filterNum,r=function(){a({container_id:e,field_id:"#"+i.attr("id"),hint_id:"#"+n.attr("data-empty-totp-id"),is_need_nonempty:"secret-empty"==n.attr("data-error")})};if(t.data("simple-tip",{"offset-left":o,"offset-top":i}),n.data("check-failed")){var l="secret-empty"===n.data("error")?"#"+n.data("empty-totp-id"):e+"__totp-failed-hint";i.blur(r),YaMoney.challenge.getTipAndShow(t,{html:$(l).html()+$("#add-sauth-error-help-hint").html()},i)}$('[id ^= "hint-totp-about-"]').simple_tip({position:"bottom",html:"#hint-totp-descr","box-width":"340",show:{event:"click"},hide:{event:"unfocus"}}),i.keydown(s)},$(function(){function e(e){var t=n?"watch":"add",i=e?"70994":"70993";r(this,"stred/pid=41/cid="+i+"/path="+t)}var t=$("#b-payment-controls__add-to-fav"),n=t.hasClass("b-payment-controls__has-favorite"),i="b-payment-controls__has-favorite",o=!1,a=t.data("fav-title"),s=t.data("nfav-title");t.size()&&(e(!0),t.hasClass(i)?(t.click(function(){e(!1)}),t.attr("title",a)):(t.click(function(s){s.preventDefault(),o||(o=!0,$.getJSON(t.attr("js_href"),function(o){e(!1),o.success&&(t.addClass(i),t.removeClass("b-link_pseudo"),t.attr("href","/history-favorited.xml"),t.find("i.b-icon_24_star2").removeClass("b-icon_24_star2").addClass("b-icon_24_star1"),n=!0,e(!0),t.attr("title",a)),t.unbind("click").click(function(){e(!1)})}))}),t.attr("title",s)))}),YaMoney.block["b-payment-details-item"]=function(e){var t=this,n="/i/topen.gif",i="/i/tclose.gif",o="b-payment-details-item__pseudo-link_opened",a="b-payment-details-item__pseudo-link_closed",s=t.find(".b-payment-details-item__link-holder"),r=t.find(".b-dashed-trigger-panel__content"),l=s.find(".b-payment-details-item__pseudo-link"),c=l.find(".b-payment-details-item__image"),d=l.data("counter-clicked");l.on("click",function(){l.hasClass(o)?(c.attr("src",n),l.removeClass(o).addClass(a),r.hide()):(!d&&e.counterId&&(Lego.cp(41,e.counterId),l.data("counter-clicked",!0)),c.attr("src",i),l.removeClass(a).addClass(o),r.show())})},YaMoney.block["b-payment-reminder"]=function(){var e=$(this),t=e.find(".b-payment-reminder_inline__datepicker-link"),n=e.parents(".b-payment-success__auto-settings").find(".b-payment-success__auto-settings-controls-reminder");e=e.add(n);var i=e.find(".b-form-select").getBlockByElem("b-form-select"),o=e.find(".b-payment-reminder_inline__save").getBlockByElem("b-form-button"),a=e.find("input[name=reminder-scid], input[name=scid]").eq(0).val(),s=e.find(".b-payment-reminder_tunes__delete"),r=e.find('input[name="reminder-id"]'),l=r.val(),c=e.hasClass("b-payment-reminder_tunes"),d=e.hasClass("b-payment-reminder_inline"),m=e.find(".b-payment-reminder_tunes__datepicker_label"),u=e.find(".b-payment-reminder_inline__datepicker-active"),h=e.find(".b-payment-reminder_inline__datepicker-inactive"),p=e.attr("data-payment-id"),f=!1,g=e.closest(".b-settings-widget__visibleRow, .b-settings-widget__hiddenRow").find(".b-payment-reminder_tunes_name"),b=$(".b-settings-widget__reminder_more","#reminder"),y=e.closest(".b-payment-success__auto-settings").data("cpath"),_=e.closest(".b-payment-success__auto-settings").find(".b-payment-success__auto-settings-title-reminder"),v=function(t,n){var i="."+n,o=e.find(i).add(e.closest(i)).data("handlers");return o&&ym.isFunction(o[t])?o[t]:!1},w=function(){return c&&!e.closest(".b-settings-widget_mode_selected").length},k=function(t,n,o){if(!c&&t)return!1;var s,m,f=v("getSelectedDate","b-payment-reminder__datepicker"),g=v("updateDpText","b-payment-reminder__datepicker"),b=i.domElem?i.val():"month",y=f(),_=e.find('input[name="reminder-id"]').val()?"update":"create",w=function(t){if(t.success||"success"===t.status){var i=g(b,d);if(i.length&&"never"!=b?(h.hide(),u.show().find(".b-link__text").text(i)):(h.show(),u.hide(),r.remove()),t["reminder-id"]&&!e.find('input[name="reminder-id"]').length){l=t["reminder-id"];var o='<input type="hidden" name="reminder-id" value="'+l+'"/>';r=$(o).appendTo(e.find(".b-payment-reminder__datepicker"))}c&&!n&&e.trigger("reminder.showHint",{indent:e.closest(".b-settings-widget_mode_selected").length?-15:0});var a={mail:$(".b-payment-reminder_inline__title-mail"),and:$(".b-payment-reminder_inline__title-and"),sms:$(".b-payment-reminder_inline__title-sms")};a.mail.show(),a.sms.is(":visible")&&a.and.show(),setTimeout(function(){e.trigger("reminder.hideHint")},3e3)}};"create"===_?(s="/internal/reminder-ajax.xml",m={"reminder-id":l,"reminder-date":y,"reminder-scid":a,action:_,"payment-id":p}):(s="/ajax/updateReminder",m={reminderId:l,processDay:y.split(".")[0]}),o&&(m["reminder-name"]=o),$.post(s,m,w)},C=function(){$.post("/ajax/deleteReminder",{reminderId:l},function(t){if(t.success){var n=e.closest(".b-settings-widget__visibleRow, .b-settings-widget__reminder_hidden");n.siblings("tr.b-settings-widget__visibleRow").length?n.remove():n.closest(".b-settings-widget-left-td").parent().eq(0).remove(),$(".b-settings-widget__reminder_hidden").length||b.remove()}})},M=function(t){$("#b-payment-reminder-text").trigger("hideInformer"),i.domElem&&(t?(e.data("previous-value",i.val()),i.val("never")):i.val(e.data("previous-value"))),r.prop("disabled",t),e.toggle(!t)},x=function(){n.trigger("hideReminders")},S=function(e){var t=$(this),n=t.data("original-name"),i=t.siblings(".b-form-input").getBlockByElem("b-form-input");if(e&&e.preventDefault(),e&&e.data.show){$(".b-payment-reminder_tunes_name_edit").each(function(){S.call(this)}),$(document).on("click.cancelEditReminder",function(e){0===i.domElem.has(e.target).length&&S.call(t)});var o=BEM.HTML.build({block:"b-form-input",name:"reminder-name-"+l,id:"reminder-name-"+l,mods:{size:"m",theme:"grey",autocomplete:"no"},value:t.text()}),a=t.closest(".b-settings-widget__serviceName");t.hide(),i=BEM.DOM.init(a.append(o)).find("input").focus().getBlockByElem("b-form-input"),i.elem("input").prop("maxlength","200"),t.addClass("b-payment-reminder_tunes_name_edit"),i.bindTo("keydown",function(e){if(13===e.keyCode){e.preventDefault();var o=$.trim(this.val());o.length?(k(!0,!1,o),t.find("span").text(o),t.data("original-name",o)):t.find("span").text(n),i.destruct(),t.show(),t.removeClass("b-payment-reminder_tunes_name_edit"),$(document).off(".cancelEditReminder")}})}else i.destruct(),t.find("span").text(n),t.show().removeClass("b-payment-reminder_tunes_name_edit"),$(document).off(".cancelEditReminder");return!1};t.on("click",function(t){var o=v("showControls","b-payment-success__auto-settings"),a=n.is(":visible");a?o("",x):o("reminder"),n.trigger(a?"hideReminders":"showReminders"),a=n.is(":visible"),a?(f||(Lego.cp("41","72332",y),f=!0),Lego.cp("41","72335",y),$(document).on("click.hideSettings",function(t){!(e.has(t.target).length||i&&i.domElem.has(t.target).length||$(t.target).parent().find(".b-form-select__text").length||$(t.target).closest("#ui-datepicker-div, .ui-datepicker-header").length||$(t.target).closest(".b-payment-reminder__already-has__content").length)})):$(document).off("click.hideSettings"),t.stopPropagation()}),o.on("click",function(){k(!1)}),s.on("click",function(e){e.stopPropagation(),C()}),g.hover(function(){var e=$(this);e.addClass("b-payment-reminder_tunes_name__hover").on("click.editName",{show:!0},S)},function(){var e=$(this);e.removeClass("b-payment-reminder_tunes_name__hover").off(".editName")}),$(document).ready(function(){var t=$("#b-payment-reminder-text");if(t.data("hint-available")?(t.simple_tip({html:"#b-payment-reminder__informer-text",arrow:!0,position:"right","offset-left":"#b-descr-and-confirm","box-width":"340",show:{target:"#b-payment-reminder-text",event:"showInformer"},hide:[{target:"#b-payment-reminder__informer-close",event:"click"},{event:"hideInformer"},{target:$(".js-payment-division").parents("tr:eq(0)").nextAll("tr"),event:"click"},{target:$(".js-payment-division").parents("tr:eq(0)").nextAll().find("input"),event:"click keypress keyup change"}],onhidebefore:function(){var e=new Date,n=t.attr("data-rnd");e.setDate(e.getDate()+365),document.cookie="ym_informer_"+n+"=1; expires="+e.toUTCString()}}),e.is(":visible")&&!$.simple_tip.get("visible").length&&t.trigger("showInformer")):t.data("show-autopayments-proposal")&&(t.simpleTip({html:"#b-payment-reminder__autopayments-proposal-text",arrow:!0,position:"right","offset-left":"#b-descr-and-confirm","box-width":"340",show:{target:"#b-payment-reminder-text",event:"showAutopaymentsProposal"}}),e.is(":visible")&&!$.simpleTip.get("visible").length&&t.trigger("showAutopaymentsProposal")),e.data("has-reminders")){var o=t.add(_);o.simple_tip({html:"#b-payment-reminder__already-has-text",arrow:!0,position:"right","offset-left":"#b-descr-and-confirm, .b-payment-success","box-width":"340",theme:"payment-reminder",hide:[{target:"#b-payment-reminder__reminders-close",event:"click"},{event:"hideReminders"},{target:n,event:"hideReminders"},{target:"#b-additional-services",event:"hide-already-has"}],show:[{target:"#b-payment-reminder-text",event:"showReminders"},{target:n,event:"showReminders"},{target:"#b-additional-services",event:"show-reminder"}]})}c&&e.simple_tip({html:"#reminder-saved",arrow:!0,theme:"green",position:"bottom",align:"left",show:{event:"reminder.showHint"},hide:{event:"reminder.hideHint"},indent:-15,focus:15});var a=i.domElem?i.val():"month",s=v("updateDpText","b-payment-reminder__datepicker");s(a),i.domElem&&i.on("change",function(e){var t=e.block,n=t.val(),i=v("updateDpText","b-payment-reminder__datepicker"),o=t.isOpened();return c&&o&&(m.toggle("month"===n),k(!0,!o)),i(n),!$("#reminder").hasClass("b-settings-widget_mode_selected")},this).elem("button").on("mousedown",function(){c||d||(t.trigger("hideInformer"),t.trigger("showReminders"))});var r=$(".p-payment-challenge__money-source-controls");if(r.length){var l=r.find(".b-form-radio").getBlockByElem("b-form-radio");l.domElem&&l.on("change",function(){t.is(":hidden")&&t.trigger("hideReminders")}),$("#b-descr-and-confirm").find("input[type=text], input[type=password]").on("focus",function(){t.trigger("hideReminders")})}}),e.data("handlers",{updateReminder:k,disableReminder:M,getTunesVisibility:w})},YaMoney.block["b-payment-reminder__datepicker"]=function(){var e=this,t=e.find(".b-payment-reminder__datepicker-link"),n=!1,i=e.find("input[name=reminder-date]"),o=ym.i18n.key("js_portal_js_ui__ui.js","day_names_min__4406c99c8f").split(","),a=ym.i18n.key("js_portal_js_ui__ui.js","day_names_full__b6103cf522").split(","),s=ym.i18n.key("js_portal_js_ui__ui.js","month_names_full__7467c2c563").split(","),r=ym.i18n.key("js_portal_js_ui__ui.js","month_names_genetive_full__bc7a95abdf").split(","),l="periodic_reminder_pattern_eebc83493f",c=e.find(".b-link__text"),d=function(e){if(n)t.datepicker("hide"),n=!1;else{var r=$(e),l=r.offset();l.top+=24,l.left-=85,t.datepicker("dialog",i.val(),u,{onClose:function(e,i,o){if(o){var a=o.target||o.srcElement;n=$.contains(t.get(0),$(a).get(0))}},beforeShow:function(e,n){$.simple_tip.get("visible").hide(),$(e).zIndex(100),$.datepicker._updateDatepicker(n);var i=$.datepicker._checkOffset(n,l,!1);n.dpDiv.toggleClass("ui-datepicker-position-top",i.top<t.offset().top),n.input.addClass("g-hide")},dateFormat:"dd.mm.yy",dayNamesMin:o,dayNames:a,monthNames:s,showOtherMonths:!0,minDate:2,nextText:ym.i18n.key("ui_datepicker","next_month_c547907585"),prevText:ym.i18n.key("ui_datepicker","previous_month_425f094f69"),hideIfNoPrevNext:!0,firstDay:1},[l.left,l.top]),n=!0}};t.on("click",function(t){var n=m("getTunesVisibility"),i=this;n&&n()?setTimeout(function(){d(i)},500):d(i),e.closest(".b-settings-widget_mode_selected").length&&t.stopPropagation()});var m=function(t){var n=e.closest(".b-payment-reminder").data("handlers");return n&&ym.isFunction(n[t])?n[t]:!1},u=function(t){if(i.val()!=t){i.val(t),g(e.data("period"));var n=m("updateReminder");n&&n(!0)}},h=function(){return i.val()},p=function(e){var t=i.val().split("."),n=(new Date).getFullYear();t=new Date(t[2],t[1]-1,t[0]);var o={dd:ym.toNum(t.getDate()),mm:r[t.getMonth()],yy:t.getFullYear()===n||e?"":t.getFullYear()};return o.suffix=ym.getRightEngSuffix(o.dd),ym.i18n.key("js_portal_js_ui__ui.js",l,o)},f=function(e){var t=p(e);return c.text(t),t},g=function(t){{var n="";e.closest(".b-payment-reminder").data("custom-periodic")}switch(e.data("period",t),t){case"never":e.hide();break;case"month":e.show(),f(),n=p(l);break;default:e.hide()}return n};e.data("handlers",{updateDpText:g,getSelectedDate:h})},YaMoney.block["b-payment-success__auto-settings"]=function(){var e=$(this),t=(e.find(".b-payment-success__auto-settings-title-recharge"),e.find(".b-payment-success__auto-settings-title-reminder"),e.find(".b-payment-success__auto-settings-controls-recharge")),n=e.find(".b-payment-success__auto-settings-controls-reminder"),i=function(e,i){switch($(document).off("click.hideSettings"),e){case"recharge":n.trigger("hideReminders").slideUp(),t.slideDown({complete:i});break;case"reminder":t.slideUp(),n.slideDown({complete:i});break;default:t.slideUp(),n.trigger("hideReminders").slideUp()}};e.data("handlers",{showControls:i}),e.find(".b-payment-reminder_inline__sms-repay-wrapper").each(function(){var e=$(this),t=e.find(".b-form-switch").bem("b-form-switch"),n={active:$(".b-payment-reminder_inline__datepicker-active"),inactive:$(".b-payment-reminder_inline__datepicker-inactive"),mail:$(".b-payment-reminder_inline__title-mail"),and:$(".b-payment-reminder_inline__title-and"),sms:$(".b-payment-reminder_inline__title-sms")};$.ymReachCounterGoal("true"===t.val()?"SMSREPAY_SUCCESSPAGE_ON":"SMSREPAY_SUCCESSPAGE_OFF"),t.on("change",function(){var e="true"===this.val();e?$.getJSON("/internal/autopayments-ajax.xml",{action:"sms-repay","autopayment-date":$("#sms-repay-date").val(),"autopayment-sum":$("#sms-repay-sum").val(),"autopayment-name":$("#sms-repay-name").val(),"source-request-id":$("#sms-repay-request-id").val(),"source-payment-id":$("#sms-repay-payment-id").val()}).done(function(e){$.ymReachCounterGoal("SMSREPAY_SUCCESSPAGE_ON"),e&&e.success&&$("#sms-repay-id").val(e["autopayment-id"]),n.active.show(),n.inactive.hide(),n.sms.show(),n.mail.is(":visible")&&n.and.show()}):$.getJSON("/ajax/deleteAutopayment",{type:"smsRepay",autopaymentId:$("#sms-repay-id").val()}).done(function(){$.ymReachCounterGoal("SMSREPAY_SUCCESSPAGE_OFF"),n.sms.hide(),n.and.hide(),n.mail.is(":visible")||(n.active.hide(),n.inactive.show())})})})},YaMoney.block["b-popup"]=function(){var e=this,t=e.find(".b-popup_opener"),n=e.find(".b-popup_content_close"),i=e.find(".b-popup_content_header"),o=e.find(".b-popup_content"),a=e.find(".b-popup_content_list");no_items=1==e.data("no-items"),hint_available=1==e.data("hint-available"),$alternative_hint=e.find(".b-popup_alter_hint"),$b_popup_container=e.parent();var s=function(t){0==e.has(t.target).length&&(r(),$("body").off(".b_popup"))},r=function(){o.hide()},l=function(e){$b_popup_container.toggle(e),$b_popup_container.removeClass("JSnoB")},c=function(e){e.list?(hint_available=!0,l(!0),a.text(e.list),setTimeout(function(){t.trigger("click.showHint")},100)):(a.text(""),hint_available=!1,l(!1))};t.on("click.showHint",function(){o.show(),$("body").on("click.b_popup",s),t.trigger("showsimpletip.regions.off"),$("body").hasClass("msie")&&($(".b-popup_container").css({"z-index":"1"}),e.closest(".b-popup_container").css({"z-index":1e3,zoom:1}))}),n.add(i).on("click",r),$(document).ready(function(){hint_available&&l(!0),t.is(":hidden")?$alternative_hint.remove():t.trigger("showsimpletip.regions.on")}),YaMoney.b_popup={updateContent:c}},YaMoney.block["b-quiz"]=function(){function e(e){for(var t in e)if(e.hasOwnProperty(t))return t}function t(e){$(".b-quiz__error").slideUp(),e&&$(".b-quiz__error_id_"+e).slideDown()}function n(e,t){t?e.slideDown():e.slideUp()}function i(e){var i,a,s=u.find(".b-quiz__point:visible"),r=u.find(".b-quiz__point_id_"+e),l=r.size(),c=r.hasClass("b-quiz__result");return l>1?void t("too-many-points-for-id"):l?(r.find("input").prop("selected",!1).prop("checked",!1),s.size()&&l?(a=h.height(),h.height(a),s.fadeOut(function(){r.fadeIn(),h.height("auto")})):l&&r.fadeIn(),l&&!c&&(u.find(".b-quiz__breadcrumbs-step_current").removeClass("b-quiz__breadcrumbs-step_current"),u.find(".b-quiz__breadcrumbs-step_"+f.length).addClass("b-quiz__breadcrumbs-step_current")),u.find(".b-quiz__breadcrumbs").toggle(!c),n(u.find(".b-quiz__control-step-back-wrap"),f.length>1&&!c),n(u.find(".b-quiz__control-try-again-wrap"),c),n(u.find(".b-quiz__control-btn-next-wrap"),!c),g&&(c&&g.result?o(g.result):!c&&g.questions&&(i=g.questions[f.length-1],i&&o(i.show))),u.toggleClass("b-quiz_state_question",!c),u.toggleClass("b-quiz_state_result",c),void(c?u.trigger("b-quiz:finished"):u.trigger("b-quiz:next-question",[{newStep:f.length}]))):void t("tech-error")}function o(e,t){t=t||g["metrics-id"];var n=window["yaCounter"+t];n&&e&&n.reachGoal(e)}function a(t,n){var i=null;return $.each(t,function(t,o){var a=e(o);n===a&&(i=o[a][0])}),i}function s(n){n?(d=e(n),m=n[d],f.push({point:m,pointId:d,pointObj:n}),i(d)):t("tech-error")}function r(){g&&o(g["try-again"]),f=[],s(p)}function l(){var e;g&&o(g["step-back"]),t(),f.pop(),e=f.pop(),s(e.pointObj)}function c(){var e,n,i=u.find(".b-quiz__question:visible"),r=i.find("input:checked,input:selected"),l=[];g&&g.questions&&(n=g.questions[f.length-1],n&&o(n.next)),r.size()?(t(),r.each(function(e,t){var n=$(t).data("answer-id");l.push(n.toLowerCase())}),l=l.sort().join(","),e=a(m,l),e||(e=a(m,"*")),s(e)):t(i.data("multiple-choice")?"empty-multiple-answer":"empty-single-answer")}var d,m,u=this,h=u.find(".b-quiz__main"),p=u.data("scenario"),f=[],g=u.data("stats");return p?(u.on("b-quiz:restart",r),u.on("click",".b-quiz__control-btn-next",c),u.on("click",".b-quiz__control-step-back",l),u.on("click",".b-quiz__control-try-again",r),void $(function(){s(p)})):void u.hide()},YaMoney.block["b-select"]=function(){$(".b-select__select").focus(function(){$(this).closest(".b-select").addClass("b-select_focused_yes")}),$(".b-select__select").blur(function(){$(this).closest(".b-select").removeClass("b-select_focused_yes")})},YaMoney.block["b-simple-suggest"]=function(e){function t(){var n=this.value;n!==k&&(k=n,a(s(n,e)),r(0)),clearTimeout(f),f=setTimeout(t.bind(this),C)}function n(){k=null,clearTimeout(f),f=setTimeout(c,C)}function i(e){v&&(e.keyCode===M.UP?(r(--w),l(),e.preventDefault()):e.keyCode===M.DOWN?(r(++w),l()):e.keyCode===M.RETURN?(l(),c()):e.keyCode===M.ESC&&c())}function o(e){w=$(e.target).index(),l(),c()}function a(e){var t,n,i=e.length;for(p=$(),t=0;i>t;++t)n=$("<div/>").addClass(b).text(e[t]),p=p.add(n);_.html(p).toggle(i>0),v=i}function s(e,t){if(!e)return t;var n,i,o,a=[],s=(""+e).toLowerCase();for(i=0,n=t.length;n>i;++i)o=""+t[i],0===o.toLowerCase().indexOf(s)&&a.push(o);return a}function r(e){w=d(e,0,v-1),p.removeClass(y).eq(w).addClass(y)}function l(){k=p.eq(w).text(),u.val(k)}function c(){_.hide(),v=0}function d(e,t,n){return Math.min(Math.max(e,t),n)}var m=this,u=m.find("input"),h=u.closest(".b-form-input__box");if(!h.length)throw new Error("form-input element not found.");if(e.length){var p,f,g="b-simple-suggest",b=g+"__item",y=g+"__selected",_=$("<div/>").addClass(g),v=0,w=-1,k=null,C=100,M={TAB:9,RETURN:13,ESC:27,UP:38,DOWN:40};_.hide().css("min-width",h.width()).insertAfter(h),u.on("blur",n),u.on("focus",t),u.on("keydown",i),_.on("mousedown",o)}},YaMoney.block["b-spoiler"]=function(){var e=this,t=e.bem("b-spoiler"),n=e.children(".b-spoiler__toggle"),i=e.children(".b-spoiler__content"),o=n.children(".b-spoiler__pseudo-link"),a=n.children(".b-spoiler__label"),s=i.find(".b-spoiler__close"),r=t.getMod("action");o.on("click",function(){switch(r){case"toggle":i.toggleClass("JSnoB");break;case"replace":o.removeClass("JSyes"),i.removeClass("JSnoB");break;case"open":default:o.removeClass("JSyes"),a.removeClass("JSno"),i.removeClass("JSnoB")}t.toggleMod("state","closed","open");var e=i.find("input,select,textrea").first();e.focus()}),s.on("click",function(){o.addClass("JSyes"),a.addClass("JSno"),i.addClass("JSnoB"),t.setMod("state","closed")})},YaMoney.block["tab-panel"]=function(){var e=$(this),t=e.find("tr:gt(0)"),n=e.find("tr:eq(0) td"),i=n.find(".tab-panel-link-container");i.each(function(i){$(this).click(function(){t.hide(),n.removeClass("tab-panel-selected"),t.eq(i).show(),n.eq(i).addClass("tab-panel-selected"),e.addClass("tab-panel-selected");var o=n.eq(i).data("name")||"";if(o){var a=window.location.href.split("#")[0]+"#"+o;window.history&&window.history.replaceState?window.history.replaceState(null,null,a):window.location=a}})});var o=window.location.hash.substr(1);o&&n.filter("[data-name="+o+"]").find(".tab-panel-link-container").click()},YaMoney.block["b-text-toggler"]=function(){$(this).find("a.b-text-toggler__link").click(function(e){e.preventDefault();var t=$(this).next();t.slideToggle("fast")})},YaMoney.block["b-trigger"]=function(e){var t=YaMoney.block["b-trigger"],n=this,i=$.extend({handler:{click:"slideToggle"}},e),o=$(i.target)||this;switch(typeof i.handler){case"function":!function(){var e=i.handler;i.handler={click:e}}();break;case"string":!function(){var e=i.handler;i.handler={click:t[e]}}();break;default:!function(){for(var e in i.handler){var n=i.handler[e];"hover"==e&&(i.handler["mouseenter mouseleave"]=i.handler.hover,e="mouseenter mouseleave",delete i.handler.hover),i.handler[e]=t[n]||n}}()}for(var a in i.handler)this.bind(a,function(){return"function"==typeof i.handler[a]&&i.handler[a].call(n,o),!1})},function(e){e.slideToggle=function(e){return e.slideToggle(),this.toggleClass("b-trigger_toggled"),!1
},e.fadeToggle=function(e){return e.fadeToggle(),this.toggleClass("b-trigger_toggled"),!1}}(YaMoney.block["b-trigger"]),function(e){var t={_domain:".yandex.ru",_path:"/",_pCookieName:"yp",_sCookieName:"ys",_pCookieType:"p",pCookieExpireDate:new Date("Fri, 01 Jan 2038 00:00:00 GMT"),_defaultPermanentPeriod:604800,expireValues:{max:2145916800},_clone:function(e){var t,n={};if(e)for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n},_getBlocksFromCookie:function(e){var t,n,i,o,a=[],s=e.cookie.split("#");for(i=0,o=s.length;o>i&&s[i];i++)n=s[i].split("."),t={},e.hasExpire&&(t.expire=n.shift()),t.name=n.shift(),t.value=n.join("."),t.value=e.needDecodeValue?decodeURIComponent(t.value):t.value,a.push(t);return a},_getCookieBlockByName:function(e){var t,n,i=e.blocks||this._getBlocksFromCookie(e),o=null;for(t=0,n=i.length;n>t&&!o;t++)i[t].name===e.name&&(o=i[t]);return o},_updateCookieBlock:function(e){var t=this._getBlocksFromCookie(e),n=this._getCookieBlockByName({blocks:t,name:e.name});n||(n={},n.name=e.name,t.push(n)),n.value=encodeURIComponent(e.value),e.expire&&(n.expire=e.expire);var i,o,a,s=[];for(i=0,o=t.length;o>i;i++)a=[],t[i].expire&&a.push(t[i].expire),a.push(t[i].name),a.push(t[i].value),s.push(a.join("."));return s.join("#")},_setP:function(e){var t=e.expire||this.getNowInSeconds()+this._defaultPermanentPeriod;return this._updateCookieBlock({hasExpire:!0,cookie:e.cookie,name:e.name,value:e.value,expire:t})},_setS:function(e){return this._updateCookieBlock(e)},_getP:function(e){var t,n=this._getCookieBlockByName({cookie:e.cookie,name:e.name,needDecodeValue:!0,hasExpire:!0});return n&&(t=parseInt(n.expire,10),t<this.getNowInSeconds()&&(n=null)),n},_getS:function(e){return this._getCookieBlockByName({needDecodeValue:!0,cookie:e.cookie,name:e.name})},_get:function(e){return this._getS({cookie:e.sCookie,name:e.name})||this._getP({cookie:e.pCookie,name:e.name})},_parseCookie:function(e,t){e=e||"";var n="(?:^|; )"+t.cookieName.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)",i=e.match(new RegExp(n));return i&&i[1]?i[1]:""},_buildCookie:function(e){var t=[];return t.push(encodeURIComponent(e.cookieName)+"="+e.cookieValue),e.cookieExpires&&t.push("expires="+e.cookieExpires),t.push("path="+this._path),t.push("domain="+this._domain),t.join("; ")},_getCookie:function(){throw"yandex-money-ycookie: method _getCookie needs to be implemented!"},_setCookie:function(){throw"yandex-money-ycookie: method _setCookie needs to be implemented!"},getNowInSeconds:function(){return Math.ceil((new Date).getTime()/1e3)},getExpireAfterYear:function(e){return e=e||new Date,e.setFullYear(e.getFullYear()+1),Math.round(e.getTime()/1e3)},setS:function(e){var t=this._clone(e),n=this._getCookieFromCache(e);t.cookieName=this._sCookieName,t.cookie=n||this._getCookie(t),t.cookieValue=this._setS(t),this._setCookie(t),this._storeCookieToCache({req:t.req,value:t.cookieValue})},setP:function(e){var t=this._clone(e);e.type=this._pCookieType;var n=this._getCookieFromCache(e);t.cookieName=this._pCookieName,t.cookie=n||this._getCookie(t),t.cookieValue=this._setP(t),t.cookieExpires=this.pCookieExpireDate.toUTCString(),this._setCookie(t),this._storeCookieToCache({req:t.req,value:t.cookieValue,type:e.type})},get:function(e){var t=this._clone(e),n=this._getCookieFromCache(e);e.type=this._pCookieType;var i=this._getCookieFromCache(e);return t.cookieName=this._pCookieName,t.pCookie=i||this._getCookie(t),t.cookieName=this._sCookieName,t.sCookie=n||this._getCookie(t),this._get(t)},_storeCookieToCache:function(){throw new Error("yandex-money-ycookie, common: you need to override _storeCookieToCache method")},_getCookieFromCache:function(){throw new Error("yandex-money-ycookie, common: you need to override _getCookieFromCache method")}};"object"==typeof module&&(module.exports=t),t._getCookie=function(e){return this._parseCookie(document.cookie,e)},t._setCookie=function(e){document.cookie=this._buildCookie(e)},t._storeCookieToCache=function(){},t._getCookieFromCache=function(){},e.ym=e.ym||{},e.ym.yCookie=t}(window),function(e){e.fn.getBlockByElem=function(t){var n=e(this);if("string"==typeof t&&t.length){t=t.split(",");for(var i=0;i<t.length;i++){var o=t[i].replace(/^\s+|\s+$/g,""),a=n.closest("."+o);if(a.length)return a.bem(o)}}return n},e.fn.elementModifier=function(t){return this.each(function(){var n=e(this).getBlockByElem(t.blockName);n instanceof BEM?"set"===t.mode?n.setMod(t.modName,t.modValue):n.delMod(t.modName):"set"===t.mode?n.addClass(t.className):n.removeClass(t.className),"function"==typeof t.callback&&t.callback()}),this}}(jQuery),$(document).ready(function(){YaMoney.initBlocks();var e=$&&$.support&&$.support.placeholder;!e&&$.isFunction($.ym_placeholder)&&$("input[placeholder]").ym_placeholder(),"undefined"!=typeof jQuery.attrHooks&&(jQuery.attrHooks.disabled={set:function(e,t){if($(e).parents(".i-bem").length){var n=$(e).getBlockByElem("b-form-button, b-form-input, b-form-checkbox, b-form-select, promo-button");t&&n.hasMod("disabled","yes")||!t&&!n.hasMod("disabled","yes")||(t&&!n.hasMod("disabled","yes")?n.setMod("disabled","yes"):!t&&n.hasMod("disabled","yes")&&n.setMod("disabled","no"))}return""!=t?e.setAttribute("disabled","disabled"):e.removeAttribute("disabled"),t},get:function(e){if($(e).parent(".b-form-button").length){var t=$(e).parent(".b-form-button").bem("b-form-button");return"yes"==t.getMod("disabled")?"disabled":""}return e.getAttribute("disabled")}})});