!function(t){t.fn.ym_cardNumberInput=function(){function s(t){t=t.replace(/\s/g,"");var s=Math.floor(t.length/4),r="";if(s)for(var e=0;s>e;e++)r+=t.substring(4*e,4*e+4)+" ",e==s-1&&(r+=t.substring(4*e+4));else r=t;return r.length>23?r.substring(0,23):r}var r={backspace:8,tab:9,ctrl:17,del:46,end:35,home:36,left:37,right:39,v:86,x:88},e={63275:35,63273:36,63234:37,63235:39,63272:46},i=function(s){var r=t.browser.safari?e[s]||s:s;return r>=96&&105>=r&&(r-=48),r},n=!1,a=0,o="";this.on("keydown",function(e){var g,u,h=t(this).ym_getCaretPosition(),l=t(this).ym_getCaretEndPosition(),b=t(this).val(),c=i(e.keyCode||e.charCode),v=c>=48&&57>=c;v||c==r.backspace||c==r.del?(v?(g=b.substring(0,h)+String.fromCharCode(c)+b.substring(l),u=h%5==3||h%5==4?h+2:h+1):l>h?(g=b.substring(0,h)+b.substring(l),u=h%5==4?h+1:h):c==r.backspace?h%5==0?(g=b.substring(0,h-2)+b.substring(h),u=h-2):(g=b.substring(0,h-1)+b.substring(h),u=h-1):(g=h%5==4?b.substring(0,h)+b.substring(h+2):b.substring(0,h)+b.substring(h+1),u=h),t(this).val(s(g)),t(this).ym_setCaretPosition(u)):c==r.ctrl?n=!0:n&&c==r.v&&(a=h,o=b),c==r.left||c==r.right||c==r.home||c==r.end||c==r.tab||e.ctrlKey||e.preventDefault()}),this.on("input",function(){var r=t(this).val(),e=s(r.replace(/\D/g,""));t(this).val(e)}),this.on("keyup",function(e){var g,u=i(e.keyCode||e.charCode),h=t(this).val(),l=t(this).ym_getCaretPosition(),b=s(h.replace(/\D/g,""));t.browser.msie&&n&&u==r.x?(g=l%5==4?l+1:l,t(this).val(s(b)),t(this).ym_setCaretPosition(g)):n&&u==r.v?(g=l+b.substring(a,a+b.length-o.length).replace(/\S/g,"").length,t(this).val(s(b)),t(this).ym_setCaretPosition(g),a=0,o=""):u==r.ctrl})}}(jQuery);